<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/uploads/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/uploads/favicon.ico">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dunwu.github.io","root":"/blog/","images":"/blog/images","scheme":"Pisces","darkmode":true,"version":"8.12.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/blog/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
<meta property="og:type" content="website">
<meta property="og:title" content="Dunwu Blog">
<meta property="og:url" content="https://dunwu.github.io/blog/page/33/index.html">
<meta property="og:site_name" content="Dunwu Blog">
<meta property="og:description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="é’æ‚Ÿ â—¾ Dunwu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://dunwu.github.io/blog/page/33/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/33/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Dunwu Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Dunwu Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å¤§é“è‡³ç®€ï¼ŒçŸ¥æ˜“è¡Œéš¾</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">279</span></a></li><li class="menu-item menu-item-categories"><a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">118</span></a></li><li class="menu-item menu-item-archives"><a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">385</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="é’æ‚Ÿ â—¾ Dunwu"
      src="/blog/uploads/avatar.gif">
  <p class="site-author-name" itemprop="name">é’æ‚Ÿ â—¾ Dunwu</p>
  <div class="site-description" itemprop="description">é’æ‚Ÿçš„ä¸ªäººåšå®¢</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">385</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">118</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">279</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/dunwu" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;dunwu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:forbreak@163.com" title="E-Mail â†’ mailto:forbreak@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/dunwu/blog" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/7daf0d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/7daf0d/" class="post-title-link" itemprop="url">Java å¼€å‘ç¯å¢ƒ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-08-29 17:28:34" itemprop="dateCreated datePublished" datetime="2018-08-29T17:28:34+08:00">2018-08-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/JavaSE/" itemprop="url" rel="index"><span itemprop="name">JavaSE</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/JavaSE/%E5%9F%BA%E7%A1%80%E7%89%B9%E6%80%A7/" itemprop="url" rel="index"><span itemprop="name">åŸºç¡€ç‰¹æ€§</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>1.1k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>1 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Java-å¼€å‘ç¯å¢ƒ"><a href="#Java-å¼€å‘ç¯å¢ƒ" class="headerlink" title="Java å¼€å‘ç¯å¢ƒ"></a>Java å¼€å‘ç¯å¢ƒ</h1><blockquote>
<p>ğŸ“Œ <strong>å…³é”®è¯ï¼š</strong> JAVA_HOMEã€CLASSPATHã€Pathã€ç¯å¢ƒå˜é‡ã€IDE</p>
</blockquote>
<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>è¿›å…¥ <a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">JDK å®˜æ–¹ä¸‹è½½åœ°å€</a> ï¼Œæ ¹æ®è‡ªå·±çš„ç¯å¢ƒé€‰æ‹©ä¸‹è½½æ‰€éœ€ç‰ˆæœ¬ã€‚</p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>windows ç¯å¢ƒçš„ jdk åŒ…æ˜¯ exe å®‰è£…æ–‡ä»¶ï¼Œå¯åŠ¨åæ ¹æ®å®‰è£…å‘å¯¼å®‰è£…å³å¯ã€‚</p>
<p>Linux ç¯å¢ƒçš„ jdk åŒ…ï¼Œè§£å‹åˆ°æœ¬åœ°å³å¯ã€‚</p>
<h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>è®¡ç®—æœº &gt; å±æ€§ &gt; é«˜çº§ç³»ç»Ÿè®¾ç½® &gt; ç¯å¢ƒå˜é‡</p>
<p>æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š</p>
<p><code>JAVA_HOME</code>ï¼š<code>C:\Program Files (x86)\Java\jdk1.8.0_91</code> ï¼ˆæ ¹æ®è‡ªå·±çš„å®é™…è·¯å¾„é…ç½®ï¼‰</p>
<p><code>CLASSPATH</code>ï¼š<code>.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</code> ï¼ˆæ³¨æ„å‰é¢æœ‰ä¸ªâ€.â€ï¼‰</p>
<p><code>Path</code>ï¼š<code>%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</code></p>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>æ‰§è¡Œ <code>vi /etc/profile</code> ï¼Œç¼–è¾‘ç¯å¢ƒå˜é‡æ–‡ä»¶</p>
<p>æ·»åŠ ä¸¤è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=path/to/java</span><br><span class="line">export PATH=JAVA_HOME/bin:JAVA_HOME/jre/bin:</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œ <code>source /etc/profile</code> ï¼Œç«‹å³ç”Ÿæ•ˆã€‚</p>
<h2 id="æµ‹è¯•å®‰è£…æˆåŠŸ"><a href="#æµ‹è¯•å®‰è£…æˆåŠŸ" class="headerlink" title="æµ‹è¯•å®‰è£…æˆåŠŸ"></a>æµ‹è¯•å®‰è£…æˆåŠŸ</h2><p>æ‰§è¡Œå‘½ä»¤ <code>java -version</code> ï¼Œå¦‚æœå®‰è£…æˆåŠŸï¼Œä¼šæ‰“å°å½“å‰ java çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</p>
<h2 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h2><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚ç¼–å†™ Java ç¨‹åºï¼Œå½“ç„¶æœ‰å¿…è¦é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ IDEã€‚</p>
<p>IDEï¼ˆIntegrated Development Environmentï¼Œå³é›†æˆå¼€å‘ç¯å¢ƒï¼‰æ˜¯ç”¨äºæä¾›ç¨‹åºå¼€å‘ç¯å¢ƒçš„åº”ç”¨ç¨‹åºï¼Œä¸€èˆ¬åŒ…æ‹¬ä»£ç ç¼–è¾‘å™¨ã€ç¼–è¯‘å™¨ã€è°ƒè¯•å™¨å’Œå›¾å½¢ç”¨æˆ·ç•Œé¢ç­‰å·¥å…·ã€‚</p>
<p>å¸¸è§çš„ Java IDE å¦‚ä¸‹ï¼š</p>
<ul>
<li>Eclipse - ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„ã€åŸºäº Java çš„å¯æ‰©å±•å¼€å‘å¹³å°ã€‚</li>
<li>NetBeans - å¼€æ”¾æºç çš„ Java é›†æˆå¼€å‘ç¯å¢ƒï¼Œé€‚ç”¨äºå„ç§å®¢æˆ·æœºå’Œ Web åº”ç”¨ã€‚</li>
<li>IntelliJ IDEA - åœ¨ä»£ç è‡ªåŠ¨æç¤ºã€ä»£ç åˆ†æç­‰æ–¹é¢çš„å…·æœ‰å¾ˆå¥½çš„åŠŸèƒ½ã€‚</li>
<li>MyEclipse - ç”± Genuitec å…¬å¸å¼€å‘çš„ä¸€æ¬¾å•†ä¸šåŒ–è½¯ä»¶ï¼Œæ˜¯åº”ç”¨æ¯”è¾ƒå¹¿æ³›çš„ Java åº”ç”¨ç¨‹åºé›†æˆå¼€å‘ç¯å¢ƒã€‚</li>
<li>EditPlus - å¦‚æœæ­£ç¡®é…ç½® Java çš„ç¼–è¯‘å™¨â€œJavacâ€ä»¥åŠè§£é‡Šå™¨â€œJavaâ€åï¼Œå¯ç›´æ¥ä½¿ç”¨ EditPlus ç¼–è¯‘æ‰§è¡Œ Java ç¨‹åºã€‚</li>
</ul>
<h2 id="ç¬¬ä¸€ä¸ªç¨‹åºï¼šHello-World"><a href="#ç¬¬ä¸€ä¸ªç¨‹åºï¼šHello-World" class="headerlink" title="ç¬¬ä¸€ä¸ªç¨‹åºï¼šHello World"></a>ç¬¬ä¸€ä¸ªç¨‹åºï¼šHello World</h2><p>æ·»åŠ  HelloWorld.java æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œåï¼Œæ§åˆ¶å°è¾“å‡ºï¼š</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hello World</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/db33b0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/db33b0/" class="post-title-link" itemprop="url">Spring é¢è¯•</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-08-02 17:33:32" itemprop="dateCreated datePublished" datetime="2018-08-02T17:33:32+08:00">2018-08-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/Spring/Spring%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">Springç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>12 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Spring-é¢è¯•"><a href="#Spring-é¢è¯•" class="headerlink" title="Spring é¢è¯•"></a>Spring é¢è¯•</h1><h2 id="ç»¼åˆç¯‡"><a href="#ç»¼åˆç¯‡" class="headerlink" title="ç»¼åˆç¯‡"></a>ç»¼åˆç¯‡</h2><h3 id="ä¸åŒç‰ˆæœ¬çš„-Spring-Framework-æœ‰å“ªäº›ä¸»è¦åŠŸèƒ½ï¼Ÿ"><a href="#ä¸åŒç‰ˆæœ¬çš„-Spring-Framework-æœ‰å“ªäº›ä¸»è¦åŠŸèƒ½ï¼Ÿ" class="headerlink" title="ä¸åŒç‰ˆæœ¬çš„ Spring Framework æœ‰å“ªäº›ä¸»è¦åŠŸèƒ½ï¼Ÿ"></a>ä¸åŒç‰ˆæœ¬çš„ Spring Framework æœ‰å“ªäº›ä¸»è¦åŠŸèƒ½ï¼Ÿ</h3><table>
<thead>
<tr>
<th>Version</th>
<th>Feature</th>
</tr>
</thead>
<tbody><tr>
<td>Spring 2.5</td>
<td>å‘å¸ƒäº 2007 å¹´ã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªæ”¯æŒæ³¨è§£çš„ç‰ˆæœ¬ã€‚</td>
</tr>
<tr>
<td>Spring 3.0</td>
<td>å‘å¸ƒäº 2009 å¹´ã€‚å®ƒå®Œå…¨åˆ©ç”¨äº† Java5 ä¸­çš„æ”¹è¿›ï¼Œå¹¶ä¸º JEE6 æä¾›äº†æ”¯æŒã€‚</td>
</tr>
<tr>
<td>Spring 4.0</td>
<td>å‘å¸ƒäº 2013 å¹´ã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªå®Œå…¨æ”¯æŒ JAVA8 çš„ç‰ˆæœ¬ã€‚</td>
</tr>
</tbody></table>
<h3 id="ä»€ä¹ˆæ˜¯-Spring-Frameworkï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Spring-Frameworkï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Spring Frameworkï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Spring Frameworkï¼Ÿ</h3><ul>
<li>Spring æ˜¯ä¸€ä¸ªå¼€æºåº”ç”¨æ¡†æ¶ï¼Œæ—¨åœ¨é™ä½åº”ç”¨ç¨‹åºå¼€å‘çš„å¤æ‚åº¦ã€‚</li>
<li>å®ƒæ˜¯è½»é‡çº§ã€æ¾æ•£è€¦åˆçš„ã€‚</li>
<li>å®ƒå…·æœ‰åˆ†å±‚ä½“ç³»ç»“æ„ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©ç»„ä»¶ï¼ŒåŒæ—¶è¿˜ä¸º J2EE åº”ç”¨ç¨‹åºå¼€å‘æä¾›äº†ä¸€ä¸ªæœ‰å‡èšåŠ›çš„æ¡†æ¶ã€‚</li>
<li>å®ƒå¯ä»¥é›†æˆå…¶ä»–æ¡†æ¶ï¼Œå¦‚ Structsã€Hibernateã€EJB ç­‰ï¼Œæ‰€ä»¥åˆç§°ä¸ºæ¡†æ¶çš„æ¡†æ¶ã€‚</li>
</ul>
<h3 id="åˆ—ä¸¾-Spring-Framework-çš„ä¼˜ç‚¹ã€‚"><a href="#åˆ—ä¸¾-Spring-Framework-çš„ä¼˜ç‚¹ã€‚" class="headerlink" title="åˆ—ä¸¾ Spring Framework çš„ä¼˜ç‚¹ã€‚"></a>åˆ—ä¸¾ Spring Framework çš„ä¼˜ç‚¹ã€‚</h3><ul>
<li>ç”±äº Spring Frameworks çš„åˆ†å±‚æ¶æ„ï¼Œç”¨æˆ·å¯ä»¥è‡ªç”±é€‰æ‹©è‡ªå·±éœ€è¦çš„ç»„ä»¶ã€‚</li>
<li>Spring Framework æ”¯æŒ POJO(Plain Old Java Object) ç¼–ç¨‹ï¼Œä»è€Œå…·å¤‡æŒç»­é›†æˆå’Œå¯æµ‹è¯•æ€§ã€‚</li>
<li>ç”±äºä¾èµ–æ³¨å…¥å’Œæ§åˆ¶åè½¬ï¼ŒJDBC å¾—ä»¥ç®€åŒ–ã€‚</li>
<li>å®ƒæ˜¯å¼€æºå…è´¹çš„ã€‚</li>
</ul>
<h3 id="Spring-Framework-æœ‰å“ªäº›ä¸åŒçš„åŠŸèƒ½ï¼Ÿ"><a href="#Spring-Framework-æœ‰å“ªäº›ä¸åŒçš„åŠŸèƒ½ï¼Ÿ" class="headerlink" title="Spring Framework æœ‰å“ªäº›ä¸åŒçš„åŠŸèƒ½ï¼Ÿ"></a>Spring Framework æœ‰å“ªäº›ä¸åŒçš„åŠŸèƒ½ï¼Ÿ</h3><ul>
<li><strong>è½»é‡çº§</strong> - Spring åœ¨ä»£ç é‡å’Œé€æ˜åº¦æ–¹é¢éƒ½å¾ˆè½»ä¾¿ã€‚</li>
<li><strong>IOC</strong> - æ§åˆ¶åè½¬</li>
<li><strong>AOP</strong> - é¢å‘åˆ‡é¢ç¼–ç¨‹å¯ä»¥å°†åº”ç”¨ä¸šåŠ¡é€»è¾‘å’Œç³»ç»ŸæœåŠ¡åˆ†ç¦»ï¼Œä»¥å®ç°é«˜å†…èšã€‚</li>
<li><strong>å®¹å™¨</strong> - Spring è´Ÿè´£åˆ›å»ºå’Œç®¡ç†å¯¹è±¡ï¼ˆBeanï¼‰çš„ç”Ÿå‘½å‘¨æœŸå’Œé…ç½®ã€‚</li>
<li><strong>MVC</strong> - å¯¹ web åº”ç”¨æä¾›äº†é«˜åº¦å¯é…ç½®æ€§ï¼Œå…¶ä»–æ¡†æ¶çš„é›†æˆä¹Ÿååˆ†æ–¹ä¾¿ã€‚</li>
<li><strong>äº‹åŠ¡ç®¡ç†</strong> - æä¾›äº†ç”¨äºäº‹åŠ¡ç®¡ç†çš„é€šç”¨æŠ½è±¡å±‚ã€‚Spring çš„äº‹åŠ¡æ”¯æŒä¹Ÿå¯ç”¨äºå®¹å™¨è¾ƒå°‘çš„ç¯å¢ƒã€‚</li>
<li><strong>JDBC å¼‚å¸¸</strong> - Spring çš„ JDBC æŠ½è±¡å±‚æä¾›äº†ä¸€ä¸ªå¼‚å¸¸å±‚æ¬¡ç»“æ„ï¼Œç®€åŒ–äº†é”™è¯¯å¤„ç†ç­–ç•¥ã€‚</li>
</ul>
<h3 id="Spring-Framework-ä¸­æœ‰å¤šå°‘ä¸ªæ¨¡å—ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Spring-Framework-ä¸­æœ‰å¤šå°‘ä¸ªæ¨¡å—ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Spring Framework ä¸­æœ‰å¤šå°‘ä¸ªæ¨¡å—ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Spring Framework ä¸­æœ‰å¤šå°‘ä¸ªæ¨¡å—ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/spring/spring-framework.png" alt="img"></p>
<ul>
<li><strong>Spring æ ¸å¿ƒå®¹å™¨</strong> â€“ è¯¥å±‚åŸºæœ¬ä¸Šæ˜¯ Spring Framework çš„æ ¸å¿ƒã€‚å®ƒåŒ…å«ä»¥ä¸‹æ¨¡å—ï¼š<ul>
<li>Spring Core</li>
<li>Spring Bean</li>
<li>SpEL (Spring Expression Language)</li>
<li>Spring Context</li>
</ul>
</li>
<li><strong>æ•°æ®è®¿é—®&#x2F;é›†æˆ</strong> â€“ è¯¥å±‚æä¾›ä¸æ•°æ®åº“äº¤äº’çš„æ”¯æŒã€‚å®ƒåŒ…å«ä»¥ä¸‹æ¨¡å—ï¼š<ul>
<li>JDBC (Java DataBase Connectivity)</li>
<li>ORM (Object Relational Mapping)</li>
<li>OXM (Object XML Mappers)</li>
<li>JMS (Java Messaging Service)</li>
<li>Transaction</li>
</ul>
</li>
<li><strong>Web</strong> â€“ è¯¥å±‚æä¾›äº†åˆ›å»º Web åº”ç”¨ç¨‹åºçš„æ”¯æŒã€‚å®ƒåŒ…å«ä»¥ä¸‹æ¨¡å—ï¼š<ul>
<li>Web</li>
<li>Web â€“ Servlet</li>
<li>Web â€“ Socket</li>
<li>Web â€“ Portlet</li>
</ul>
</li>
<li><strong>AOP</strong> â€“ è¯¥å±‚æ”¯æŒé¢å‘åˆ‡é¢ç¼–ç¨‹</li>
<li><strong>Instrumentation</strong> â€“ è¯¥å±‚ä¸ºç±»æ£€æµ‹å’Œç±»åŠ è½½å™¨å®ç°æä¾›æ”¯æŒã€‚</li>
<li><strong>Test</strong> â€“ è¯¥å±‚ä¸ºä½¿ç”¨ JUnit å’Œ TestNG è¿›è¡Œæµ‹è¯•æä¾›æ”¯æŒã€‚</li>
<li><strong>å‡ ä¸ªæ‚é¡¹æ¨¡å—:</strong><ul>
<li>Messaging â€“ è¯¥æ¨¡å—ä¸º STOMP æä¾›æ”¯æŒã€‚å®ƒè¿˜æ”¯æŒæ³¨è§£ç¼–ç¨‹æ¨¡å‹ï¼Œè¯¥æ¨¡å‹ç”¨äºä» WebSocket å®¢æˆ·ç«¯è·¯ç”±å’Œå¤„ç† STOMP æ¶ˆæ¯ã€‚</li>
<li>Aspects â€“ è¯¥æ¨¡å—ä¸ºä¸ AspectJ çš„é›†æˆæä¾›æ”¯æŒã€‚</li>
</ul>
</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯-Spring-é…ç½®æ–‡ä»¶ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Spring-é…ç½®æ–‡ä»¶ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Spring é…ç½®æ–‡ä»¶ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Spring é…ç½®æ–‡ä»¶ï¼Ÿ</h3><p>Spring é…ç½®æ–‡ä»¶æ˜¯ XML æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä¸»è¦åŒ…å«ç±»ä¿¡æ¯ã€‚å®ƒæè¿°äº†è¿™äº›ç±»æ˜¯å¦‚ä½•é…ç½®ä»¥åŠç›¸äº’å¼•å…¥çš„ã€‚ä½†æ˜¯ï¼ŒXML é…ç½®æ–‡ä»¶å†—é•¿ä¸”æ›´åŠ å¹²å‡€ã€‚å¦‚æœæ²¡æœ‰æ­£ç¡®è§„åˆ’å’Œç¼–å†™ï¼Œé‚£ä¹ˆåœ¨å¤§é¡¹ç›®ä¸­ç®¡ç†å˜å¾—éå¸¸å›°éš¾ã€‚</p>
<h3 id="Spring-åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ"><a href="#Spring-åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ" class="headerlink" title="Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ"></a>Spring åº”ç”¨ç¨‹åºæœ‰å“ªäº›ä¸åŒç»„ä»¶ï¼Ÿ</h3><p>Spring åº”ç”¨ä¸€èˆ¬æœ‰ä»¥ä¸‹ç»„ä»¶ï¼š</p>
<ul>
<li><strong>æ¥å£</strong> - å®šä¹‰åŠŸèƒ½ã€‚</li>
<li><strong>Bean ç±»</strong> - å®ƒåŒ…å«å±æ€§ï¼Œsetter å’Œ getter æ–¹æ³•ï¼Œå‡½æ•°ç­‰ã€‚</li>
<li><strong>Spring é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰</strong> - æä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹çš„åŠŸèƒ½ã€‚</li>
<li><strong>Bean é…ç½®æ–‡ä»¶</strong> - åŒ…å«ç±»çš„ä¿¡æ¯ä»¥åŠå¦‚ä½•é…ç½®å®ƒä»¬ã€‚</li>
<li><strong>ç”¨æˆ·ç¨‹åº</strong> - å®ƒä½¿ç”¨æ¥å£ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨-Spring-æœ‰å“ªäº›æ–¹å¼ï¼Ÿ"><a href="#ä½¿ç”¨-Spring-æœ‰å“ªäº›æ–¹å¼ï¼Ÿ" class="headerlink" title="ä½¿ç”¨ Spring æœ‰å“ªäº›æ–¹å¼ï¼Ÿ"></a>ä½¿ç”¨ Spring æœ‰å“ªäº›æ–¹å¼ï¼Ÿ</h3><p>ä½¿ç”¨ Spring æœ‰ä»¥ä¸‹æ–¹å¼ï¼š</p>
<ul>
<li>ä½œä¸ºä¸€ä¸ªæˆç†Ÿçš„ Spring Web åº”ç”¨ç¨‹åºã€‚</li>
<li>ä½œä¸ºç¬¬ä¸‰æ–¹ Web æ¡†æ¶ï¼Œä½¿ç”¨ Spring Frameworks ä¸­é—´å±‚ã€‚</li>
<li>ç”¨äºè¿œç¨‹ä½¿ç”¨ã€‚</li>
<li>ä½œä¸ºä¼ä¸šçº§ Java Beanï¼Œå®ƒå¯ä»¥åŒ…è£…ç°æœ‰çš„ POJOï¼ˆPlain Old Java Objectsï¼‰ã€‚</li>
</ul>
<h2 id="æ ¸å¿ƒç¯‡"><a href="#æ ¸å¿ƒç¯‡" class="headerlink" title="æ ¸å¿ƒç¯‡"></a>æ ¸å¿ƒç¯‡</h2><h3 id="IoC"><a href="#IoC" class="headerlink" title="IoC"></a>IoC</h3><h4 id="ä»€ä¹ˆæ˜¯-IoCï¼Ÿä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼Ÿä»€ä¹ˆæ˜¯-Spring-IoCï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-IoCï¼Ÿä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼Ÿä»€ä¹ˆæ˜¯-Spring-IoCï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ IoCï¼Ÿä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼Ÿä»€ä¹ˆæ˜¯ Spring IoCï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ IoCï¼Ÿä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼Ÿä»€ä¹ˆæ˜¯ Spring IoCï¼Ÿ</h4><p><strong>IoC</strong> å³<strong>æ§åˆ¶åè½¬</strong>ï¼ˆInversion of Controlï¼Œç¼©å†™ä¸º IoCï¼‰ã€‚IoC åˆç§°ä¸º<strong>ä¾èµ–å€’ç½®åŸåˆ™</strong>ï¼ˆè®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™ä¹‹ä¸€ï¼‰ï¼Œå®ƒçš„è¦ç‚¹åœ¨äºï¼š<strong>ç¨‹åºè¦ä¾èµ–äºæŠ½è±¡æ¥å£ï¼Œä¸è¦ä¾èµ–äºå…·ä½“å®ç°</strong>ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯<strong>ç”¨äºé™ä½ä»£ç é—´çš„è€¦åˆåº¦</strong>ã€‚</p>
<p>IoC çš„å®ç°æ–¹å¼æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼ˆDependency Injectionï¼Œç®€ç§° DIï¼‰ï¼šä¸é€šè¿‡ <code>new()</code> çš„æ–¹å¼åœ¨ç±»å†…éƒ¨åˆ›å»ºä¾èµ–ç±»å¯¹è±¡ï¼Œè€Œæ˜¯å°†ä¾èµ–çš„ç±»å¯¹è±¡åœ¨å¤–éƒ¨åˆ›å»ºå¥½ä¹‹åï¼Œé€šè¿‡æ„é€ å™¨ã€å‡½æ•°å‚æ•°ç­‰æ–¹å¼ä¼ é€’ï¼ˆæˆ–æ³¨å…¥ï¼‰ç»™ç±»ä½¿ç”¨ã€‚</li>
<li><strong>ä¾èµ–æŸ¥æ‰¾</strong>ï¼ˆDependency Lookupï¼‰ï¼šå®¹å™¨ä¸­çš„å—æ§å¯¹è±¡é€šè¿‡å®¹å™¨çš„ API æ¥æŸ¥æ‰¾è‡ªå·±æ‰€ä¾èµ–çš„èµ„æºå’Œåä½œå¯¹è±¡ã€‚</li>
</ul>
<p>Spring IoC æ˜¯ IoC çš„ä¸€ç§å®ç°ã€‚DI æ˜¯ Spring IoC çš„ä¸»è¦å®ç°åŸåˆ™ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20221005163639.png"></p>
<h4 id="ä¾èµ–æ³¨å…¥æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ"><a href="#ä¾èµ–æ³¨å…¥æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ" class="headerlink" title="ä¾èµ–æ³¨å…¥æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ"></a>ä¾èµ–æ³¨å…¥æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h4><p>ä¾èµ–æ³¨å…¥æœ‰å¦‚ä¸‹æ–¹å¼ï¼š</p>
<table>
<thead>
<tr>
<th>ä¾èµ–æ³¨å…¥æ–¹å¼</th>
<th>é…ç½®å…ƒæ•°æ®ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>Setter æ–¹æ³•æ³¨å…¥</td>
<td><code>&lt;proeprty name=&quot;user&quot; ref=&quot;userBean&quot;/&gt;</code></td>
</tr>
<tr>
<td>æ„é€ å™¨æ³¨å…¥</td>
<td><code>&lt;constructor-arg name=&quot;user&quot; ref=&quot;userBean&quot; /&gt;</code></td>
</tr>
<tr>
<td>å­—æ®µæ³¨å…¥</td>
<td><code>@Autowired User user;</code></td>
</tr>
<tr>
<td>æ–¹æ³•æ³¨å…¥</td>
<td><code>@Autowired public void user(User user) &#123; ... &#125;</code></td>
</tr>
<tr>
<td>æ¥å£å›è°ƒæ³¨å…¥</td>
<td><code>class MyBean implements BeanFactoryAware &#123; ... &#125;</code></td>
</tr>
</tbody></table>
<h4 id="æ„é€ å™¨æ³¨å…¥-VS-setter-æ³¨å…¥"><a href="#æ„é€ å™¨æ³¨å…¥-VS-setter-æ³¨å…¥" class="headerlink" title="æ„é€ å™¨æ³¨å…¥ VS. setter æ³¨å…¥"></a>æ„é€ å™¨æ³¨å…¥ VS. setter æ³¨å…¥</h4><table>
<thead>
<tr>
<th>æ„é€ å™¨æ³¨å…¥</th>
<th>setter æ³¨å…¥</th>
</tr>
</thead>
<tbody><tr>
<td>æ²¡æœ‰éƒ¨åˆ†æ³¨å…¥</td>
<td>æœ‰éƒ¨åˆ†æ³¨å…¥</td>
</tr>
<tr>
<td>ä¸ä¼šè¦†ç›– setter å±æ€§</td>
<td>ä¼šè¦†ç›– setter å±æ€§</td>
</tr>
<tr>
<td>ä»»æ„ä¿®æ”¹éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹</td>
<td>ä»»æ„ä¿®æ”¹ä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹</td>
</tr>
<tr>
<td>é€‚ç”¨äºè®¾ç½®å¾ˆå¤šå±æ€§</td>
<td>é€‚ç”¨äºè®¾ç½®å°‘é‡å±æ€§</td>
</tr>
</tbody></table>
<p>å®˜æ–¹æ¨èä½¿ç”¨æ„é€ å™¨æ³¨å…¥ã€‚</p>
<h4 id="BeanFactory-VS-ApplicationContext"><a href="#BeanFactory-VS-ApplicationContext" class="headerlink" title="BeanFactory VS. ApplicationContext"></a>BeanFactory VS. ApplicationContext</h4><p>åœ¨ Spring ä¸­ï¼Œæœ‰ä¸¤ç§ IoC å®¹å™¨ï¼š<code>BeanFactory</code> å’Œ <code>ApplicationContext</code>ã€‚</p>
<ul>
<li><code>BeanFactory</code>ï¼š**<code>BeanFactory</code> æ˜¯ Spring åŸºç¡€ IoC å®¹å™¨**ã€‚<code>BeanFactory</code> æä¾›äº† Spring å®¹å™¨çš„é…ç½®æ¡†æ¶å’ŒåŸºæœ¬åŠŸèƒ½ã€‚</li>
<li><code>ApplicationContext</code>ï¼š**<code>ApplicationContext</code> æ˜¯å…·å¤‡åº”ç”¨ç‰¹æ€§çš„ <code>BeanFactory</code> çš„å­æ¥å£**ã€‚å®ƒè¿˜æ‰©å±•äº†å…¶ä»–ä¸€äº›æ¥å£ï¼Œä»¥æ”¯æŒæ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¦‚ï¼šå›½é™…åŒ–ã€è®¿é—®èµ„æºã€äº‹ä»¶æœºåˆ¶ã€æ›´æ–¹ä¾¿çš„æ”¯æŒ AOPã€åœ¨ web åº”ç”¨ä¸­æŒ‡å®šåº”ç”¨å±‚ä¸Šä¸‹æ–‡ç­‰ã€‚</li>
</ul>
<p>å®é™…å¼€å‘ä¸­ï¼Œæ›´æ¨èä½¿ç”¨ <code>ApplicationContext</code> ä½œä¸º IoC å®¹å™¨ï¼Œå› ä¸ºå®ƒçš„åŠŸèƒ½è¿œå¤šäº <code>BeanFactory</code>ã€‚</p>
<h4 id="BeanFactory-VS-FactoryBean"><a href="#BeanFactory-VS-FactoryBean" class="headerlink" title="BeanFactory VS. FactoryBean"></a>BeanFactory VS. FactoryBean</h4><p><strong><code>BeanFactory</code> æ˜¯ Spring åŸºç¡€ IoC å®¹å™¨</strong>ã€‚</p>
<p><code>FactoryBean</code> æ˜¯åˆ›å»º Bean çš„ä¸€ç§æ–¹å¼ï¼Œå¸®åŠ©å®ç°å¤æ‚çš„åˆå§‹åŒ–é€»è¾‘ã€‚</p>
<h4 id="Spring-IoC-å¯åŠ¨æ—¶åšäº†å“ªäº›å‡†å¤‡"><a href="#Spring-IoC-å¯åŠ¨æ—¶åšäº†å“ªäº›å‡†å¤‡" class="headerlink" title="Spring IoC å¯åŠ¨æ—¶åšäº†å“ªäº›å‡†å¤‡"></a>Spring IoC å¯åŠ¨æ—¶åšäº†å“ªäº›å‡†å¤‡</h4><p>IoC é…ç½®å…ƒä¿¡æ¯è¯»å–å’Œè§£æ</p>
<p>IoC å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</p>
<p>Spring äº‹ä»¶å‘å¸ƒ</p>
<p>å›½é™…åŒ–</p>
<p>ç­‰ç­‰</p>
<h4 id="Spring-IoC-çš„å®ç°æœºåˆ¶æ˜¯ä»€ä¹ˆ"><a href="#Spring-IoC-çš„å®ç°æœºåˆ¶æ˜¯ä»€ä¹ˆ" class="headerlink" title="Spring IoC çš„å®ç°æœºåˆ¶æ˜¯ä»€ä¹ˆ"></a>Spring IoC çš„å®ç°æœºåˆ¶æ˜¯ä»€ä¹ˆ</h4><p>Spring ä¸­çš„ IoC çš„å®ç°åŸç†å°±æ˜¯å·¥å‚æ¨¡å¼åŠ åå°„æœºåˆ¶ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Apple</span> <span class="keyword">implements</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Apple&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Orange</span> <span class="keyword">implements</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Orange&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Factory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fruit <span class="title function_">getInstance</span><span class="params">(String ClassName)</span> &#123;</span><br><span class="line">        Fruit f=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            f=(Fruit)Class.forName(ClassName).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] a)</span> &#123;</span><br><span class="line">        Fruit f=Factory.getInstance(<span class="string">&quot;io.github.dunwu.spring.Apple&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(f!=<span class="literal">null</span>)&#123;</span><br><span class="line">            f.eat();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Bean"><a href="#Bean" class="headerlink" title="Bean"></a>Bean</h3><h4 id="ä»€ä¹ˆæ˜¯-Spring-Bean"><a href="#ä»€ä¹ˆæ˜¯-Spring-Bean" class="headerlink" title="ä»€ä¹ˆæ˜¯ Spring Bean"></a>ä»€ä¹ˆæ˜¯ Spring Bean</h4><p>åœ¨ Spring ä¸­ï¼Œæ„æˆåº”ç”¨ç¨‹åºä¸»ä½“ç”± Spring IoC å®¹å™¨ç®¡ç†çš„å¯¹è±¡ç§°ä¸º Beanã€‚<strong>Bean æ˜¯ç”± Spring IoC å®¹å™¨å®ä¾‹åŒ–ã€è£…é…å’Œç®¡ç†çš„å¯¹è±¡</strong>ã€‚ Bean ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»åæ˜ åœ¨å®¹å™¨ä½¿ç”¨çš„é…ç½®å…ƒæ•°æ®ä¸­ã€‚</p>
<p>Spring IoC å®¹å™¨æœ¬èº«ï¼Œå¹¶ä¸èƒ½è¯†åˆ«é…ç½®çš„å…ƒæ•°æ®ã€‚ä¸ºæ­¤ï¼Œè¦å°†è¿™äº›é…ç½®ä¿¡æ¯è½¬ä¸º Spring èƒ½è¯†åˆ«çš„æ ¼å¼â€”â€”<code>BeanDefinition</code> å¯¹è±¡ã€‚</p>
<p><strong><code>BeanDefinition</code> æ˜¯ Spring ä¸­å®šä¹‰ Bean çš„é…ç½®å…ƒä¿¡æ¯æ¥å£</strong>ï¼Œå®ƒåŒ…å«ï¼š</p>
<ul>
<li>Bean ç±»å</li>
<li>Bean è¡Œä¸ºé…ç½®å…ƒç´ ï¼Œå¦‚ï¼šä½œç”¨åŸŸã€è‡ªåŠ¨ç»‘å®šçš„æ¨¡å¼ã€ç”Ÿå‘½å‘¨æœŸå›è°ƒç­‰</li>
<li>å…¶ä»– Bean å¼•ç”¨ï¼Œä¹Ÿå¯ç§°ä¸ºåˆä½œè€…ï¼ˆCollaboratorsï¼‰æˆ–ä¾èµ–ï¼ˆDependenciesï¼‰</li>
<li>é…ç½®è®¾ç½®ï¼Œå¦‚ Bean å±æ€§ï¼ˆPropertiesï¼‰</li>
</ul>
<h4 id="å¦‚ä½•æ³¨å†Œ-Spring-Bean"><a href="#å¦‚ä½•æ³¨å†Œ-Spring-Bean" class="headerlink" title="å¦‚ä½•æ³¨å†Œ Spring Bean"></a>å¦‚ä½•æ³¨å†Œ Spring Bean</h4><p>é€šè¿‡ <code>BeanDefinition</code> å’Œå¤–éƒ¨å•ä¾‹å¯¹è±¡æ¥æ³¨å†Œã€‚</p>
<h4 id="spring-æä¾›äº†å“ªäº›é…ç½®æ–¹å¼ï¼Ÿ"><a href="#spring-æä¾›äº†å“ªäº›é…ç½®æ–¹å¼ï¼Ÿ" class="headerlink" title="spring æä¾›äº†å“ªäº›é…ç½®æ–¹å¼ï¼Ÿ"></a>spring æä¾›äº†å“ªäº›é…ç½®æ–¹å¼ï¼Ÿ</h4><ul>
<li>åŸºäº xml é…ç½®</li>
</ul>
<p>bean æ‰€éœ€çš„ä¾èµ–é¡¹å’ŒæœåŠ¡åœ¨ XML æ ¼å¼çš„é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šã€‚è¿™äº›é…ç½®æ–‡ä»¶é€šå¸¸åŒ…å«è®¸å¤š bean å®šä¹‰å’Œç‰¹å®šäºåº”ç”¨ç¨‹åºçš„é…ç½®é€‰é¡¹ã€‚å®ƒä»¬é€šå¸¸ä»¥ bean æ ‡ç­¾å¼€å¤´ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;studentbean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.edureka.firstSpring.StudentBean&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Edureka&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åŸºäºæ³¨è§£é…ç½®</li>
</ul>
<p>æ‚¨å¯ä»¥é€šè¿‡åœ¨ç›¸å…³çš„ç±»ï¼Œæ–¹æ³•æˆ–å­—æ®µå£°æ˜ä¸Šä½¿ç”¨æ³¨è§£ï¼Œå°† bean é…ç½®ä¸ºç»„ä»¶ç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ XML æ¥æè¿° bean è£…é…ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring å®¹å™¨ä¸­æœªæ‰“å¼€æ³¨è§£è£…é…ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦åœ¨ä½¿ç”¨å®ƒä¹‹å‰åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å¯ç”¨å®ƒã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- bean definitions go here --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åŸºäº Java API é…ç½®</li>
</ul>
<p>Spring çš„ Java é…ç½®æ˜¯é€šè¿‡ä½¿ç”¨ @Bean å’Œ @Configuration æ¥å®ç°ã€‚</p>
<ol>
<li>@Bean æ³¨è§£æ‰®æ¼”ä¸ <code>&lt;bean /&gt;</code> å…ƒç´ ç›¸åŒçš„è§’è‰²ã€‚</li>
<li>@Configuration ç±»å…è®¸é€šè¿‡ç®€å•åœ°è°ƒç”¨åŒä¸€ä¸ªç±»ä¸­çš„å…¶ä»– @Bean æ–¹æ³•æ¥å®šä¹‰ bean é—´ä¾èµ–å…³ç³»ã€‚</li>
</ol>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> StudentBean <span class="title function_">myStudent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StudentBean</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="spring-æ”¯æŒé›†ä¸­-bean-scopeï¼Ÿ"><a href="#spring-æ”¯æŒé›†ä¸­-bean-scopeï¼Ÿ" class="headerlink" title="spring æ”¯æŒé›†ä¸­ bean scopeï¼Ÿ"></a>spring æ”¯æŒé›†ä¸­ bean scopeï¼Ÿ</h4><p>Spring bean æ”¯æŒ 5 ç§ scopeï¼š</p>
<ul>
<li><strong>Singleton</strong> - æ¯ä¸ª Spring IoC å®¹å™¨ä»…æœ‰ä¸€ä¸ªå•å®ä¾‹ã€‚</li>
<li><strong>Prototype</strong> - æ¯æ¬¡è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</li>
<li><strong>Request</strong> - æ¯ä¸€æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå¹¶ä¸”è¯¥ bean ä»…åœ¨å½“å‰ HTTP è¯·æ±‚å†…æœ‰æ•ˆã€‚</li>
<li><strong>Session</strong> - æ¯ä¸€æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ beanï¼ŒåŒæ—¶è¯¥ bean ä»…åœ¨å½“å‰ HTTP session å†…æœ‰æ•ˆã€‚</li>
<li><strong>Global-session</strong> - ç±»ä¼¼äºæ ‡å‡†çš„ HTTP Session ä½œç”¨åŸŸï¼Œä¸è¿‡å®ƒä»…ä»…åœ¨åŸºäº portlet çš„ web åº”ç”¨ä¸­æ‰æœ‰æ„ä¹‰ã€‚Portlet è§„èŒƒå®šä¹‰äº†å…¨å±€ Session çš„æ¦‚å¿µï¼Œå®ƒè¢«æ‰€æœ‰æ„æˆæŸä¸ª portlet web åº”ç”¨çš„å„ç§ä¸åŒçš„ portlet æ‰€å…±äº«ã€‚åœ¨ global session ä½œç”¨åŸŸä¸­å®šä¹‰çš„ bean è¢«é™å®šäºå…¨å±€ portlet Session çš„ç”Ÿå‘½å‘¨æœŸèŒƒå›´å†…ã€‚å¦‚æœä½ åœ¨ web ä¸­ä½¿ç”¨ global session ä½œç”¨åŸŸæ¥æ ‡è¯† beanï¼Œé‚£ä¹ˆ web ä¼šè‡ªåŠ¨å½“æˆ session ç±»å‹æ¥ä½¿ç”¨ã€‚</li>
</ul>
<p>ä»…å½“ç”¨æˆ·ä½¿ç”¨æ”¯æŒ Web çš„ ApplicationContext æ—¶ï¼Œæœ€åä¸‰ä¸ªæ‰å¯ç”¨ã€‚</p>
<h4 id="Spring-Bean-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Spring-Bean-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ"></a>Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ</h4><p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211201102734.png"></p>
<p>spring bean å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š</p>
<ol>
<li><p>Spring å¯¹ Bean è¿›è¡Œå®ä¾‹åŒ–ï¼ˆç›¸å½“äº new XXX()ï¼‰</p>
</li>
<li><p>Spring å°†å€¼å’Œå¼•ç”¨æ³¨å…¥åˆ° Bean å¯¹åº”çš„å±æ€§ä¸­</p>
</li>
<li><p>å¦‚æœ Bean å®ç°äº† <code>BeanNameAware</code> æ¥å£ï¼ŒSpring å°† Bean çš„ ID ä¼ é€’ç»™ <code>setBeanName</code> æ–¹æ³•</p>
<ul>
<li>ä½œç”¨æ˜¯é€šè¿‡ Bean çš„å¼•ç”¨æ¥è·å¾— Bean IDï¼Œä¸€èˆ¬ä¸šåŠ¡ä¸­æ˜¯å¾ˆå°‘æœ‰ç”¨åˆ° Bean çš„ ID çš„</li>
</ul>
</li>
<li><p>å¦‚æœ Bean å®ç°äº† <code>BeanFactoryAware</code> æ¥å£ï¼ŒSpring å°†è°ƒç”¨ <code>setBeanDactory</code> æ–¹æ³•ï¼Œå¹¶æŠŠ <code>BeanFactory</code> å®¹å™¨å®ä¾‹ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚</p>
<ul>
<li>ä½œç”¨æ˜¯è·å– Spring å®¹å™¨ï¼Œå¦‚ Bean é€šè¿‡ Spring å®¹å™¨å‘å¸ƒäº‹ä»¶ç­‰</li>
</ul>
</li>
<li><p>å¦‚æœ Bean å®ç°äº† <code>ApplicationContextAware</code> æ¥å£ï¼ŒSpring å®¹å™¨å°†è°ƒç”¨ <code>setApplicationContext</code> æ–¹æ³•ï¼ŒæŠŠåº”ç”¨ä¸Šä¸‹æ–‡ä½œä¸ºå‚æ•°ä¼ å…¥</p>
<ul>
<li>ä½œç”¨ä¸ <code>BeanFactory</code> ç±»ä¼¼éƒ½æ˜¯ä¸ºäº†è·å– Spring å®¹å™¨ï¼Œä¸åŒçš„æ˜¯ Spring å®¹å™¨åœ¨è°ƒç”¨ <code>setApplicationContext</code> æ–¹æ³•æ—¶ä¼šæŠŠå®ƒè‡ªå·±ä½œä¸º <code>setApplicationContext</code> çš„å‚æ•°ä¼ å…¥ï¼Œè€Œ Spring å®¹å™¨åœ¨è°ƒç”¨ <code>setBeanFactory</code> å‰éœ€è¦ä½¿ç”¨è€…è‡ªå·±æŒ‡å®šï¼ˆæ³¨å…¥ï¼‰<code>setBeanFactory</code> é‡Œçš„å‚æ•° <code>BeanFactory</code></li>
</ul>
</li>
<li><p>å¦‚æœ Bean å®ç°äº† <code>BeanPostProcess</code> æ¥å£ï¼ŒSpring å°†è°ƒç”¨ <code>postProcessBeforeInitialization</code> æ–¹æ³•</p>
<ul>
<li>ä½œç”¨æ˜¯åœ¨ Bean å®ä¾‹åˆ›å»ºæˆåŠŸåå¯¹å…¶è¿›è¡Œå¢å¼ºå¤„ç†ï¼Œå¦‚å¯¹ Bean è¿›è¡Œä¿®æ”¹ï¼Œå¢åŠ æŸä¸ªåŠŸèƒ½</li>
</ul>
</li>
<li><p>å¦‚æœ Bean å®ç°äº† <code>InitializingBean</code> æ¥å£ï¼ŒSpring å°†è°ƒç”¨ <code>afterPropertiesSet</code> æ–¹æ³•ï¼Œä½œç”¨ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­å¯¹ Bean ä½¿ç”¨ <code>init-method</code> å£°æ˜åˆå§‹åŒ–çš„ä½œç”¨ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨ Bean çš„å…¨éƒ¨å±æ€§è®¾ç½®æˆåŠŸåæ‰§è¡Œçš„åˆå§‹åŒ–æ–¹æ³•ã€‚</p>
</li>
<li><p>å¦‚æœ Bean å®ç°äº† <code>BeanPostProcess</code> æ¥å£ï¼ŒSpring å°†è°ƒç”¨ <code>postProcessAfterInitialization</code> æ–¹æ³•</p>
<ul>
<li><code>postProcessBeforeInitialization</code> æ˜¯åœ¨ Bean åˆå§‹åŒ–å‰æ‰§è¡Œçš„ï¼Œè€Œ <code>postProcessAfterInitialization</code> æ˜¯åœ¨ Bean åˆå§‹åŒ–åæ‰§è¡Œçš„</li>
</ul>
</li>
<li><p>ç»è¿‡ä»¥ä¸Šçš„å·¥ä½œåï¼ŒBean å°†ä¸€ç›´é©»ç•™åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ç»™åº”ç”¨ä½¿ç”¨ï¼Œç›´åˆ°åº”ç”¨ä¸Šä¸‹æ–‡è¢«é”€æ¯</p>
</li>
<li><p>å¦‚æœ Bean å®ç°äº† <code>DispostbleBean</code> æ¥å£ï¼ŒSpring å°†è°ƒç”¨å®ƒçš„ <code>destory</code> æ–¹æ³•ï¼Œä½œç”¨ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­å¯¹ Bean ä½¿ç”¨ <code>destory-method</code> å±æ€§çš„ä½œç”¨ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨ Bean å®ä¾‹é”€æ¯å‰æ‰§è¡Œçš„æ–¹æ³•ã€‚</p>
</li>
</ol>
<h4 id="ä»€ä¹ˆæ˜¯-spring-çš„å†…éƒ¨-beanï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-spring-çš„å†…éƒ¨-beanï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ spring çš„å†…éƒ¨ beanï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ spring çš„å†…éƒ¨ beanï¼Ÿ</h4><p>åªæœ‰å°† bean ç”¨ä½œå¦ä¸€ä¸ª bean çš„å±æ€§æ—¶ï¼Œæ‰èƒ½å°† bean å£°æ˜ä¸ºå†…éƒ¨ beanã€‚ä¸ºäº†å®šä¹‰ beanï¼ŒSpring çš„åŸºäº XML çš„é…ç½®å…ƒæ•°æ®åœ¨ <code>&lt;property&gt;</code> æˆ– <code>&lt;constructor-arg&gt;</code> ä¸­æä¾›äº† <code>&lt;bean&gt;</code> å…ƒç´ çš„ä½¿ç”¨ã€‚å†…éƒ¨ bean æ€»æ˜¯åŒ¿åçš„ï¼Œå®ƒä»¬æ€»æ˜¯ä½œä¸ºåŸå‹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Student ç±»ï¼Œå…¶ä¸­å¼•ç”¨äº† Person ç±»ã€‚è¿™é‡Œæˆ‘ä»¬å°†åªåˆ›å»ºä¸€ä¸ª Person ç±»å®ä¾‹å¹¶åœ¨ Student ä¸­ä½¿ç”¨å®ƒã€‚</p>
<p>Student.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line">    <span class="comment">//Setters and Getters</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="comment">//Setters and Getters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>bean.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">â€œStudentBean</span>&quot; <span class="attr">class</span>=<span class="string">&quot;com.edureka.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;person&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--This is inner bean --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.edureka.Person&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">â€œScott</span>&quot;&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">â€œBangalore</span>&quot;&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä»€ä¹ˆæ˜¯-spring-è£…é…"><a href="#ä»€ä¹ˆæ˜¯-spring-è£…é…" class="headerlink" title="ä»€ä¹ˆæ˜¯ spring è£…é…"></a>ä»€ä¹ˆæ˜¯ spring è£…é…</h4><p>å½“ bean åœ¨ Spring å®¹å™¨ä¸­ç»„åˆåœ¨ä¸€èµ·æ—¶ï¼Œå®ƒè¢«ç§°ä¸ºè£…é…æˆ– bean è£…é…ã€‚ Spring å®¹å™¨éœ€è¦çŸ¥é“éœ€è¦ä»€ä¹ˆ bean ä»¥åŠå®¹å™¨åº”è¯¥å¦‚ä½•ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¥å°† bean ç»‘å®šåœ¨ä¸€èµ·ï¼ŒåŒæ—¶è£…é… beanã€‚</p>
<h4 id="è‡ªåŠ¨è£…é…æœ‰å“ªäº›æ–¹å¼ï¼Ÿ"><a href="#è‡ªåŠ¨è£…é…æœ‰å“ªäº›æ–¹å¼ï¼Ÿ" class="headerlink" title="è‡ªåŠ¨è£…é…æœ‰å“ªäº›æ–¹å¼ï¼Ÿ"></a>è‡ªåŠ¨è£…é…æœ‰å“ªäº›æ–¹å¼ï¼Ÿ</h4><p>Spring å®¹å™¨èƒ½å¤Ÿè‡ªåŠ¨è£…é… beanã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥ BeanFactory çš„å†…å®¹è®© Spring è‡ªåŠ¨è§£æ bean çš„åä½œè€…ã€‚</p>
<p>è‡ªåŠ¨è£…é…çš„ä¸åŒæ¨¡å¼ï¼š</p>
<ul>
<li><strong>no</strong> - è¿™æ˜¯é»˜è®¤è®¾ç½®ï¼Œè¡¨ç¤ºæ²¡æœ‰è‡ªåŠ¨è£…é…ã€‚åº”ä½¿ç”¨æ˜¾å¼ bean å¼•ç”¨è¿›è¡Œè£…é…ã€‚</li>
<li><strong>byName</strong> - å®ƒæ ¹æ® bean çš„åç§°æ³¨å…¥å¯¹è±¡ä¾èµ–é¡¹ã€‚å®ƒåŒ¹é…å¹¶è£…é…å…¶å±æ€§ä¸ XML æ–‡ä»¶ä¸­ç”±ç›¸åŒåç§°å®šä¹‰çš„ beanã€‚</li>
<li><strong>byType</strong> - å®ƒæ ¹æ®ç±»å‹æ³¨å…¥å¯¹è±¡ä¾èµ–é¡¹ã€‚å¦‚æœå±æ€§çš„ç±»å‹ä¸ XML æ–‡ä»¶ä¸­çš„ä¸€ä¸ª bean åç§°åŒ¹é…ï¼Œåˆ™åŒ¹é…å¹¶è£…é…å±æ€§ã€‚</li>
<li><strong>æ„é€ å™¨</strong> - å®ƒé€šè¿‡è°ƒç”¨ç±»çš„æ„é€ å™¨æ¥æ³¨å…¥ä¾èµ–é¡¹ã€‚å®ƒæœ‰å¤§é‡çš„å‚æ•°ã€‚</li>
<li><strong>autodetect</strong> - é¦–å…ˆå®¹å™¨å°è¯•é€šè¿‡æ„é€ å™¨ä½¿ç”¨ autowire è£…é…ï¼Œå¦‚æœä¸èƒ½ï¼Œåˆ™å°è¯•é€šè¿‡ byType è‡ªåŠ¨è£…é…ã€‚</li>
</ul>
<h4 id="è‡ªåŠ¨è£…é…æœ‰ä»€ä¹ˆå±€é™ï¼Ÿ"><a href="#è‡ªåŠ¨è£…é…æœ‰ä»€ä¹ˆå±€é™ï¼Ÿ" class="headerlink" title="è‡ªåŠ¨è£…é…æœ‰ä»€ä¹ˆå±€é™ï¼Ÿ"></a>è‡ªåŠ¨è£…é…æœ‰ä»€ä¹ˆå±€é™ï¼Ÿ</h4><ul>
<li>è¦†ç›–çš„å¯èƒ½æ€§ - æ‚¨å§‹ç»ˆå¯ä»¥ä½¿ç”¨ <code>&lt;constructor-arg&gt;</code> å’Œ <code>&lt;property&gt;</code> è®¾ç½®æŒ‡å®šä¾èµ–é¡¹ï¼Œè¿™å°†è¦†ç›–è‡ªåŠ¨è£…é…ã€‚</li>
<li>åŸºæœ¬å…ƒæ•°æ®ç±»å‹ - ç®€å•å±æ€§ï¼ˆå¦‚åŸæ•°æ®ç±»å‹ï¼Œå­—ç¬¦ä¸²å’Œç±»ï¼‰æ— æ³•è‡ªåŠ¨è£…é…ã€‚</li>
<li>ä»¤äººå›°æƒ‘çš„æ€§è´¨ - æ€»æ˜¯å–œæ¬¢ä½¿ç”¨æ˜ç¡®çš„è£…é…ï¼Œå› ä¸ºè‡ªåŠ¨è£…é…ä¸å¤ªç²¾ç¡®ã€‚</li>
</ul>
<h3 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h3><h4 id="ä»€ä¹ˆæ˜¯-AOPï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-AOPï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ AOPï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ AOPï¼Ÿ</h4><p>AOP(Aspect-Oriented Programming), å³ <strong>é¢å‘åˆ‡é¢ç¼–ç¨‹</strong>, å®ƒä¸ OOP( Object-Oriented Programming, é¢å‘å¯¹è±¡ç¼–ç¨‹) ç›¸è¾…ç›¸æˆ, æä¾›äº†ä¸ OOP ä¸åŒçš„æŠ½è±¡è½¯ä»¶ç»“æ„çš„è§†è§’.<br>åœ¨ OOP ä¸­, æˆ‘ä»¬ä»¥ç±»(class)ä½œä¸ºæˆ‘ä»¬çš„åŸºæœ¬å•å…ƒ, è€Œ AOP ä¸­çš„åŸºæœ¬å•å…ƒæ˜¯ <strong>Aspect(åˆ‡é¢)</strong></p>
<h4 id="AOP-ä¸­çš„-Aspectã€Adviceã€Pointcutã€JointPoint-å’Œ-Advice-å‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#AOP-ä¸­çš„-Aspectã€Adviceã€Pointcutã€JointPoint-å’Œ-Advice-å‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="AOP ä¸­çš„ Aspectã€Adviceã€Pointcutã€JointPoint å’Œ Advice å‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>AOP ä¸­çš„ Aspectã€Adviceã€Pointcutã€JointPoint å’Œ Advice å‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/spring/core/spring-aop.png" alt="img"></p>
<ul>
<li><strong>Aspect</strong> - Aspect æ˜¯ä¸€ä¸ªå®ç°äº¤å‰é—®é¢˜çš„ç±»ï¼Œä¾‹å¦‚äº‹åŠ¡ç®¡ç†ã€‚æ–¹é¢å¯ä»¥æ˜¯é…ç½®çš„æ™®é€šç±»ï¼Œç„¶ååœ¨ Spring Bean é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Spring AspectJ æ”¯æŒä½¿ç”¨ @Aspect æ³¨è§£å°†ç±»å£°æ˜ä¸º Aspectã€‚</li>
<li><strong>Advice</strong> - Advice æ˜¯é’ˆå¯¹ç‰¹å®š JoinPoint é‡‡å–çš„æ“ä½œã€‚åœ¨ç¼–ç¨‹æ–¹é¢ï¼Œå®ƒä»¬æ˜¯åœ¨åº”ç”¨ç¨‹åºä¸­è¾¾åˆ°å…·æœ‰åŒ¹é…åˆ‡å…¥ç‚¹çš„ç‰¹å®š JoinPoint æ—¶æ‰§è¡Œçš„æ–¹æ³•ã€‚æ‚¨å¯ä»¥å°† Advice è§†ä¸º Spring æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ– Servlet è¿‡æ»¤å™¨ï¼ˆfilterï¼‰ã€‚</li>
<li><strong>Advice Arguments</strong> - æˆ‘ä»¬å¯ä»¥åœ¨ advice æ–¹æ³•ä¸­ä¼ é€’å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨åˆ‡å…¥ç‚¹ä¸­ä½¿ç”¨ args() è¡¨è¾¾å¼æ¥åº”ç”¨äºä¸å‚æ•°æ¨¡å¼åŒ¹é…çš„ä»»ä½•æ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨å®ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ç¡®å®šå‚æ•°ç±»å‹çš„ advice æ–¹æ³•ä¸­ä½¿ç”¨ç›¸åŒçš„åç§°ã€‚</li>
<li><strong>Pointcut</strong> - Pointcut æ˜¯ä¸ JoinPoint åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºç¡®å®šæ˜¯å¦éœ€è¦æ‰§è¡Œ Adviceã€‚ Pointcut ä½¿ç”¨ä¸ JoinPoint åŒ¹é…çš„ä¸åŒç±»å‹çš„è¡¨è¾¾å¼ã€‚Spring æ¡†æ¶ä½¿ç”¨ AspectJ Pointcut è¡¨è¾¾å¼è¯­è¨€æ¥ç¡®å®šå°†åº”ç”¨é€šçŸ¥æ–¹æ³•çš„ JoinPointã€‚</li>
<li><strong>JoinPoint</strong> - JoinPoint æ˜¯åº”ç”¨ç¨‹åºä¸­çš„ç‰¹å®šç‚¹ï¼Œä¾‹å¦‚æ–¹æ³•æ‰§è¡Œï¼Œå¼‚å¸¸å¤„ç†ï¼Œæ›´æ”¹å¯¹è±¡å˜é‡å€¼ç­‰ã€‚åœ¨ Spring AOP ä¸­ï¼ŒJoinPoint å§‹ç»ˆæ˜¯æ–¹æ³•çš„æ‰§è¡Œå™¨ã€‚</li>
</ul>
<h4 id="ä»€ä¹ˆæ˜¯é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ</h4><p>ç‰¹å®š JoinPoint å¤„çš„ Aspect æ‰€é‡‡å–çš„åŠ¨ä½œç§°ä¸º Adviceã€‚Spring AOP ä½¿ç”¨ä¸€ä¸ª Advice ä½œä¸ºæ‹¦æˆªå™¨ï¼Œåœ¨ JoinPoint â€œå‘¨å›´â€ç»´æŠ¤ä¸€ç³»åˆ—çš„æ‹¦æˆªå™¨ã€‚</p>
<h4 id="æœ‰å“ªäº›ç±»å‹çš„é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ"><a href="#æœ‰å“ªäº›ç±»å‹çš„é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ" class="headerlink" title="æœ‰å“ªäº›ç±»å‹çš„é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ"></a>æœ‰å“ªäº›ç±»å‹çš„é€šçŸ¥ï¼ˆAdviceï¼‰ï¼Ÿ</h4><ul>
<li><strong>Before</strong> - è¿™äº›ç±»å‹çš„ Advice åœ¨ joinpoint æ–¹æ³•ä¹‹å‰æ‰§è¡Œï¼Œå¹¶ä½¿ç”¨ @Before æ³¨è§£æ ‡è®°è¿›è¡Œé…ç½®ã€‚</li>
<li><strong>After Returning</strong> - è¿™äº›ç±»å‹çš„ Advice åœ¨è¿æ¥ç‚¹æ–¹æ³•æ­£å¸¸æ‰§è¡Œåæ‰§è¡Œï¼Œå¹¶ä½¿ç”¨@AfterReturning æ³¨è§£æ ‡è®°è¿›è¡Œé…ç½®ã€‚</li>
<li><strong>After Throwing</strong> - è¿™äº›ç±»å‹çš„ Advice ä»…åœ¨ joinpoint æ–¹æ³•é€šè¿‡æŠ›å‡ºå¼‚å¸¸é€€å‡ºå¹¶ä½¿ç”¨ @AfterThrowing æ³¨è§£æ ‡è®°é…ç½®æ—¶æ‰§è¡Œã€‚</li>
<li><strong>After (finally)</strong> - è¿™äº›ç±»å‹çš„ Advice åœ¨è¿æ¥ç‚¹æ–¹æ³•ä¹‹åæ‰§è¡Œï¼Œæ— è®ºæ–¹æ³•é€€å‡ºæ˜¯æ­£å¸¸è¿˜æ˜¯å¼‚å¸¸è¿”å›ï¼Œå¹¶ä½¿ç”¨ @After æ³¨è§£æ ‡è®°è¿›è¡Œé…ç½®ã€‚</li>
<li><strong>Around</strong> - è¿™äº›ç±»å‹çš„ Advice åœ¨è¿æ¥ç‚¹ä¹‹å‰å’Œä¹‹åæ‰§è¡Œï¼Œå¹¶ä½¿ç”¨ @Around æ³¨è§£æ ‡è®°è¿›è¡Œé…ç½®ã€‚</li>
</ul>
<h4 id="æŒ‡å‡ºåœ¨-spring-aop-ä¸­-concern-å’Œ-cross-cutting-concern-çš„ä¸åŒä¹‹å¤„ã€‚"><a href="#æŒ‡å‡ºåœ¨-spring-aop-ä¸­-concern-å’Œ-cross-cutting-concern-çš„ä¸åŒä¹‹å¤„ã€‚" class="headerlink" title="æŒ‡å‡ºåœ¨ spring aop ä¸­ concern å’Œ cross-cutting concern çš„ä¸åŒä¹‹å¤„ã€‚"></a>æŒ‡å‡ºåœ¨ spring aop ä¸­ concern å’Œ cross-cutting concern çš„ä¸åŒä¹‹å¤„ã€‚</h4><p>concern æ˜¯æˆ‘ä»¬æƒ³è¦åœ¨åº”ç”¨ç¨‹åºçš„ç‰¹å®šæ¨¡å—ä¸­å®šä¹‰çš„è¡Œä¸ºã€‚å®ƒå¯ä»¥å®šä¹‰ä¸ºæˆ‘ä»¬æƒ³è¦å®ç°çš„åŠŸèƒ½ã€‚</p>
<p>cross-cutting concern æ˜¯ä¸€ä¸ªé€‚ç”¨äºæ•´ä¸ªåº”ç”¨çš„è¡Œä¸ºï¼Œè¿™ä¼šå½±å“æ•´ä¸ªåº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œæ—¥å¿—è®°å½•ï¼Œå®‰å…¨æ€§å’Œæ•°æ®ä¼ è¾“æ˜¯åº”ç”¨ç¨‹åºå‡ ä¹æ¯ä¸ªæ¨¡å—éƒ½éœ€è¦å…³æ³¨çš„é—®é¢˜ï¼Œå› æ­¤å®ƒä»¬æ˜¯è·¨é¢†åŸŸçš„é—®é¢˜ã€‚</p>
<h4 id="AOP-æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ"><a href="#AOP-æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ" class="headerlink" title="AOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ"></a>AOP æœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h4><p>å®ç° AOP çš„æŠ€æœ¯ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<ul>
<li>é™æ€ä»£ç† - æŒ‡ä½¿ç”¨ AOP æ¡†æ¶æä¾›çš„å‘½ä»¤è¿›è¡Œç¼–è¯‘ï¼Œä»è€Œåœ¨ç¼–è¯‘é˜¶æ®µå°±å¯ç”Ÿæˆ AOP ä»£ç†ç±»ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºç¼–è¯‘æ—¶å¢å¼ºï¼›<ul>
<li>ç¼–è¯‘æ—¶ç¼–ç»‡ï¼ˆç‰¹æ®Šç¼–è¯‘å™¨å®ç°ï¼‰</li>
<li>ç±»åŠ è½½æ—¶ç¼–ç»‡ï¼ˆç‰¹æ®Šçš„ç±»åŠ è½½å™¨å®ç°ï¼‰ã€‚</li>
</ul>
</li>
<li>åŠ¨æ€ä»£ç† - åœ¨è¿è¡Œæ—¶åœ¨å†…å­˜ä¸­â€œä¸´æ—¶â€ç”Ÿæˆ AOP åŠ¨æ€ä»£ç†ç±»ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºè¿è¡Œæ—¶å¢å¼ºã€‚<ul>
<li>JDK åŠ¨æ€ä»£ç†</li>
<li>CGLIB</li>
</ul>
</li>
</ul>
<h4 id="Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>Spring AOP åŸºäºåŠ¨æ€ä»£ç†æ–¹å¼å®ç°ï¼›AspectJ åŸºäºé™æ€ä»£ç†æ–¹å¼å®ç°ã€‚<br>Spring AOP ä»…æ”¯æŒæ–¹æ³•çº§åˆ«çš„ PointCutï¼›æä¾›äº†å®Œå…¨çš„ AOP æ”¯æŒï¼Œå®ƒè¿˜æ”¯æŒå±æ€§çº§åˆ«çš„ PointCutã€‚</p>
<h4 id="å¦‚ä½•ç†è§£-Spring-ä¸­çš„ä»£ç†ï¼Ÿ"><a href="#å¦‚ä½•ç†è§£-Spring-ä¸­çš„ä»£ç†ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç†è§£ Spring ä¸­çš„ä»£ç†ï¼Ÿ"></a>å¦‚ä½•ç†è§£ Spring ä¸­çš„ä»£ç†ï¼Ÿ</h4><p>å°† Advice åº”ç”¨äºç›®æ ‡å¯¹è±¡ååˆ›å»ºçš„å¯¹è±¡ç§°ä¸ºä»£ç†ã€‚åœ¨å®¢æˆ·ç«¯å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œç›®æ ‡å¯¹è±¡å’Œä»£ç†å¯¹è±¡æ˜¯ç›¸åŒçš„ã€‚</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Advice + Target <span class="built_in">Object</span> = <span class="built_in">Proxy</span></span><br></pre></td></tr></table></figure>

<h4 id="ä»€ä¹ˆæ˜¯ç¼–ç»‡ï¼ˆWeavingï¼‰ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç¼–ç»‡ï¼ˆWeavingï¼‰ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç¼–ç»‡ï¼ˆWeavingï¼‰ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç¼–ç»‡ï¼ˆWeavingï¼‰ï¼Ÿ</h4><p>ä¸ºäº†åˆ›å»ºä¸€ä¸ª advice å¯¹è±¡è€Œé“¾æ¥ä¸€ä¸ª aspect å’Œå…¶å®ƒåº”ç”¨ç±»å‹æˆ–å¯¹è±¡ï¼Œç§°ä¸ºç¼–ç»‡ï¼ˆWeavingï¼‰ã€‚åœ¨ Spring AOP ä¸­ï¼Œç¼–ç»‡åœ¨è¿è¡Œæ—¶æ‰§è¡Œã€‚è¯·å‚è€ƒä¸‹å›¾ï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/3101171-cfaa92f0e4115b4a.png" alt="img"></p>
<h2 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h2><h3 id="ä½ ç”¨è¿‡å“ªäº›é‡è¦çš„-Spring-æ³¨è§£ï¼Ÿ"><a href="#ä½ ç”¨è¿‡å“ªäº›é‡è¦çš„-Spring-æ³¨è§£ï¼Ÿ" class="headerlink" title="ä½ ç”¨è¿‡å“ªäº›é‡è¦çš„ Spring æ³¨è§£ï¼Ÿ"></a>ä½ ç”¨è¿‡å“ªäº›é‡è¦çš„ Spring æ³¨è§£ï¼Ÿ</h3><ul>
<li><strong>@Controller</strong> - ç”¨äº Spring MVC é¡¹ç›®ä¸­çš„æ§åˆ¶å™¨ç±»ã€‚</li>
<li><strong>@Service</strong> - ç”¨äºæœåŠ¡ç±»ã€‚</li>
<li><strong>@RequestMapping</strong> - ç”¨äºåœ¨æ§åˆ¶å™¨å¤„ç†ç¨‹åºæ–¹æ³•ä¸­é…ç½® URI æ˜ å°„ã€‚</li>
<li><strong>@ResponseBody</strong> - ç”¨äºå‘é€ Object ä½œä¸ºå“åº”ï¼Œé€šå¸¸ç”¨äºå‘é€ XML æˆ– JSON æ•°æ®ä½œä¸ºå“åº”ã€‚</li>
<li><strong>@PathVariable</strong> - ç”¨äºå°†åŠ¨æ€å€¼ä» URI æ˜ å°„åˆ°å¤„ç†ç¨‹åºæ–¹æ³•å‚æ•°ã€‚</li>
<li><strong>@Autowired</strong> - ç”¨äºåœ¨ spring bean ä¸­è‡ªåŠ¨è£…é…ä¾èµ–é¡¹ã€‚</li>
<li><strong>@Qualifier</strong> - ä½¿ç”¨ @Autowired æ³¨è§£ï¼Œä»¥é¿å…åœ¨å­˜åœ¨å¤šä¸ª bean ç±»å‹å®ä¾‹æ—¶å‡ºç°æ··æ·†ã€‚</li>
<li><strong>@Scope</strong> - ç”¨äºé…ç½® spring bean çš„èŒƒå›´ã€‚</li>
<li><strong>@Configuration</strong>ï¼Œ**@ComponentScan** å’Œ <strong>@Bean</strong> - ç”¨äºåŸºäº java çš„é…ç½®ã€‚</li>
<li><strong>@Aspect</strong>ï¼Œ**@Before<strong>ï¼Œ</strong>@After<strong>ï¼Œ</strong>@Around<strong>ï¼Œ</strong>@Pointcut** - ç”¨äºåˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰ã€‚</li>
</ul>
<h3 id="å¦‚ä½•åœ¨-spring-ä¸­å¯åŠ¨æ³¨è§£è£…é…ï¼Ÿ"><a href="#å¦‚ä½•åœ¨-spring-ä¸­å¯åŠ¨æ³¨è§£è£…é…ï¼Ÿ" class="headerlink" title="å¦‚ä½•åœ¨ spring ä¸­å¯åŠ¨æ³¨è§£è£…é…ï¼Ÿ"></a>å¦‚ä½•åœ¨ spring ä¸­å¯åŠ¨æ³¨è§£è£…é…ï¼Ÿ</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring å®¹å™¨ä¸­æœªæ‰“å¼€æ³¨è§£è£…é…ã€‚å› æ­¤ï¼Œè¦ä½¿ç”¨åŸºäºæ³¨è§£è£…é…ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡é…ç½®<code>&lt;contextï¼šannotation-config /&gt;</code> å…ƒç´ åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å¯ç”¨å®ƒã€‚</p>
<h3 id="Component-Controller-Repository-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ"><a href="#Component-Controller-Repository-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ" class="headerlink" title="@Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ"></a>@Component, @Controller, @Repository, @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ</h3><ul>
<li>@Componentï¼šè¿™å°† java ç±»æ ‡è®°ä¸º beanã€‚å®ƒæ˜¯ä»»ä½• Spring ç®¡ç†ç»„ä»¶çš„é€šç”¨æ„é€ å‹ã€‚spring çš„ç»„ä»¶æ‰«ææœºåˆ¶ç°åœ¨å¯ä»¥å°†å…¶æ‹¾å–å¹¶å°†å…¶æ‹‰å…¥åº”ç”¨ç¨‹åºç¯å¢ƒä¸­ã€‚</li>
<li>@Controllerï¼šè¿™å°†ä¸€ä¸ªç±»æ ‡è®°ä¸º Spring Web MVC æ§åˆ¶å™¨ã€‚æ ‡æœ‰å®ƒçš„ Bean ä¼šè‡ªåŠ¨å¯¼å…¥åˆ° IoC å®¹å™¨ä¸­ã€‚</li>
<li>@Serviceï¼šæ­¤æ³¨è§£æ˜¯ç»„ä»¶æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸ä¼šå¯¹ @Component æ³¨è§£æä¾›ä»»ä½•å…¶ä»–è¡Œä¸ºã€‚æ‚¨å¯ä»¥åœ¨æœåŠ¡å±‚ç±»ä¸­ä½¿ç”¨ @Service è€Œä¸æ˜¯ @Componentï¼Œå› ä¸ºå®ƒä»¥æ›´å¥½çš„æ–¹å¼æŒ‡å®šäº†æ„å›¾ã€‚</li>
<li>@Repositoryï¼šè¿™ä¸ªæ³¨è§£æ˜¯å…·æœ‰ç±»ä¼¼ç”¨é€”å’ŒåŠŸèƒ½çš„ @Component æ³¨è§£çš„ç‰¹åŒ–ã€‚å®ƒä¸º DAO æä¾›äº†é¢å¤–çš„å¥½å¤„ã€‚å®ƒå°† DAO å¯¼å…¥ IoC å®¹å™¨ï¼Œå¹¶ä½¿æœªç»æ£€æŸ¥çš„å¼‚å¸¸æœ‰èµ„æ ¼è½¬æ¢ä¸º Spring DataAccessExceptionã€‚</li>
</ul>
<h3 id="Required-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#Required-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="@Required æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>@Required æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>@Required åº”ç”¨äº bean å±æ€§ setter æ–¹æ³•ã€‚æ­¤æ³¨è§£ä»…æŒ‡ç¤ºå¿…é¡»åœ¨é…ç½®æ—¶ä½¿ç”¨ bean å®šä¹‰ä¸­çš„æ˜¾å¼å±æ€§å€¼æˆ–ä½¿ç”¨è‡ªåŠ¨è£…é…å¡«å……å—å½±å“çš„ bean å±æ€§ã€‚å¦‚æœå°šæœªå¡«å……å—å½±å“çš„ bean å±æ€§ï¼Œåˆ™å®¹å™¨å°†æŠ›å‡º BeanInitializationExceptionã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Required</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> string <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Autowired-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#Autowired-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="@Autowired æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>@Autowired æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>@Autowired å¯ä»¥æ›´å‡†ç¡®åœ°æ§åˆ¶åº”è¯¥åœ¨ä½•å¤„ä»¥åŠå¦‚ä½•è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚æ­¤æ³¨è§£ç”¨äºåœ¨ setter æ–¹æ³•ï¼Œæ„é€ å™¨ï¼Œå…·æœ‰ä»»æ„åç§°æˆ–å¤šä¸ªå‚æ•°çš„å±æ€§æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨è£…é… beanã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ç±»å‹é©±åŠ¨çš„æ³¨å…¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> string <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>å½“æ‚¨åˆ›å»ºå¤šä¸ªç›¸åŒç±»å‹çš„ bean å¹¶å¸Œæœ›ä»…ä½¿ç”¨å±æ€§è£…é…å…¶ä¸­ä¸€ä¸ª bean æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨@Qualifier æ³¨è§£å’Œ @Autowired é€šè¿‡æŒ‡å®šåº”è¯¥è£…é…å“ªä¸ªç¡®åˆ‡çš„ bean æ¥æ¶ˆé™¤æ­§ä¹‰ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ†åˆ«æœ‰ä¸¤ä¸ªç±»ï¼ŒEmployee å’Œ EmpAccountã€‚åœ¨ EmpAccount ä¸­ï¼Œä½¿ç”¨@Qualifier æŒ‡å®šäº†å¿…é¡»è£…é… id ä¸º emp1 çš„ beanã€‚</p>
<p>Employee.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> string <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>EmpAccount.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpAccount</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Employee emp;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(emp1)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showName</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(â€œEmployee name : â€+emp.getName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="@RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>@RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>@RequestMapping æ³¨è§£ç”¨äºå°†ç‰¹å®š HTTP è¯·æ±‚æ–¹æ³•æ˜ å°„åˆ°å°†å¤„ç†ç›¸åº”è¯·æ±‚çš„æ§åˆ¶å™¨ä¸­çš„ç‰¹å®šç±»&#x2F;æ–¹æ³•ã€‚æ­¤æ³¨è§£å¯åº”ç”¨äºä¸¤ä¸ªçº§åˆ«ï¼š</p>
<ul>
<li>ç±»çº§åˆ«ï¼šæ˜ å°„è¯·æ±‚çš„ URL</li>
<li>æ–¹æ³•çº§åˆ«ï¼šæ˜ å°„ URL ä»¥åŠ HTTP è¯·æ±‚æ–¹æ³•</li>
</ul>
<h2 id="æ•°æ®ç¯‡"><a href="#æ•°æ®ç¯‡" class="headerlink" title="æ•°æ®ç¯‡"></a>æ•°æ®ç¯‡</h2><h3 id="spring-DAO-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#spring-DAO-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="spring DAO æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>spring DAO æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>Spring DAO ä½¿å¾— JDBCï¼ŒHibernate æˆ– JDO è¿™æ ·çš„æ•°æ®è®¿é—®æŠ€æœ¯æ›´å®¹æ˜“ä»¥ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼å·¥ä½œã€‚è¿™ä½¿å¾—ç”¨æˆ·å®¹æ˜“åœ¨æŒä¹…æ€§æŠ€æœ¯ä¹‹é—´åˆ‡æ¢ã€‚å®ƒè¿˜å…è®¸æ‚¨åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œæ— éœ€è€ƒè™‘æ•è·æ¯ç§æŠ€æœ¯ä¸åŒçš„å¼‚å¸¸ã€‚</p>
<h3 id="åˆ—ä¸¾-Spring-DAO-æŠ›å‡ºçš„å¼‚å¸¸ã€‚"><a href="#åˆ—ä¸¾-Spring-DAO-æŠ›å‡ºçš„å¼‚å¸¸ã€‚" class="headerlink" title="åˆ—ä¸¾ Spring DAO æŠ›å‡ºçš„å¼‚å¸¸ã€‚"></a>åˆ—ä¸¾ Spring DAO æŠ›å‡ºçš„å¼‚å¸¸ã€‚</h3><p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/spring/data-access/spring-data-access-exception.png" alt="img"></p>
<h3 id="spring-JDBC-API-ä¸­å­˜åœ¨å“ªäº›ç±»ï¼Ÿ"><a href="#spring-JDBC-API-ä¸­å­˜åœ¨å“ªäº›ç±»ï¼Ÿ" class="headerlink" title="spring JDBC API ä¸­å­˜åœ¨å“ªäº›ç±»ï¼Ÿ"></a>spring JDBC API ä¸­å­˜åœ¨å“ªäº›ç±»ï¼Ÿ</h3><ul>
<li>JdbcTemplate</li>
<li>SimpleJdbcTemplate</li>
<li>NamedParameterJdbcTemplate</li>
<li>SimpleJdbcInsert</li>
<li>SimpleJdbcCall</li>
</ul>
<h3 id="ä½¿ç”¨-Spring-è®¿é—®-Hibernate-çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"><a href="#ä½¿ç”¨-Spring-è®¿é—®-Hibernate-çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="ä½¿ç”¨ Spring è®¿é—® Hibernate çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"></a>ä½¿ç”¨ Spring è®¿é—® Hibernate çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ä½¿ç”¨ Spring è®¿é—® Hibernateï¼š</p>
<ol>
<li>ä½¿ç”¨ Hibernate æ¨¡æ¿å’Œå›è°ƒè¿›è¡Œæ§åˆ¶åè½¬</li>
<li>æ‰©å±• HibernateDAOSupport å¹¶åº”ç”¨ AOP æ‹¦æˆªå™¨èŠ‚ç‚¹</li>
</ol>
<h3 id="åˆ—ä¸¾-spring-æ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹"><a href="#åˆ—ä¸¾-spring-æ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹" class="headerlink" title="åˆ—ä¸¾ spring æ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹"></a>åˆ—ä¸¾ spring æ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹</h3><p>Spring æ”¯æŒä¸¤ç§ç±»å‹çš„äº‹åŠ¡ç®¡ç†ï¼š</p>
<ol>
<li>ç¨‹åºåŒ–äº‹åŠ¡ç®¡ç†ï¼šåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œåœ¨ç¼–ç¨‹çš„å¸®åŠ©ä¸‹ç®¡ç†äº‹åŠ¡ã€‚å®ƒä¸ºæ‚¨æä¾›æå¤§çš„çµæ´»æ€§ï¼Œä½†ç»´æŠ¤èµ·æ¥éå¸¸å›°éš¾ã€‚</li>
<li>å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼šåœ¨æ­¤ï¼Œäº‹åŠ¡ç®¡ç†ä¸ä¸šåŠ¡ä»£ç åˆ†ç¦»ã€‚ä»…ä½¿ç”¨æ³¨è§£æˆ–åŸºäº XML çš„é…ç½®æ¥ç®¡ç†äº‹åŠ¡ã€‚</li>
</ol>
<h3 id="spring-æ”¯æŒå“ªäº›-ORM-æ¡†æ¶"><a href="#spring-æ”¯æŒå“ªäº›-ORM-æ¡†æ¶" class="headerlink" title="spring æ”¯æŒå“ªäº› ORM æ¡†æ¶"></a>spring æ”¯æŒå“ªäº› ORM æ¡†æ¶</h3><ul>
<li>Hibernate</li>
<li>iBatis</li>
<li>JPA</li>
<li>JDO</li>
<li>OJB</li>
</ul>
<h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><h3 id="Spring-MVC-æ¡†æ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#Spring-MVC-æ¡†æ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="Spring MVC æ¡†æ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>Spring MVC æ¡†æ¶æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>Spring Web MVC æ¡†æ¶æä¾› <strong>æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨</strong> æ¶æ„å’Œéšæ—¶å¯ç”¨çš„ç»„ä»¶ï¼Œç”¨äºå¼€å‘çµæ´»ä¸”æ¾æ•£è€¦åˆçš„ Web åº”ç”¨ç¨‹åºã€‚ MVC æ¨¡å¼æœ‰åŠ©äºåˆ†ç¦»åº”ç”¨ç¨‹åºçš„ä¸åŒæ–¹é¢ï¼Œå¦‚è¾“å…¥é€»è¾‘ï¼Œä¸šåŠ¡é€»è¾‘å’Œ UI é€»è¾‘ï¼ŒåŒæ—¶åœ¨æ‰€æœ‰è¿™äº›å…ƒç´ ä¹‹é—´æä¾›æ¾æ•£è€¦åˆã€‚</p>
<h3 id="æè¿°ä¸€ä¸‹-DispatcherServlet-çš„å·¥ä½œæµç¨‹"><a href="#æè¿°ä¸€ä¸‹-DispatcherServlet-çš„å·¥ä½œæµç¨‹" class="headerlink" title="æè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹"></a>æè¿°ä¸€ä¸‹ DispatcherServlet çš„å·¥ä½œæµç¨‹</h3><p>DispatcherServlet çš„å·¥ä½œæµç¨‹å¯ä»¥ç”¨ä¸€å¹…å›¾æ¥è¯´æ˜ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/spring/web/spring-dispatcher-servlet.png" alt="img"></p>
<ol>
<li>å‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è¢«å‰ç«¯æ§åˆ¶å™¨ <code>DispatcherServlet</code> æ•è·ã€‚</li>
<li><code>DispatcherServlet</code> æ ¹æ® <strong><servlet-name>-servlet.xml</strong> ä¸­çš„é…ç½®å¯¹è¯·æ±‚çš„ URL è¿›è¡Œè§£æï¼Œå¾—åˆ°è¯·æ±‚èµ„æºæ ‡è¯†ç¬¦ï¼ˆURIï¼‰ã€‚ç„¶åæ ¹æ®è¯¥ URIï¼Œè°ƒç”¨ <code>HandlerMapping</code> è·å¾—è¯¥ Handler é…ç½®çš„æ‰€æœ‰ç›¸å…³çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ Handler å¯¹è±¡ä»¥åŠ Handler å¯¹è±¡å¯¹åº”çš„æ‹¦æˆªå™¨ï¼‰ï¼Œæœ€åä»¥<code>HandlerExecutionChain</code> å¯¹è±¡çš„å½¢å¼è¿”å›ã€‚</li>
<li><code>DispatcherServlet</code> æ ¹æ®è·å¾—çš„<code>Handler</code>ï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ <code>HandlerAdapter</code>ã€‚ï¼ˆé™„æ³¨ï¼šå¦‚æœæˆåŠŸè·å¾—<code>HandlerAdapter</code>åï¼Œæ­¤æ—¶å°†å¼€å§‹æ‰§è¡Œæ‹¦æˆªå™¨çš„ preHandler(â€¦)æ–¹æ³•ï¼‰ã€‚</li>
<li>æå–<code>Request</code>ä¸­çš„æ¨¡å‹æ•°æ®ï¼Œå¡«å……<code>Handler</code>å…¥å‚ï¼Œå¼€å§‹æ‰§è¡Œ<code>Handler</code>ï¼ˆ<code>Controller</code>)ã€‚ åœ¨å¡«å……<code>Handler</code>çš„å…¥å‚è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®ä½ çš„é…ç½®ï¼ŒSpring å°†å¸®ä½ åšä¸€äº›é¢å¤–çš„å·¥ä½œï¼š<ul>
<li>HttpMessageConveterï¼š å°†è¯·æ±‚æ¶ˆæ¯ï¼ˆå¦‚ Jsonã€xml ç­‰æ•°æ®ï¼‰è½¬æ¢æˆä¸€ä¸ªå¯¹è±¡ï¼Œå°†å¯¹è±¡è½¬æ¢ä¸ºæŒ‡å®šçš„å“åº”ä¿¡æ¯ã€‚</li>
<li>æ•°æ®è½¬æ¢ï¼šå¯¹è¯·æ±‚æ¶ˆæ¯è¿›è¡Œæ•°æ®è½¬æ¢ã€‚å¦‚<code>String</code>è½¬æ¢æˆ<code>Integer</code>ã€<code>Double</code>ç­‰ã€‚</li>
<li>æ•°æ®æ ¹å¼åŒ–ï¼šå¯¹è¯·æ±‚æ¶ˆæ¯è¿›è¡Œæ•°æ®æ ¼å¼åŒ–ã€‚ å¦‚å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ ¼å¼åŒ–æ•°å­—æˆ–æ ¼å¼åŒ–æ—¥æœŸç­‰ã€‚</li>
<li>æ•°æ®éªŒè¯ï¼š éªŒè¯æ•°æ®çš„æœ‰æ•ˆæ€§ï¼ˆé•¿åº¦ã€æ ¼å¼ç­‰ï¼‰ï¼ŒéªŒè¯ç»“æœå­˜å‚¨åˆ°<code>BindingResult</code>æˆ–<code>Error</code>ä¸­ã€‚</li>
</ul>
</li>
<li>Handler(Controller)æ‰§è¡Œå®Œæˆåï¼Œå‘ <code>DispatcherServlet</code> è¿”å›ä¸€ä¸ª <code>ModelAndView</code> å¯¹è±¡ï¼›</li>
<li>æ ¹æ®è¿”å›çš„<code>ModelAndView</code>ï¼Œé€‰æ‹©ä¸€ä¸ªé€‚åˆçš„ <code>ViewResolver</code>ï¼ˆå¿…é¡»æ˜¯å·²ç»æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­çš„<code>ViewResolver</code>)è¿”å›ç»™<code>DispatcherServlet</code>ã€‚</li>
<li><code>ViewResolver</code> ç»“åˆ<code>Model</code>å’Œ<code>View</code>ï¼Œæ¥æ¸²æŸ“è§†å›¾ã€‚</li>
<li>è§†å›¾è´Ÿè´£å°†æ¸²æŸ“ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
</ol>
<h3 id="ä»‹ç»ä¸€ä¸‹-WebApplicationContext"><a href="#ä»‹ç»ä¸€ä¸‹-WebApplicationContext" class="headerlink" title="ä»‹ç»ä¸€ä¸‹ WebApplicationContext"></a>ä»‹ç»ä¸€ä¸‹ WebApplicationContext</h3><p>WebApplicationContext æ˜¯ ApplicationContext çš„æ‰©å±•ã€‚å®ƒå…·æœ‰ Web åº”ç”¨ç¨‹åºæ‰€éœ€çš„ä¸€äº›é¢å¤–åŠŸèƒ½ã€‚å®ƒä¸æ™®é€šçš„ ApplicationContext åœ¨è§£æä¸»é¢˜å’Œå†³å®šä¸å“ªä¸ª servlet å…³è”çš„èƒ½åŠ›æ–¹é¢æœ‰æ‰€ä¸åŒã€‚</p>
<p>ï¼ˆå®Œï¼‰</p>
<hr>
<p>:point_right: æƒ³å­¦ä¹ æ›´å¤š Spring å†…å®¹å¯ä»¥è®¿é—®æˆ‘çš„ Spring æ•™ç¨‹ï¼š**<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-notes">spring-notes</a>**</p>
<h2 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.edureka.co/blog/interview-questions/spring-interview-questions/">Top 50 Spring Interview Questions You Must Prepare In 2018</a></li>
<li><a target="_blank" rel="noopener" href="https://www.journaldev.com/2696/spring-interview-questions-and-answers">Spring Interview Questions and Answers</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/f9209d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/f9209d/" class="post-title-link" itemprop="url">åˆ†å¸ƒå¼é¢è¯•æ€»ç»“</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-10 16:02:00" itemprop="dateCreated datePublished" datetime="2018-07-10T16:02:00+08:00">2018-07-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">åˆ†å¸ƒå¼</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">åˆ†å¸ƒå¼ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>11 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="åˆ†å¸ƒå¼é¢è¯•æ€»ç»“"><a href="#åˆ†å¸ƒå¼é¢è¯•æ€»ç»“" class="headerlink" title="åˆ†å¸ƒå¼é¢è¯•æ€»ç»“"></a>åˆ†å¸ƒå¼é¢è¯•æ€»ç»“</h1><h2 id="åˆ†å¸ƒå¼ç¼“å­˜"><a href="#åˆ†å¸ƒå¼ç¼“å­˜" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜"></a>åˆ†å¸ƒå¼ç¼“å­˜</h2><h3 id="Redis-æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿåˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯"><a href="#Redis-æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿåˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯" class="headerlink" title="Redis æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿåˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯"></a>Redis æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿåˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯</h3><table>
<thead>
<tr>
<th>æ•°æ®ç±»å‹</th>
<th>å¯ä»¥å­˜å‚¨çš„å€¼</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody><tr>
<td>STRING</td>
<td>å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–è€…æµ®ç‚¹æ•°</td>
<td>å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²çš„å…¶ä¸­ä¸€éƒ¨åˆ†æ‰§è¡Œæ“ä½œ</br> å¯¹æ•´æ•°å’Œæµ®ç‚¹æ•°æ‰§è¡Œè‡ªå¢æˆ–è€…è‡ªå‡æ“ä½œ</td>
</tr>
<tr>
<td>LIST</td>
<td>åˆ—è¡¨</td>
<td>ä»ä¸¤ç«¯å‹å…¥æˆ–è€…å¼¹å‡ºå…ƒç´ </br> è¯»å–å•ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ </br> è¿›è¡Œä¿®å‰ªï¼Œåªä¿ç•™ä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´ </td>
</tr>
<tr>
<td>SET</td>
<td>æ— åºé›†åˆ</td>
<td>æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªå…ƒç´ </br> æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­</br> è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›†</br> ä»é›†åˆé‡Œé¢éšæœºè·å–å…ƒç´ </td>
</tr>
<tr>
<td>HASH</td>
<td>åŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨</td>
<td>æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªé”®å€¼å¯¹</br> è·å–æ‰€æœ‰é”®å€¼å¯¹</br> æ£€æŸ¥æŸä¸ªé”®æ˜¯å¦å­˜åœ¨</td>
</tr>
<tr>
<td>ZSET</td>
<td>æœ‰åºé›†åˆ</td>
<td>æ·»åŠ ã€è·å–ã€åˆ é™¤å…ƒç´ </br> æ ¹æ®åˆ†å€¼èŒƒå›´æˆ–è€…æˆå‘˜æ¥è·å–å…ƒç´ </br> è®¡ç®—ä¸€ä¸ªé”®çš„æ’å</td>
</tr>
</tbody></table>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://redislabs.com/ebook/part-1-getting-started/chapter-1-getting-to-know-redis/1-2-what-redis-data-structures-look-like/">What Redis data structures look like</a></p>
</blockquote>
<h3 id="Redis-çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„"><a href="#Redis-çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„" class="headerlink" title="Redis çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„"></a>Redis çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„</h3><ol>
<li>ä»æœåŠ¡å™¨è¿æ¥ä¸»æœåŠ¡å™¨ï¼Œå‘é€ SYNC å‘½ä»¤ï¼›</li>
<li>ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ° SYNC å‘½ååï¼Œå¼€å§‹æ‰§è¡Œ BGSAVE å‘½ä»¤ç”Ÿæˆ RDB æ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ï¼›</li>
<li>ä¸»æœåŠ¡å™¨ BGSAVE æ‰§è¡Œå®Œåï¼Œå‘æ‰€æœ‰ä»æœåŠ¡å™¨å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ï¼›</li>
<li>ä»æœåŠ¡å™¨æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ï¼›</li>
<li>ä¸»æœåŠ¡å™¨å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»æœåŠ¡å™¨å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ï¼›</li>
<li>ä»æœåŠ¡å™¨å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»æœåŠ¡å™¨ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼›</li>
</ol>
<h3 id="Redis-çš„-key-æ˜¯å¦‚ä½•å¯»å€çš„"><a href="#Redis-çš„-key-æ˜¯å¦‚ä½•å¯»å€çš„" class="headerlink" title="Redis çš„ key æ˜¯å¦‚ä½•å¯»å€çš„"></a>Redis çš„ key æ˜¯å¦‚ä½•å¯»å€çš„</h3><h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h4><p>ï¼ˆ1ï¼‰redis ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®åº“ï¼Œéƒ½ç”±ä¸€ä¸ª redisDb çš„ç»“æ„å­˜å‚¨ã€‚å…¶ä¸­ï¼š</p>
<ul>
<li>redisDb.id å­˜å‚¨ç€ redis æ•°æ®åº“ä»¥æ•´æ•°è¡¨ç¤ºçš„å·ç ã€‚</li>
<li>redisDb.dict å­˜å‚¨ç€è¯¥åº“æ‰€æœ‰çš„é”®å€¼å¯¹æ•°æ®ã€‚</li>
<li>redisDb.expires ä¿å­˜ç€æ¯ä¸€ä¸ªé”®çš„è¿‡æœŸæ—¶é—´ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰å½“ redis æœåŠ¡å™¨åˆå§‹åŒ–æ—¶ï¼Œä¼šé¢„å…ˆåˆ†é… 16 ä¸ªæ•°æ®åº“ï¼ˆè¯¥æ•°é‡å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®ï¼‰ï¼Œæ‰€æœ‰æ•°æ®åº“ä¿å­˜åˆ°ç»“æ„ redisServer çš„ä¸€ä¸ªæˆå‘˜ redisServer.db æ•°ç»„ä¸­ã€‚å½“æˆ‘ä»¬é€‰æ‹©æ•°æ®åº“ select number æ—¶ï¼Œç¨‹åºç›´æ¥é€šè¿‡ redisServer.db[number] æ¥åˆ‡æ¢æ•°æ®åº“ã€‚æœ‰æ—¶å€™å½“ç¨‹åºéœ€è¦çŸ¥é“è‡ªå·±æ˜¯åœ¨å“ªä¸ªæ•°æ®åº“æ—¶ï¼Œç›´æ¥è¯»å– redisDb.id å³å¯ã€‚</p>
<p>ï¼ˆ3ï¼‰redis çš„å­—å…¸ä½¿ç”¨å“ˆå¸Œè¡¨ä½œä¸ºå…¶åº•å±‚å®ç°ã€‚dict ç±»å‹ä½¿ç”¨çš„ä¸¤ä¸ªæŒ‡å‘å“ˆå¸Œè¡¨çš„æŒ‡é’ˆï¼Œå…¶ä¸­ 0 å·å“ˆå¸Œè¡¨ï¼ˆht[0]ï¼‰ä¸»è¦ç”¨äºå­˜å‚¨æ•°æ®åº“çš„æ‰€æœ‰é”®å€¼ï¼Œè€Œ 1 å·å“ˆå¸Œè¡¨ä¸»è¦ç”¨äºç¨‹åºå¯¹ 0 å·å“ˆå¸Œè¡¨è¿›è¡Œ rehash æ—¶ä½¿ç”¨ï¼Œrehash ä¸€èˆ¬æ˜¯åœ¨æ·»åŠ æ–°å€¼æ—¶ä¼šè§¦å‘ï¼Œè¿™é‡Œä¸åšè¿‡å¤šçš„èµ˜è¿°ã€‚æ‰€ä»¥ redis ä¸­æŸ¥æ‰¾ä¸€ä¸ª keyï¼Œå…¶å®å°±æ˜¯å¯¹è¿›è¡Œè¯¥ dict ç»“æ„ä¸­çš„ ht[0] è¿›è¡ŒæŸ¥æ‰¾æ“ä½œã€‚</p>
<p>ï¼ˆ4ï¼‰æ—¢ç„¶æ˜¯å“ˆå¸Œï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“å°±ä¼šæœ‰å“ˆå¸Œç¢°æ’ï¼Œé‚£ä¹ˆå½“å¤šä¸ªé”®å“ˆå¸Œä¹‹åä¸ºåŒä¸€ä¸ªå€¼æ€ä¹ˆåŠå‘¢ï¼Ÿredis é‡‡å–é“¾è¡¨çš„æ–¹å¼æ¥å­˜å‚¨å¤šä¸ªå“ˆå¸Œç¢°æ’çš„é”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ ¹æ® key çš„å“ˆå¸Œå€¼æ‰¾åˆ°è¯¥åˆ—è¡¨åï¼Œå¦‚æœåˆ—è¡¨çš„é•¿åº¦å¤§äº 1ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦éå†è¯¥é“¾è¡¨æ¥æ‰¾åˆ°æˆ‘ä»¬æ‰€æŸ¥æ‰¾çš„ keyã€‚å½“ç„¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é“¾è¡¨é•¿åº¦éƒ½ä¸ºæ˜¯ 1ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦å¯çœ‹ä½œ o(1)ã€‚</p>
<h4 id="å¯»å€-key-çš„æ­¥éª¤"><a href="#å¯»å€-key-çš„æ­¥éª¤" class="headerlink" title="å¯»å€ key çš„æ­¥éª¤"></a>å¯»å€ key çš„æ­¥éª¤</h4><ol>
<li>å½“æ‹¿åˆ°ä¸€ä¸ª key åï¼Œredis å…ˆåˆ¤æ–­å½“å‰åº“çš„ 0 å·å“ˆå¸Œè¡¨æ˜¯å¦ä¸ºç©ºï¼Œå³ï¼šif (dict-&gt;ht[0].size &#x3D;&#x3D; 0)ã€‚å¦‚æœä¸º true ç›´æ¥è¿”å› NULLã€‚</li>
<li>åˆ¤æ–­è¯¥ 0 å·å“ˆå¸Œè¡¨æ˜¯å¦éœ€è¦ rehashï¼Œå› ä¸ºå¦‚æœåœ¨è¿›è¡Œ rehashï¼Œé‚£ä¹ˆä¸¤ä¸ªè¡¨ä¸­è€…æœ‰å¯èƒ½å­˜å‚¨è¯¥ keyã€‚å¦‚æœæ­£åœ¨è¿›è¡Œ rehashï¼Œå°†è°ƒç”¨ä¸€æ¬¡<code>_dictRehashStep</code> æ–¹æ³•ï¼Œ<code>_dictRehashStep</code> ç”¨äºå¯¹æ•°æ®åº“å­—å…¸ã€ä»¥åŠå“ˆå¸Œé”®çš„å­—å…¸è¿›è¡Œè¢«åŠ¨ rehashï¼Œè¿™é‡Œä¸ä½œèµ˜è¿°ã€‚</li>
<li>è®¡ç®—å“ˆå¸Œè¡¨ï¼Œæ ¹æ®å½“å‰å­—å…¸ä¸ key è¿›è¡Œå“ˆå¸Œå€¼çš„è®¡ç®—ã€‚</li>
<li>æ ¹æ®å“ˆå¸Œå€¼ä¸å½“å‰å­—å…¸è®¡ç®—å“ˆå¸Œè¡¨çš„ç´¢å¼•å€¼ã€‚</li>
<li>æ ¹æ®ç´¢å¼•å€¼åœ¨å“ˆå¸Œè¡¨ä¸­å–å‡ºé“¾è¡¨ï¼Œéå†è¯¥é“¾è¡¨æ‰¾åˆ° key çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µï¼Œè¯¥é“¾è¡¨é•¿åº¦ä¸º 1ã€‚</li>
<li>å½“ ht[0] æŸ¥æ‰¾å®Œäº†ä¹‹åï¼Œå†è¿›è¡Œäº†æ¬¡ rehash åˆ¤æ–­ï¼Œå¦‚æœæœªåœ¨ rehashingï¼Œåˆ™ç›´æ¥ç»“æŸï¼Œå¦åˆ™å¯¹ ht[1]é‡å¤ 345 æ­¥éª¤ã€‚</li>
</ol>
<h3 id="Redis-çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"><a href="#Redis-çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ" class="headerlink" title="Redis çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"></a>Redis çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h3><p>Redis Cluster æ˜¯ Redis çš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆï¼Œåœ¨ Redis 3.0 ç‰ˆæœ¬æ­£å¼æ¨å‡ºçš„ã€‚</p>
<p>Redis Cluster å»ä¸­å¿ƒåŒ–ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çŠ¶æ€ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿æ¥ã€‚</p>
<h4 id="Redis-Cluster-èŠ‚ç‚¹åˆ†é…"><a href="#Redis-Cluster-èŠ‚ç‚¹åˆ†é…" class="headerlink" title="Redis Cluster èŠ‚ç‚¹åˆ†é…"></a>Redis Cluster èŠ‚ç‚¹åˆ†é…</h4><p>Redis Cluster ç‰¹ç‚¹ï¼š</p>
<ol>
<li>æ‰€æœ‰çš„ redis èŠ‚ç‚¹å½¼æ­¤äº’è”(PING-PONG æœºåˆ¶)ï¼Œå†…éƒ¨ä½¿ç”¨äºŒè¿›åˆ¶åè®®ä¼˜åŒ–ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½ã€‚</li>
<li>èŠ‚ç‚¹çš„ fail æ˜¯é€šè¿‡é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æ£€æµ‹å¤±æ•ˆæ—¶æ‰ç”Ÿæ•ˆã€‚</li>
<li>å®¢æˆ·ç«¯ä¸ redis èŠ‚ç‚¹ç›´è¿,ä¸éœ€è¦ä¸­é—´ proxy å±‚ã€‚å®¢æˆ·ç«¯ä¸éœ€è¦è¿æ¥é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¿æ¥é›†ç¾¤ä¸­ä»»ä½•ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹å³å¯ã€‚</li>
<li>redis-cluster æŠŠæ‰€æœ‰çš„ç‰©ç†èŠ‚ç‚¹æ˜ å°„åˆ°[0-16383] å“ˆå¸Œæ§½ (hash slot)ä¸Šï¼ˆä¸ä¸€å®šæ˜¯å¹³å‡åˆ†é…ï¼‰,cluster è´Ÿè´£ç»´æŠ¤ node&lt;-&gt;slot&lt;-&gt;valueã€‚</li>
<li>Redis é›†ç¾¤é¢„åˆ†å¥½ 16384 ä¸ªæ¡¶ï¼Œå½“éœ€è¦åœ¨ Redis é›†ç¾¤ä¸­æ”¾ç½®ä¸€ä¸ª key-value æ—¶ï¼Œæ ¹æ® CRC16(key) mod 16384 çš„å€¼ï¼Œå†³å®šå°†ä¸€ä¸ª key æ”¾åˆ°å“ªä¸ªæ¡¶ä¸­ã€‚</li>
</ol>
<h4 id="Redis-Cluster-ä¸»ä»æ¨¡å¼"><a href="#Redis-Cluster-ä¸»ä»æ¨¡å¼" class="headerlink" title="Redis Cluster ä¸»ä»æ¨¡å¼"></a>Redis Cluster ä¸»ä»æ¨¡å¼</h4><p>Redis Cluster ä¸ºäº†ä¿è¯æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼ŒåŠ å…¥äº†ä¸»ä»æ¨¡å¼ã€‚</p>
<p>ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹æä¾›æ•°æ®å­˜å–ï¼Œä»èŠ‚ç‚¹åˆ™æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–æ•°æ®å¤‡ä»½ã€‚å½“è¿™ä¸ªä¸»èŠ‚ç‚¹æŒ‚æ‰åï¼Œå°±ä¼šæœ‰è¿™ä¸ªä»èŠ‚ç‚¹é€‰å–ä¸€ä¸ªæ¥å……å½“ä¸»èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯é›†ç¾¤ä¸ä¼šæŒ‚æ‰ã€‚æ‰€ä»¥ï¼Œåœ¨é›†ç¾¤å»ºç«‹çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¸ºæ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ·»åŠ äº†ä»èŠ‚ç‚¹ã€‚</p>
<h4 id="Redis-Sentinel"><a href="#Redis-Sentinel" class="headerlink" title="Redis Sentinel"></a>Redis Sentinel</h4><p>Redis Sentinel ç”¨äºç®¡ç†å¤šä¸ª Redis æœåŠ¡å™¨ï¼Œå®ƒæœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li><strong>ç›‘æ§ï¼ˆMonitoringï¼‰</strong> - Sentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li>
<li><strong>æé†’ï¼ˆNotificationï¼‰</strong> - å½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œ Sentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚</li>
<li><strong>è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomatic failoverï¼‰</strong> - å½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œ Sentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œ å¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»æœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œ ä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚</li>
</ul>
<p>Redis é›†ç¾¤ä¸­åº”è¯¥æœ‰å¥‡æ•°ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥è‡³å°‘æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ã€‚</p>
<p>å“¨å…µç›‘æ§é›†ç¾¤ä¸­çš„ä¸»æœåŠ¡å™¨å‡ºç°æ•…éšœæ—¶ï¼Œéœ€è¦æ ¹æ® quorum é€‰ä¸¾å‡ºä¸€ä¸ªå“¨å…µæ¥æ‰§è¡Œæ•…éšœè½¬ç§»ã€‚é€‰ä¸¾éœ€è¦ majorityï¼Œå³å¤§å¤šæ•°å“¨å…µæ˜¯è¿è¡Œçš„ï¼ˆ2 ä¸ªå“¨å…µçš„ majority&#x3D;2ï¼Œ3 ä¸ªå“¨å…µçš„ majority&#x3D;2ï¼Œ5 ä¸ªå“¨å…µçš„ majority&#x3D;3ï¼Œ4 ä¸ªå“¨å…µçš„ majority&#x3D;2ï¼‰ã€‚</p>
<p>å‡è®¾é›†ç¾¤ä»…ä»…éƒ¨ç½² 2 ä¸ªèŠ‚ç‚¹</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+----+         +----+</span><br><span class="line">|<span class="string"> M1 </span>|<span class="string">---------</span>|<span class="string"> R1 </span>|</span><br><span class="line">|<span class="string"> S1 </span>|<span class="string">         </span>|<span class="string"> S2 </span>|</span><br><span class="line">+----+         +----+</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ M1 å’Œ S1 æ‰€åœ¨æœåŠ¡å™¨å®•æœºï¼Œåˆ™å“¨å…µåªæœ‰ 1 ä¸ªï¼Œæ— æ³•æ»¡è¶³ majority æ¥è¿›è¡Œé€‰ä¸¾ï¼Œå°±ä¸èƒ½æ‰§è¡Œæ•…éšœè½¬ç§»ã€‚</p>
<h3 id="Redis-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼ŸZooKeeper-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿæ¯”è¾ƒäºŒè€…ä¼˜åŠ£ï¼Ÿ"><a href="#Redis-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼ŸZooKeeper-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿæ¯”è¾ƒäºŒè€…ä¼˜åŠ£ï¼Ÿ" class="headerlink" title="Redis å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼ŸZooKeeper å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿæ¯”è¾ƒäºŒè€…ä¼˜åŠ£ï¼Ÿ"></a>Redis å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼ŸZooKeeper å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿæ¯”è¾ƒäºŒè€…ä¼˜åŠ£ï¼Ÿ</h3><p>åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°ï¼š</p>
<ul>
<li>åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ï¼›</li>
<li>åŸºäºç¼“å­˜ï¼ˆRedis ç­‰ï¼‰å®ç°åˆ†å¸ƒå¼é”ï¼›</li>
<li>åŸºäº Zookeeper å®ç°åˆ†å¸ƒå¼é”ï¼›</li>
</ul>
<h4 id="æ•°æ®åº“å®ç°"><a href="#æ•°æ®åº“å®ç°" class="headerlink" title="æ•°æ®åº“å®ç°"></a>æ•°æ®åº“å®ç°</h4><h4 id="Redis-å®ç°"><a href="#Redis-å®ç°" class="headerlink" title="Redis å®ç°"></a>Redis å®ç°</h4><ol>
<li>è·å–é”çš„æ—¶å€™ï¼Œä½¿ç”¨ setnx åŠ é”ï¼Œå¹¶ä½¿ç”¨ expire å‘½ä»¤ä¸ºé”æ·»åŠ ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´åˆ™è‡ªåŠ¨é‡Šæ”¾é”ï¼Œé”çš„ value å€¼ä¸ºä¸€ä¸ªéšæœºç”Ÿæˆçš„ UUIDï¼Œé€šè¿‡æ­¤åœ¨é‡Šæ”¾é”çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ã€‚</li>
<li>è·å–é”çš„æ—¶å€™è¿˜è®¾ç½®ä¸€ä¸ªè·å–çš„è¶…æ—¶æ—¶é—´ï¼Œè‹¥è¶…è¿‡è¿™ä¸ªæ—¶é—´åˆ™æ”¾å¼ƒè·å–é”ã€‚</li>
<li>é‡Šæ”¾é”çš„æ—¶å€™ï¼Œé€šè¿‡ UUID åˆ¤æ–­æ˜¯ä¸æ˜¯è¯¥é”ï¼Œè‹¥æ˜¯è¯¥é”ï¼Œåˆ™æ‰§è¡Œ delete è¿›è¡Œé”é‡Šæ”¾ã€‚</li>
</ol>
<h4 id="ZooKeeper-å®ç°"><a href="#ZooKeeper-å®ç°" class="headerlink" title="ZooKeeper å®ç°"></a>ZooKeeper å®ç°</h4><ol>
<li>åˆ›å»ºä¸€ä¸ªç›®å½• mylockï¼›</li>
<li>çº¿ç¨‹ A æƒ³è·å–é”å°±åœ¨ mylock ç›®å½•ä¸‹åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼›</li>
<li>è·å– mylock ç›®å½•ä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œç„¶åè·å–æ¯”è‡ªå·±å°çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹é¡ºåºå·æœ€å°ï¼Œè·å¾—é”ï¼›</li>
<li>çº¿ç¨‹ B è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ¤æ–­è‡ªå·±ä¸æ˜¯æœ€å°èŠ‚ç‚¹ï¼Œè®¾ç½®ç›‘å¬æ¯”è‡ªå·±æ¬¡å°çš„èŠ‚ç‚¹ï¼›</li>
<li>çº¿ç¨‹ A å¤„ç†å®Œï¼Œåˆ é™¤è‡ªå·±çš„èŠ‚ç‚¹ï¼Œçº¿ç¨‹ B ç›‘å¬åˆ°å˜æ›´äº‹ä»¶ï¼Œåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åˆ™è·å¾—é”ã€‚</li>
</ol>
<h4 id="å®ç°å¯¹æ¯”"><a href="#å®ç°å¯¹æ¯”" class="headerlink" title="å®ç°å¯¹æ¯”"></a>å®ç°å¯¹æ¯”</h4><p>ZooKeeper å…·å¤‡é«˜å¯ç”¨ã€å¯é‡å…¥ã€é˜»å¡é”ç‰¹æ€§ï¼Œå¯è§£å†³å¤±æ•ˆæ­»é”é—®é¢˜ã€‚<br>ä½† ZooKeeper å› ä¸ºéœ€è¦é¢‘ç¹çš„åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ€§èƒ½ä¸Šä¸å¦‚ Redis æ–¹å¼ã€‚</p>
<h3 id="Redis-çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼ŸæŒä¹…åŒ–å®ç°åŸç†ï¼Ÿ"><a href="#Redis-çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼ŸæŒä¹…åŒ–å®ç°åŸç†ï¼Ÿ" class="headerlink" title="Redis çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼ŸæŒä¹…åŒ–å®ç°åŸç†ï¼Ÿ"></a>Redis çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼ŸæŒä¹…åŒ–å®ç°åŸç†ï¼Ÿ</h3><h4 id="RDB-å¿«ç…§ï¼ˆsnapshotï¼‰"><a href="#RDB-å¿«ç…§ï¼ˆsnapshotï¼‰" class="headerlink" title="RDB å¿«ç…§ï¼ˆsnapshotï¼‰"></a>RDB å¿«ç…§ï¼ˆsnapshotï¼‰</h4><p>å°†å­˜åœ¨äºæŸä¸€æ—¶åˆ»çš„æ‰€æœ‰æ•°æ®éƒ½å†™å…¥åˆ°ç¡¬ç›˜ä¸­ã€‚</p>
<h5 id="å¿«ç…§çš„åŸç†"><a href="#å¿«ç…§çš„åŸç†" class="headerlink" title="å¿«ç…§çš„åŸç†"></a>å¿«ç…§çš„åŸç†</h5><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œ è®©å®ƒåœ¨â€œN ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ SAVE æˆ–è€… BGSAVEï¼Œæ‰‹åŠ¨è®© Redis è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œã€‚è¿™ç§æŒä¹…åŒ–æ–¹å¼è¢«ç§°ä¸ºå¿«ç…§ã€‚</p>
<p>å½“ Redis éœ€è¦ä¿å­˜ dump.rdb æ–‡ä»¶æ—¶ï¼Œ æœåŠ¡å™¨æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p>
<ul>
<li>Redis åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚</li>
<li>å­è¿›ç¨‹å°†æ•°æ®é›†å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶å¿«ç…§æ–‡ä»¶ä¸­ã€‚</li>
<li>å½“å­è¿›ç¨‹å®Œæˆå¯¹æ–°å¿«ç…§æ–‡ä»¶çš„å†™å…¥æ—¶ï¼ŒRedis ç”¨æ–°å¿«ç…§æ–‡ä»¶æ›¿æ¢åŸæ¥çš„å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„å¿«ç…§æ–‡ä»¶ã€‚</li>
</ul>
<p>è¿™ç§å·¥ä½œæ–¹å¼ä½¿å¾— Redis å¯ä»¥ä»å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æœºåˆ¶ä¸­è·ç›Šã€‚</p>
<h5 id="å¿«ç…§çš„ä¼˜ç‚¹"><a href="#å¿«ç…§çš„ä¼˜ç‚¹" class="headerlink" title="å¿«ç…§çš„ä¼˜ç‚¹"></a>å¿«ç…§çš„ä¼˜ç‚¹</h5><ul>
<li>å®ƒä¿å­˜äº†æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®é›†ï¼Œéå¸¸é€‚ç”¨äºæ•°æ®é›†çš„å¤‡ä»½ã€‚</li>
<li>å¾ˆæ–¹ä¾¿ä¼ é€åˆ°å¦ä¸€ä¸ªè¿œç«¯æ•°æ®ä¸­å¿ƒæˆ–è€…äºšé©¬é€Šçš„ S3ï¼ˆå¯èƒ½åŠ å¯†ï¼‰ï¼Œéå¸¸é€‚ç”¨äºç¾éš¾æ¢å¤ã€‚</li>
<li>å¿«ç…§åœ¨ä¿å­˜ RDB æ–‡ä»¶æ—¶çˆ¶è¿›ç¨‹å”¯ä¸€éœ€è¦åšçš„å°±æ˜¯ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œå…¨éƒ¨ç”±å­è¿›ç¨‹æ¥åšï¼Œçˆ¶è¿›ç¨‹ä¸éœ€è¦å†åšå…¶ä»– IO æ“ä½œï¼Œæ‰€ä»¥å¿«ç…§æŒä¹…åŒ–æ–¹å¼å¯ä»¥æœ€å¤§åŒ– redis çš„æ€§èƒ½ã€‚</li>
<li>ä¸ AOF ç›¸æ¯”ï¼Œåœ¨æ¢å¤å¤§çš„æ•°æ®é›†çš„æ—¶å€™ï¼ŒDB æ–¹å¼ä¼šæ›´å¿«ä¸€äº›ã€‚</li>
</ul>
<h5 id="å¿«ç…§çš„ç¼ºç‚¹"><a href="#å¿«ç…§çš„ç¼ºç‚¹" class="headerlink" title="å¿«ç…§çš„ç¼ºç‚¹"></a>å¿«ç…§çš„ç¼ºç‚¹</h5><ul>
<li>å¦‚æœä½ å¸Œæœ›åœ¨ redis æ„å¤–åœæ­¢å·¥ä½œï¼ˆä¾‹å¦‚ç”µæºä¸­æ–­ï¼‰çš„æƒ…å†µä¸‹ä¸¢å¤±çš„æ•°æ®æœ€å°‘çš„è¯ï¼Œé‚£ä¹ˆå¿«ç…§ä¸é€‚åˆä½ ã€‚</li>
<li>å¿«ç…§éœ€è¦ç»å¸¸ fork å­è¿›ç¨‹æ¥ä¿å­˜æ•°æ®é›†åˆ°ç¡¬ç›˜ä¸Šã€‚å½“æ•°æ®é›†æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œfork çš„è¿‡ç¨‹æ˜¯éå¸¸è€—æ—¶çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ Redis åœ¨ä¸€äº›æ¯«ç§’çº§å†…ä¸èƒ½å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</li>
</ul>
<h4 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h4><p>AOF æŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨æ‰§è¡Œçš„å†™æ“ä½œã€‚å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®ã€‚</p>
<h4 id="AOF-çš„åŸç†"><a href="#AOF-çš„åŸç†" class="headerlink" title="AOF çš„åŸç†"></a>AOF çš„åŸç†</h4><ul>
<li>Redis åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚</li>
<li>å­è¿›ç¨‹å¼€å§‹å°†æ–° AOF æ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶ã€‚</li>
<li>å¯¹äºæ‰€æœ‰æ–°æ‰§è¡Œçš„å†™å…¥å‘½ä»¤ï¼Œçˆ¶è¿›ç¨‹ä¸€è¾¹å°†å®ƒä»¬ç´¯ç§¯åˆ°ä¸€ä¸ªå†…å­˜ç¼“å­˜ä¸­ï¼Œä¸€è¾¹å°†è¿™äº›æ”¹åŠ¨è¿½åŠ åˆ°ç°æœ‰ AOF æ–‡ä»¶çš„æœ«å°¾ï¼Œè¿™æ ·æ ·å³ä½¿åœ¨é‡å†™çš„ä¸­é€”å‘ç”Ÿåœæœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿè¿˜æ˜¯å®‰å…¨çš„ã€‚</li>
<li>å½“å­è¿›ç¨‹å®Œæˆé‡å†™å·¥ä½œæ—¶ï¼Œå®ƒç»™çˆ¶è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œçˆ¶è¿›ç¨‹åœ¨æ¥æ”¶åˆ°ä¿¡å·ä¹‹åï¼Œå°†å†…å­˜ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚</li>
<li>æå®šï¼ç°åœ¨ Redis åŸå­åœ°ç”¨æ–°æ–‡ä»¶æ›¿æ¢æ—§æ–‡ä»¶ï¼Œä¹‹åæ‰€æœ‰å‘½ä»¤éƒ½ä¼šç›´æ¥è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚</li>
</ul>
<h4 id="AOF-çš„ä¼˜ç‚¹"><a href="#AOF-çš„ä¼˜ç‚¹" class="headerlink" title="AOF çš„ä¼˜ç‚¹"></a>AOF çš„ä¼˜ç‚¹</h4><ul>
<li>ä½¿ç”¨é»˜è®¤çš„æ¯ç§’ fsync ç­–ç•¥ï¼ŒRedis çš„æ€§èƒ½ä¾ç„¶å¾ˆå¥½(fsync æ˜¯ç”±åå°çº¿ç¨‹è¿›è¡Œå¤„ç†çš„,ä¸»çº¿ç¨‹ä¼šå°½åŠ›å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚)ï¼Œä¸€æ—¦å‡ºç°æ•…éšœï¼Œä½¿ç”¨ AOF ï¼Œä½ æœ€å¤šä¸¢å¤± 1 ç§’çš„æ•°æ®ã€‚</li>
<li>AOF æ–‡ä»¶æ˜¯ä¸€ä¸ªåªè¿›è¡Œè¿½åŠ çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸éœ€è¦å†™å…¥ seekï¼Œå³ä½¿ç”±äºæŸäº›åŸå› (ç£ç›˜ç©ºé—´å·²æ»¡ï¼Œå†™çš„è¿‡ç¨‹ä¸­å®•æœºç­‰ç­‰)æœªæ‰§è¡Œå®Œæ•´çš„å†™å…¥å‘½ä»¤ï¼Œä½ ä¹Ÿä¹Ÿå¯ä½¿ç”¨ redis-check-aof å·¥å…·ä¿®å¤è¿™äº›é—®é¢˜ã€‚</li>
<li>Redis å¯ä»¥åœ¨ AOF æ–‡ä»¶ä½“ç§¯å˜å¾—è¿‡å¤§æ—¶ï¼Œè‡ªåŠ¨åœ°åœ¨åå°å¯¹ AOF è¿›è¡Œé‡å†™ï¼šé‡å†™åçš„æ–° AOF æ–‡ä»¶åŒ…å«äº†æ¢å¤å½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°å‘½ä»¤é›†åˆã€‚æ•´ä¸ªé‡å†™æ“ä½œæ˜¯ç»å¯¹å®‰å…¨çš„ã€‚</li>
<li>AOF æ–‡ä»¶æœ‰åºåœ°ä¿å­˜äº†å¯¹æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å†™å…¥æ“ä½œï¼Œè¿™äº›å†™å…¥æ“ä½œä»¥ Redis åè®®çš„æ ¼å¼ä¿å­˜ã€‚å› æ­¤ AOF æ–‡ä»¶çš„å†…å®¹éå¸¸å®¹æ˜“è¢«äººè¯»æ‡‚ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆparseï¼‰ä¹Ÿå¾ˆè½»æ¾ã€‚</li>
</ul>
<h4 id="AOF-çš„ç¼ºç‚¹"><a href="#AOF-çš„ç¼ºç‚¹" class="headerlink" title="AOF çš„ç¼ºç‚¹"></a>AOF çš„ç¼ºç‚¹</h4><ul>
<li>å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äº RDB æ–‡ä»¶çš„ä½“ç§¯ã€‚</li>
<li>æ ¹æ®æ‰€ä½¿ç”¨çš„ fsync ç­–ç•¥ï¼ŒAOF çš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äºå¿«ç…§ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ç§’ fsync çš„æ€§èƒ½ä¾ç„¶éå¸¸é«˜ï¼Œè€Œå…³é—­ fsync å¯ä»¥è®© AOF çš„é€Ÿåº¦å’Œå¿«ç…§ä¸€æ ·å¿«ï¼Œå³ä½¿åœ¨é«˜è´Ÿè·ä¹‹ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸è¿‡åœ¨å¤„ç†å·¨å¤§çš„å†™å…¥è½½å…¥æ—¶ï¼Œå¿«ç…§å¯ä»¥æä¾›æ›´æœ‰ä¿è¯çš„æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼ˆlatencyï¼‰ã€‚</li>
</ul>
<h3 id="Redis-è¿‡æœŸç­–ç•¥æœ‰å“ªäº›ï¼Ÿ"><a href="#Redis-è¿‡æœŸç­–ç•¥æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="Redis è¿‡æœŸç­–ç•¥æœ‰å“ªäº›ï¼Ÿ"></a>Redis è¿‡æœŸç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</h3><ul>
<li><strong>noeviction</strong> - å½“å†…å­˜ä½¿ç”¨è¾¾åˆ°é˜ˆå€¼çš„æ—¶å€™ï¼Œæ‰€æœ‰å¼•èµ·ç”³è¯·å†…å­˜çš„å‘½ä»¤ä¼šæŠ¥é”™ã€‚</li>
<li><strong>allkeys-lru</strong> - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚</li>
<li><strong>allkeys-random</strong> - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚</li>
<li><strong>volatile-lru</strong> - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚</li>
<li><strong>volatile-random</strong> - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚</li>
<li><strong>volatile-ttl</strong> - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œå…·æœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„ key ä¼˜å…ˆç§»é™¤ã€‚</li>
</ul>
<h3 id="Redis-å’Œ-Memcached-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#Redis-å’Œ-Memcached-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="Redis å’Œ Memcached æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>Redis å’Œ Memcached æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>ä¸¤è€…éƒ½æ˜¯éå…³ç³»å‹å†…å­˜é”®å€¼æ•°æ®åº“ã€‚æœ‰ä»¥ä¸‹ä¸»è¦ä¸åŒï¼š</p>
<p><strong>æ•°æ®ç±»å‹</strong></p>
<ul>
<li>Memcached ä»…æ”¯æŒå­—ç¬¦ä¸²ç±»å‹ï¼›</li>
<li>è€Œ Redis æ”¯æŒäº”ç§ä¸åŒç§ç±»çš„æ•°æ®ç±»å‹ï¼Œä½¿å¾—å®ƒå¯ä»¥æ›´çµæ´»åœ°è§£å†³é—®é¢˜ã€‚</li>
</ul>
<p><strong>æ•°æ®æŒä¹…åŒ–</strong></p>
<ul>
<li>Memcached ä¸æ”¯æŒæŒä¹…åŒ–ï¼›</li>
<li>Redis æ”¯æŒä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼šRDB å¿«ç…§å’Œ AOF æ—¥å¿—ã€‚</li>
</ul>
<p><strong>åˆ†å¸ƒå¼</strong></p>
<ul>
<li>Memcached ä¸æ”¯æŒåˆ†å¸ƒå¼ï¼Œåªèƒ½é€šè¿‡åœ¨å®¢æˆ·ç«¯ä½¿ç”¨åƒä¸€è‡´æ€§å“ˆå¸Œè¿™æ ·çš„åˆ†å¸ƒå¼ç®—æ³•æ¥å®ç°åˆ†å¸ƒå¼å­˜å‚¨ï¼Œè¿™ç§æ–¹å¼åœ¨å­˜å‚¨å’ŒæŸ¥è¯¢æ—¶éƒ½éœ€è¦å…ˆåœ¨å®¢æˆ·ç«¯è®¡ç®—ä¸€æ¬¡æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚</li>
<li>Redis Cluster å®ç°äº†åˆ†å¸ƒå¼çš„æ”¯æŒã€‚</li>
</ul>
<p><strong>å†…å­˜ç®¡ç†æœºåˆ¶</strong></p>
<ul>
<li>Memcached å°†å†…å­˜åˆ†å‰²æˆç‰¹å®šé•¿åº¦çš„å—æ¥å­˜å‚¨æ•°æ®ï¼Œä»¥å®Œå…¨è§£å†³å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¼šä½¿å¾—å†…å­˜çš„åˆ©ç”¨ç‡ä¸é«˜ï¼Œä¾‹å¦‚å—çš„å¤§å°ä¸º 128 bytesï¼Œåªå­˜å‚¨ 100 bytes çš„æ•°æ®ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ 28 bytes å°±æµªè´¹æ‰äº†ã€‚</li>
<li>åœ¨ Redis ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æ•°æ®éƒ½ä¸€ç›´å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥å°†ä¸€äº›å¾ˆä¹…æ²¡ç”¨çš„ value äº¤æ¢åˆ°ç£ç›˜ã€‚è€Œ Memcached çš„æ•°æ®åˆ™ä¼šä¸€ç›´åœ¨å†…å­˜ä¸­ã€‚</li>
</ul>
<h3 id="ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„-Redis-æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„-Memcachedï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„-Redis-æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„-Memcachedï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„ Redis æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„ Memcachedï¼Ÿ"></a>ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„ Redis æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„ Memcachedï¼Ÿ</h3><p>Redis å¿«é€Ÿçš„åŸå› ï¼š</p>
<ol>
<li>ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼ˆéå¸¸å¿«é€Ÿï¼‰</li>
<li>é‡‡ç”¨å•çº¿ç¨‹,é¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶</li>
<li>éé˜»å¡ IO</li>
</ol>
<p>å†…éƒ¨å®ç°é‡‡ç”¨ epollï¼Œé‡‡ç”¨äº† epoll+è‡ªå·±å®ç°çš„ç®€å•çš„äº‹ä»¶æ¡†æ¶ã€‚epoll ä¸­çš„è¯»ã€å†™ã€å…³é—­ã€è¿æ¥éƒ½è½¬åŒ–æˆäº†äº‹ä»¶ï¼Œç„¶ååˆ©ç”¨ epoll çš„å¤šè·¯å¤ç”¨ç‰¹æ€§ï¼Œç»ä¸åœ¨ io ä¸Šæµªè´¹ä¸€ç‚¹æ—¶é—´ã€‚</p>
<h2 id="åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰"><a href="#åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰" class="headerlink" title="åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰"></a>åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰</h2><h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨-MQï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨-MQï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ MQï¼Ÿ"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ MQï¼Ÿ</h3><ul>
<li>å¼‚æ­¥å¤„ç† - ç›¸æ¯”äºä¼ ç»Ÿçš„ä¸²è¡Œã€å¹¶è¡Œæ–¹å¼ï¼Œæé«˜äº†ç³»ç»Ÿååé‡ã€‚</li>
<li>åº”ç”¨è§£è€¦ - ç³»ç»Ÿé—´é€šè¿‡æ¶ˆæ¯é€šä¿¡ï¼Œä¸ç”¨å…³å¿ƒå…¶ä»–ç³»ç»Ÿçš„å¤„ç†ã€‚</li>
<li>æµé‡å‰Šé”‹ - å¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦æ§åˆ¶è¯·æ±‚é‡ï¼›å¯ä»¥ç¼“è§£çŸ­æ—¶é—´å†…çš„é«˜å¹¶å‘è¯·æ±‚ã€‚</li>
<li>æ—¥å¿—å¤„ç† - è§£å†³å¤§é‡æ—¥å¿—ä¼ è¾“ã€‚</li>
<li>æ¶ˆæ¯é€šè®¯ - æ¶ˆæ¯é˜Ÿåˆ—ä¸€èˆ¬éƒ½å†…ç½®äº†é«˜æ•ˆçš„é€šä¿¡æœºåˆ¶ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç”¨åœ¨çº¯çš„æ¶ˆæ¯é€šè®¯ã€‚æ¯”å¦‚å®ç°ç‚¹å¯¹ç‚¹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ–è€…èŠå¤©å®¤ç­‰ã€‚</li>
</ul>
<h3 id="å¦‚ä½•ä¿è¯-MQ-çš„é«˜å¯ç”¨ï¼Ÿ"><a href="#å¦‚ä½•ä¿è¯-MQ-çš„é«˜å¯ç”¨ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿è¯ MQ çš„é«˜å¯ç”¨ï¼Ÿ"></a>å¦‚ä½•ä¿è¯ MQ çš„é«˜å¯ç”¨ï¼Ÿ</h3><h4 id="æ•°æ®å¤åˆ¶"><a href="#æ•°æ®å¤åˆ¶" class="headerlink" title="æ•°æ®å¤åˆ¶"></a>æ•°æ®å¤åˆ¶</h4><ol>
<li>å°†æ‰€æœ‰ Broker å’Œå¾…åˆ†é…çš„ Partition æ’åº</li>
<li>å°†ç¬¬ i ä¸ª Partition åˆ†é…åˆ°ç¬¬ï¼ˆi mod nï¼‰ä¸ª Broker ä¸Š</li>
<li>å°†ç¬¬ i ä¸ª Partition çš„ç¬¬ j ä¸ª Replica åˆ†é…åˆ°ç¬¬ï¼ˆ(i + j) mode nï¼‰ä¸ª Broker ä¸Š</li>
</ol>
<h4 id="é€‰ä¸¾ä¸»æœåŠ¡å™¨"><a href="#é€‰ä¸¾ä¸»æœåŠ¡å™¨" class="headerlink" title="é€‰ä¸¾ä¸»æœåŠ¡å™¨"></a>é€‰ä¸¾ä¸»æœåŠ¡å™¨</h4><h3 id="MQ-æœ‰å“ªäº›å¸¸è§é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ"><a href="#MQ-æœ‰å“ªäº›å¸¸è§é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ" class="headerlink" title="MQ æœ‰å“ªäº›å¸¸è§é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ"></a>MQ æœ‰å“ªäº›å¸¸è§é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ</h3><p>MQ çš„å¸¸è§é—®é¢˜æœ‰ï¼š</p>
<ol>
<li>æ¶ˆæ¯çš„é¡ºåºé—®é¢˜</li>
<li>æ¶ˆæ¯çš„é‡å¤é—®é¢˜</li>
</ol>
<h4 id="æ¶ˆæ¯çš„é¡ºåºé—®é¢˜"><a href="#æ¶ˆæ¯çš„é¡ºåºé—®é¢˜" class="headerlink" title="æ¶ˆæ¯çš„é¡ºåºé—®é¢˜"></a>æ¶ˆæ¯çš„é¡ºåºé—®é¢˜</h4><p>æ¶ˆæ¯æœ‰åºæŒ‡çš„æ˜¯å¯ä»¥æŒ‰ç…§æ¶ˆæ¯çš„å‘é€é¡ºåºæ¥æ¶ˆè´¹ã€‚</p>
<p>å‡å¦‚ç”Ÿäº§è€…äº§ç”Ÿäº† 2 æ¡æ¶ˆæ¯ï¼šM1ã€M2ï¼Œå‡å®š M1 å‘é€åˆ° S1ï¼ŒM2 å‘é€åˆ° S2ï¼Œå¦‚æœè¦ä¿è¯ M1 å…ˆäº M2 è¢«æ¶ˆè´¹ï¼Œæ€ä¹ˆåšï¼Ÿ</p>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-23145c8b554a0f2f.jpg"/></div>
è§£å†³æ–¹æ¡ˆï¼š

<p>ï¼ˆ1ï¼‰ä¿è¯ç”Ÿäº§è€… - MQServer - æ¶ˆè´¹è€…æ˜¯ä¸€å¯¹ä¸€å¯¹ä¸€çš„å…³ç³»</p>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-034106d7e04c062d.jpg"/></div>
ç¼ºé™·ï¼š

<ul>
<li>å¹¶è¡Œåº¦å°±ä¼šæˆä¸ºæ¶ˆæ¯ç³»ç»Ÿçš„ç“¶é¢ˆï¼ˆååé‡ä¸å¤Ÿï¼‰</li>
<li>æ›´å¤šçš„å¼‚å¸¸å¤„ç†ï¼Œæ¯”å¦‚ï¼šåªè¦æ¶ˆè´¹ç«¯å‡ºç°é—®é¢˜ï¼Œå°±ä¼šå¯¼è‡´æ•´ä¸ªå¤„ç†æµç¨‹é˜»å¡ï¼Œæˆ‘ä»¬ä¸å¾—ä¸èŠ±è´¹æ›´å¤šçš„ç²¾åŠ›æ¥è§£å†³é˜»å¡çš„é—®é¢˜ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰é€šè¿‡åˆç†çš„è®¾è®¡æˆ–è€…å°†é—®é¢˜åˆ†è§£æ¥è§„é¿ã€‚</p>
<ul>
<li>ä¸å…³æ³¨ä¹±åºçš„åº”ç”¨å®é™…å¤§é‡å­˜åœ¨</li>
<li>é˜Ÿåˆ—æ— åºå¹¶ä¸æ„å‘³ç€æ¶ˆæ¯æ— åº</li>
</ul>
<p>æ‰€ä»¥ä»ä¸šåŠ¡å±‚é¢æ¥ä¿è¯æ¶ˆæ¯çš„é¡ºåºè€Œä¸ä»…ä»…æ˜¯ä¾èµ–äºæ¶ˆæ¯ç³»ç»Ÿï¼Œæ˜¯ä¸€ç§æ›´åˆç†çš„æ–¹å¼ã€‚</p>
<h4 id="æ¶ˆæ¯çš„é‡å¤é—®é¢˜"><a href="#æ¶ˆæ¯çš„é‡å¤é—®é¢˜" class="headerlink" title="æ¶ˆæ¯çš„é‡å¤é—®é¢˜"></a>æ¶ˆæ¯çš„é‡å¤é—®é¢˜</h4><p>é€ æˆæ¶ˆæ¯é‡å¤çš„æ ¹æœ¬åŸå› æ˜¯ï¼šç½‘ç»œä¸å¯è¾¾ã€‚</p>
<p>æ‰€ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å°±æ˜¯ç»•è¿‡è¿™ä¸ªé—®é¢˜ã€‚é‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†ï¼šå¦‚æœæ¶ˆè´¹ç«¯æ”¶åˆ°ä¸¤æ¡ä¸€æ ·çš„æ¶ˆæ¯ï¼Œåº”è¯¥æ€æ ·å¤„ç†ï¼Ÿ</p>
<p>æ¶ˆè´¹ç«¯å¤„ç†æ¶ˆæ¯çš„ä¸šåŠ¡é€»è¾‘ä¿æŒå¹‚ç­‰æ€§ã€‚åªè¦ä¿æŒå¹‚ç­‰æ€§ï¼Œä¸ç®¡æ¥å¤šå°‘æ¡é‡å¤æ¶ˆæ¯ï¼Œæœ€åå¤„ç†çš„ç»“æœéƒ½ä¸€æ ·ã€‚<br>ä¿è¯æ¯æ¡æ¶ˆæ¯éƒ½æœ‰å”¯ä¸€ç¼–å·ä¸”ä¿è¯æ¶ˆæ¯å¤„ç†æˆåŠŸä¸å»é‡è¡¨çš„æ—¥å¿—åŒæ—¶å‡ºç°ã€‚åˆ©ç”¨ä¸€å¼ æ—¥å¿—è¡¨æ¥è®°å½•å·²ç»å¤„ç†æˆåŠŸçš„æ¶ˆæ¯çš„ IDï¼Œå¦‚æœæ–°åˆ°çš„æ¶ˆæ¯ ID å·²ç»åœ¨æ—¥å¿—è¡¨ä¸­ï¼Œé‚£ä¹ˆå°±ä¸å†å¤„ç†è¿™æ¡æ¶ˆæ¯ã€‚</p>
<h3 id="Kafka-ActiveMQ-RabbitMQ-RocketMQ-å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"><a href="#Kafka-ActiveMQ-RabbitMQ-RocketMQ-å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="Kafka, ActiveMQ, RabbitMQ, RocketMQ å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"></a>Kafka, ActiveMQ, RabbitMQ, RocketMQ å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h3><div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-c26f4a3048c38af4.jpg"/></div>
## åˆ†å¸ƒå¼æœåŠ¡ï¼ˆRPCï¼‰

<h3 id="Dubbo-çš„å®ç°è¿‡ç¨‹ï¼Ÿ"><a href="#Dubbo-çš„å®ç°è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="Dubbo çš„å®ç°è¿‡ç¨‹ï¼Ÿ"></a>Dubbo çš„å®ç°è¿‡ç¨‹ï¼Ÿ</h3><div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javaweb/distributed/rpc/dubbo/dubboåŸºæœ¬æ¶æ„.png" width="500"/>
</div>

<p>èŠ‚ç‚¹è§’è‰²ï¼š</p>
<table>
<thead>
<tr>
<th>èŠ‚ç‚¹</th>
<th>è§’è‰²è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Provider</td>
<td>æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹</td>
</tr>
<tr>
<td>Consumer</td>
<td>è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹</td>
</tr>
<tr>
<td>Registry</td>
<td>æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ</td>
</tr>
<tr>
<td>Monitor</td>
<td>ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ</td>
</tr>
<tr>
<td>Container</td>
<td>æœåŠ¡è¿è¡Œå®¹å™¨</td>
</tr>
</tbody></table>
<p>è°ƒç”¨å…³ç³»ï¼š</p>
<ol>
<li>åŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li>
<li>æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li>
<li>æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li>
</ol>
<h3 id="Dubbo-è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ"><a href="#Dubbo-è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="Dubbo è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ"></a>Dubbo è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</h3><h5 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h5><ul>
<li>éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚</li>
<li>åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚</li>
</ul>
<h5 id="RoundRobin"><a href="#RoundRobin" class="headerlink" title="RoundRobin"></a>RoundRobin</h5><ul>
<li>è½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚</li>
<li>å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚</li>
</ul>
<h5 id="LeastActive"><a href="#LeastActive" class="headerlink" title="LeastActive"></a>LeastActive</h5><ul>
<li>æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚</li>
<li>ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚</li>
</ul>
<h5 id="ConsistentHash"><a href="#ConsistentHash" class="headerlink" title="ConsistentHash"></a>ConsistentHash</h5><ul>
<li>ä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚</li>
<li>å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚</li>
<li>ç®—æ³•å‚è§ï¼š<a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Consistent_hashing">http://en.wikipedia.org/wiki/Consistent_hashing</a></li>
<li>ç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•° Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <code>&lt;dubbo:parameter key=&quot;hash.arguments&quot; value=&quot;0,1&quot; /&gt;</code></li>
<li>ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <code>&lt;dubbo:parameter key=&quot;hash.nodes&quot; value=&quot;320&quot; /&gt;</code></li>
</ul>
<h3 id="Dubbo-é›†ç¾¤å®¹é”™ç­–ç•¥-ï¼Ÿ"><a href="#Dubbo-é›†ç¾¤å®¹é”™ç­–ç•¥-ï¼Ÿ" class="headerlink" title="Dubbo é›†ç¾¤å®¹é”™ç­–ç•¥ ï¼Ÿ"></a>Dubbo é›†ç¾¤å®¹é”™ç­–ç•¥ ï¼Ÿ</h3><div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javaweb/distributed/rpc/dubbo/dubbo%E9%9B%86%E7%BE%A4%E5%AE%B9%E9%94%99.jpg"/></div>
- **Failover** - å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries="2" æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚
- **Failfast** - å¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚
- **Failsafe** - å¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥å¿½ç•¥ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚
- **Failback** - å¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚
- **Forking** - å¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks="2" æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚
- **Broadcast** - æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚

<h3 id="åŠ¨æ€ä»£ç†ç­–ç•¥ï¼Ÿ"><a href="#åŠ¨æ€ä»£ç†ç­–ç•¥ï¼Ÿ" class="headerlink" title="åŠ¨æ€ä»£ç†ç­–ç•¥ï¼Ÿ"></a>åŠ¨æ€ä»£ç†ç­–ç•¥ï¼Ÿ</h3><p>Dubbo ä½œä¸º RPC æ¡†æ¶ï¼Œé¦–å…ˆè¦å®Œæˆçš„å°±æ˜¯è·¨ç³»ç»Ÿï¼Œè·¨ç½‘ç»œçš„æœåŠ¡è°ƒç”¨ã€‚æ¶ˆè´¹æ–¹ä¸æä¾›æ–¹éµå¾ªç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œæ¶ˆè´¹æ–¹è°ƒç”¨æ¥å£æ—¶ï¼ŒDubbo å°†å…¶è½¬æ¢æˆç»Ÿä¸€æ ¼å¼çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œæä¾›æ–¹æ ¹æ®è§„åˆ™æ‰¾åˆ°æ¥å£å®ç°ï¼Œé€šè¿‡åå°„å®Œæˆè°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¶ˆè´¹æ–¹è·å–çš„æ˜¯å¯¹è¿œç¨‹æœåŠ¡çš„ä¸€ä¸ªä»£ç†(Proxy)ï¼Œè€Œæä¾›æ–¹å› ä¸ºè¦æ”¯æŒä¸åŒçš„æ¥å£å®ç°ï¼Œéœ€è¦ä¸€ä¸ªåŒ…è£…å±‚(Wrapper)ã€‚è°ƒç”¨çš„è¿‡ç¨‹å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<div align="center"><img src="https://oscimg.oschina.net/oscnet/bef19cd5a31b5ae13aff35a8cb4898faaf0.jpg"/></div>
æ¶ˆè´¹æ–¹çš„ Proxy å’Œæä¾›æ–¹çš„ Wrapper å¾—ä»¥è®© Dubbo æ„å»ºå‡ºå¤æ‚ã€ç»Ÿä¸€çš„ä½“ç³»ã€‚è€Œè¿™ç§åŠ¨æ€ä»£ç†ä¸åŒ…è£…ä¹Ÿæ˜¯é€šè¿‡åŸºäº SPI çš„æ’ä»¶æ–¹å¼å®ç°çš„ï¼Œå®ƒçš„æ¥å£å°±æ˜¯**ProxyFactory**ã€‚

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SPI(&quot;javassist&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ProxyFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Adaptive(&#123;Constants.PROXY_KEY&#125;)</span></span><br><span class="line">    &lt;T&gt; T <span class="title function_">getProxy</span><span class="params">(Invoker&lt;T&gt; invoker)</span> <span class="keyword">throws</span> RpcException;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Adaptive(&#123;Constants.PROXY_KEY&#125;)</span></span><br><span class="line">    &lt;T&gt; Invoker&lt;T&gt; <span class="title function_">getInvoker</span><span class="params">(T proxy, Class&lt;T&gt; type, URL url)</span> <span class="keyword">throws</span> RpcException;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ProxyFactory æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäº JDK çš„ä»£ç†å®ç°ï¼Œä¸€ç§æ˜¯åŸºäº javassist çš„å®ç°ã€‚ProxyFactory æ¥å£ä¸Šå®šä¹‰äº†@SPI(â€œjavassistâ€)ï¼Œé»˜è®¤ä¸º javassist çš„å®ç°ã€‚</p>
<h3 id="Dubbo-æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®ï¼ŸHessianï¼ŸHessian-çš„æ•°æ®ç»“æ„ï¼Ÿ"><a href="#Dubbo-æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®ï¼ŸHessianï¼ŸHessian-çš„æ•°æ®ç»“æ„ï¼Ÿ" class="headerlink" title="Dubbo æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®ï¼ŸHessianï¼ŸHessian çš„æ•°æ®ç»“æ„ï¼Ÿ"></a>Dubbo æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®ï¼ŸHessianï¼ŸHessian çš„æ•°æ®ç»“æ„ï¼Ÿ</h3><ol>
<li>dubbo åºåˆ—åŒ–ï¼Œé˜¿é‡Œå°šä¸æˆç†Ÿçš„ java åºåˆ—åŒ–å®ç°ã€‚</li>
<li>hessian2 åºåˆ—åŒ–ï¼šhessian æ˜¯ä¸€ç§è·¨è¯­è¨€çš„é«˜æ•ˆäºŒè¿›åˆ¶çš„åºåˆ—åŒ–æ–¹å¼ï¼Œä½†è¿™é‡Œå®é™…ä¸æ˜¯åŸç”Ÿçš„ hessian2 åºåˆ—åŒ–ï¼Œè€Œæ˜¯é˜¿é‡Œä¿®æ”¹è¿‡çš„ hessian liteï¼Œå®ƒæ˜¯ dubbo RPC é»˜è®¤å¯ç”¨çš„åºåˆ—åŒ–æ–¹å¼ã€‚</li>
<li>json åºåˆ—åŒ–ï¼šç›®å‰æœ‰ä¸¤ç§å®ç°ï¼Œä¸€ç§æ˜¯é‡‡ç”¨çš„é˜¿é‡Œçš„ fastjson åº“ï¼Œå¦ä¸€ç§æ˜¯é‡‡ç”¨ dubbo ä¸­è‡ªå·²å®ç°çš„ç®€å• json åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œjson è¿™ç§æ–‡æœ¬åºåˆ—åŒ–æ€§èƒ½ä¸å¦‚äºŒè¿›åˆ¶åºåˆ—åŒ–ã€‚</li>
<li>java åºåˆ—åŒ–ï¼šä¸»è¦æ˜¯é‡‡ç”¨ JDK è‡ªå¸¦çš„ java åºåˆ—åŒ–å®ç°ï¼Œæ€§èƒ½å¾ˆä¸ç†æƒ³ã€‚</li>
<li>Kryo å’Œ FSTï¼šKryo å’Œ FST çš„æ€§èƒ½ä¾ç„¶æ™®éä¼˜äº hessian å’Œ dubbo åºåˆ—åŒ–ã€‚</li>
</ol>
<p>Hessian åºåˆ—åŒ–ä¸ Java é»˜è®¤çš„åºåˆ—åŒ–åŒºåˆ«ï¼Ÿ</p>
<p>Hessian æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ remoting on http å·¥å…·ï¼Œé‡‡ç”¨çš„æ˜¯ Binary RPC åè®®ï¼Œæ‰€ä»¥å®ƒå¾ˆé€‚åˆäºå‘é€äºŒè¿›åˆ¶æ•°æ®ï¼ŒåŒæ—¶åˆå…·æœ‰é˜²ç«å¢™ç©¿é€èƒ½åŠ›ã€‚</p>
<ol>
<li>Hessian æ”¯æŒè·¨è¯­è¨€ä¸²è¡Œ</li>
<li>æ¯” java åºåˆ—åŒ–å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œæ˜“ç”¨æ€§</li>
<li>æ”¯æŒçš„è¯­è¨€æ¯”è¾ƒå¤š</li>
</ol>
<h3 id="Protoco-Buffer-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Protoco-Buffer-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Protoco Buffer æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Protoco Buffer æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Protocol Buffer æ˜¯ Google å‡ºå“çš„ä¸€ç§è½»é‡ &amp; é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œæ€§èƒ½æ¯” Jsonã€XML çœŸçš„å¼ºï¼å¤ªï¼å¤šï¼</p>
<p>Protocol Buffer çš„åºåˆ—åŒ– &amp; ååºåˆ—åŒ–ç®€å• &amp; é€Ÿåº¦å¿«çš„åŸå› æ˜¯ï¼š</p>
<ol>
<li>ç¼–ç  &#x2F; è§£ç  æ–¹å¼ç®€å•ï¼ˆåªéœ€è¦ç®€å•çš„æ•°å­¦è¿ç®— &#x3D; ä½ç§»ç­‰ç­‰ï¼‰</li>
<li>é‡‡ç”¨ Protocol Buffer è‡ªèº«çš„æ¡†æ¶ä»£ç  å’Œ ç¼–è¯‘å™¨ å…±åŒå®Œæˆ</li>
</ol>
<p>Protocol Buffer çš„æ•°æ®å‹ç¼©æ•ˆæœå¥½ï¼ˆå³åºåˆ—åŒ–åçš„æ•°æ®é‡ä½“ç§¯å°ï¼‰çš„åŸå› æ˜¯ï¼š</p>
<ol>
<li>é‡‡ç”¨äº†ç‹¬ç‰¹çš„ç¼–ç æ–¹å¼ï¼Œå¦‚ Varintã€Zigzag ç¼–ç æ–¹å¼ç­‰ç­‰</li>
<li>é‡‡ç”¨ T - L - V çš„æ•°æ®å­˜å‚¨æ–¹å¼ï¼šå‡å°‘äº†åˆ†éš”ç¬¦çš„ä½¿ç”¨ &amp; æ•°æ®å­˜å‚¨å¾—ç´§å‡‘</li>
</ol>
<h3 id="æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—ï¼Ÿ"><a href="#æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—ï¼Ÿ" class="headerlink" title="æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—ï¼Ÿ"></a>æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—ï¼Ÿ</h3><p>å¯ä»¥ã€‚Dubbo æ¶ˆè´¹è€…åœ¨åº”ç”¨å¯åŠ¨æ—¶ä¼šä»æ³¨å†Œä¸­å¿ƒæ‹‰å–å·²æ³¨å†Œçš„ç”Ÿäº§è€…çš„åœ°å€æ¥å£ï¼Œå¹¶ç¼“å­˜åœ¨æœ¬åœ°ã€‚æ¯æ¬¡è°ƒç”¨æ—¶ï¼ŒæŒ‰ç…§æœ¬åœ°å­˜å‚¨çš„åœ°å€è¿›è¡Œè°ƒç”¨ã€‚</p>
<h3 id="ZooKeeper-åŸç†æ˜¯ä»€ä¹ˆï¼ŸZooKeeper-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#ZooKeeper-åŸç†æ˜¯ä»€ä¹ˆï¼ŸZooKeeper-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="ZooKeeper åŸç†æ˜¯ä»€ä¹ˆï¼ŸZooKeeper æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>ZooKeeper åŸç†æ˜¯ä»€ä¹ˆï¼ŸZooKeeper æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>ZooKeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åº”ç”¨åè°ƒç³»ç»Ÿï¼Œå·²ç»ç”¨åˆ°äº†è®¸å¤šåˆ†å¸ƒå¼é¡¹ç›®ä¸­ï¼Œç”¨æ¥å®Œæˆç»Ÿä¸€å‘½åæœåŠ¡ã€çŠ¶æ€åŒæ­¥æœåŠ¡ã€é›†ç¾¤ç®¡ç†ã€åˆ†å¸ƒå¼åº”ç”¨é…ç½®é¡¹çš„ç®¡ç†ç­‰å·¥ä½œã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javaweb/distributed/rpc/zookeeper/zookeeper-service.png" />
</div>

<ol>
<li>æ¯ä¸ª Server åœ¨å†…å­˜ä¸­å­˜å‚¨äº†ä¸€ä»½æ•°æ®ï¼›</li>
<li>Zookeeper å¯åŠ¨æ—¶ï¼Œå°†ä»å®ä¾‹ä¸­é€‰ä¸¾ä¸€ä¸ª leaderï¼ˆPaxos åè®®ï¼‰ï¼›</li>
<li>Leader è´Ÿè´£å¤„ç†æ•°æ®æ›´æ–°ç­‰æ“ä½œï¼ˆZab åè®®ï¼‰ï¼›</li>
<li>ä¸€ä¸ªæ›´æ–°æ“ä½œæˆåŠŸï¼Œå½“ä¸”ä»…å½“å¤§å¤šæ•° Server åœ¨å†…å­˜ä¸­æˆåŠŸä¿®æ”¹æ•°æ®ã€‚</li>
</ol>
<h3 id="Netty-æœ‰ä»€ä¹ˆç”¨ï¼ŸNIO-x2F-BIO-x2F-AIO-æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#Netty-æœ‰ä»€ä¹ˆç”¨ï¼ŸNIO-x2F-BIO-x2F-AIO-æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="Netty æœ‰ä»€ä¹ˆç”¨ï¼ŸNIO&#x2F;BIO&#x2F;AIO æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>Netty æœ‰ä»€ä¹ˆç”¨ï¼ŸNIO&#x2F;BIO&#x2F;AIO æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>Netty æ˜¯ä¸€ä¸ªâ€œç½‘ç»œé€šè®¯æ¡†æ¶â€ã€‚</p>
<p>Netty è¿›è¡Œäº‹ä»¶å¤„ç†çš„æµç¨‹ã€‚<code>Channel</code>æ˜¯è¿æ¥çš„é€šé“ï¼Œæ˜¯ ChannelEvent çš„äº§ç”Ÿè€…ï¼Œè€Œ<code>ChannelPipeline</code>å¯ä»¥ç†è§£ä¸º ChannelHandler çš„é›†åˆã€‚</p>
<div align="center"><img src="https://camo.githubusercontent.com/5f7331d15c79fba29474c5be6e9e86db465637c3/687474703a2f2f7374617469632e6f736368696e612e6e65742f75706c6f6164732f73706163652f323031332f303932312f3137343033325f313872625f3139303539312e706e67"/></div>
> å‚è€ƒï¼šhttps://github.com/code4craft/netty-learning/blob/master/posts/ch1-overview.md

<p>IO çš„æ–¹å¼é€šå¸¸åˆ†ä¸ºå‡ ç§ï¼š</p>
<ul>
<li>åŒæ­¥é˜»å¡çš„ BIO</li>
<li>åŒæ­¥éé˜»å¡çš„ NIO</li>
<li>å¼‚æ­¥éé˜»å¡çš„ AIO</li>
</ul>
<p>åœ¨ä½¿ç”¨åŒæ­¥ I&#x2F;O çš„ç½‘ç»œåº”ç”¨ä¸­ï¼Œå¦‚æœè¦åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚ï¼Œæˆ–æ˜¯åœ¨å®¢æˆ·ç«¯è¦åŒæ—¶å’Œå¤šä¸ªæœåŠ¡å™¨è¿›è¡Œé€šè®¯ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ã€‚</p>
<p>NIO åŸºäº Reactorï¼Œå½“ socket æœ‰æµå¯è¯»æˆ–å¯å†™å…¥ socket æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç›¸åº”çš„é€šçŸ¥å¼•ç”¨ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œåº”ç”¨å†å°†æµè¯»å–åˆ°ç¼“å†²åŒºæˆ–å†™å…¥æ“ä½œç³»ç»Ÿã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå·²ç»ä¸æ˜¯ä¸€ä¸ªè¿æ¥å°±è¦å¯¹åº”ä¸€ä¸ªå¤„ç†çº¿ç¨‹äº†ï¼Œè€Œæ˜¯æœ‰æ•ˆçš„è¯·æ±‚ï¼Œå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œå½“è¿æ¥æ²¡æœ‰æ•°æ®æ—¶ï¼Œæ˜¯æ²¡æœ‰å·¥ä½œçº¿ç¨‹æ¥å¤„ç†çš„ã€‚</p>
<p>ä¸ NIO ä¸åŒï¼Œå½“è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œåªé¡»ç›´æ¥è°ƒç”¨ API çš„ read æˆ– write æ–¹æ³•å³å¯ã€‚è¿™ä¸¤ç§æ–¹æ³•å‡ä¸ºå¼‚æ­¥çš„ï¼Œå¯¹äºè¯»æ“ä½œè€Œè¨€ï¼Œå½“æœ‰æµå¯è¯»å–æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å¯è¯»çš„æµä¼ å…¥ read æ–¹æ³•çš„ç¼“å†²åŒºï¼Œå¹¶é€šçŸ¥åº”ç”¨ç¨‹åºï¼›å¯¹äºå†™æ“ä½œè€Œè¨€ï¼Œå½“æ“ä½œç³»ç»Ÿå°† write æ–¹æ³•ä¼ é€’çš„æµå†™å…¥å®Œæ¯•æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸»åŠ¨é€šçŸ¥åº”ç”¨ç¨‹åºã€‚ å³å¯ä»¥ç†è§£ä¸ºï¼Œread&#x2F;write æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå®Œæˆåä¼šä¸»åŠ¨è°ƒç”¨å›è°ƒå‡½æ•°ã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/skiof007/article/details/52873421">https://blog.csdn.net/skiof007/article/details/52873421</a></p>
</blockquote>
<h3 id="ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†ï¼Ÿæ‹†åˆ†ä¸ç”¨-Dubbo-å¯ä»¥å—ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†ï¼Ÿæ‹†åˆ†ä¸ç”¨-Dubbo-å¯ä»¥å—ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†ï¼Ÿæ‹†åˆ†ä¸ç”¨ Dubbo å¯ä»¥å—ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†ï¼Ÿæ‹†åˆ†ä¸ç”¨ Dubbo å¯ä»¥å—ï¼Ÿ</h3><p>ç³»ç»Ÿæ‹†åˆ†ä»èµ„æºè§’åº¦åˆ†ä¸ºï¼šåº”ç”¨æ‹†åˆ†å’Œæ•°æ®åº“æ‹†åˆ†ã€‚</p>
<p>ä»é‡‡ç”¨çš„å…ˆåé¡ºåºå¯åˆ†ä¸ºï¼šæ°´å¹³æ‰©å±•ã€å‚ç›´æ‹†åˆ†ã€ä¸šåŠ¡æ‹†åˆ†ã€æ°´å¹³æ‹†åˆ†ã€‚</p>
<div align="center"><img src="http://misc.linkedkeeper.com/misc/img/blog/201804/linkedkeeper0_9c2ed2ed-6156-40f7-ad08-20af067047ca.jpg"/></div>
æ˜¯å¦ä½¿ç”¨æœåŠ¡ä¾æ®å®é™…ä¸šåŠ¡åœºæ™¯æ¥å†³å®šã€‚

<p>å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶(RPC)æ˜¯å…³é”®ã€‚</p>
<p>å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ(SOA)æ˜¯å…³é”®ã€‚</p>
<h3 id="Dubbo-å’Œ-Thrift-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#Dubbo-å’Œ-Thrift-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="Dubbo å’Œ Thrift æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>Dubbo å’Œ Thrift æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ul>
<li>Thrift æ˜¯è·¨è¯­è¨€çš„ RPC æ¡†æ¶ã€‚</li>
<li>Dubbo æ”¯æŒæœåŠ¡æ²»ç†ï¼Œè€Œ Thrift ä¸æ”¯æŒã€‚</li>
</ul>
<h2 id="åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†"><a href="#åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†" class="headerlink" title="åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†"></a>åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†</h2><blockquote>
<p>åˆ†å¸ƒå¼é”æœ‰å‡ ç§å®ç°æ–¹å¼ï¼Ÿå®ç°çš„è¦ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>åˆ†å¸ƒå¼é”å„æ–¹æ¡ˆæœ‰ä»€ä¹ˆåˆ©å¼Šï¼Ÿå¦‚ä½•é€‰æ‹©æ–¹æ¡ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>
<p>Redis åˆ†å¸ƒå¼é”å¦‚ä½•ä¿è¯å¯é‡å…¥æ€§ï¼Ÿ</p>
<p>è¯¦ç»†å†…å®¹è¯·å‚è€ƒï¼š<a href="distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.md">åˆ†å¸ƒå¼é”</a></p>
</blockquote>
<p>ã€ç­”é¢˜æ€è·¯ã€‘</p>
<p>å®ç°æ–¹å¼ä¸€èˆ¬æœ‰ï¼š</p>
<ul>
<li>åŸºäºæ•°æ®åº“å®ç°ï¼š<ul>
<li>å»ºä¸€å¼ è¡¨ï¼ˆt_dlockï¼‰ï¼Œå…³é”®å­—æ®µæœ‰ï¼š<code>id</code>ã€<code>method_name</code>ã€<code>time</code>ã€‚</li>
<li>å‘è¡¨ä¸­æ’å…¥è®°å½•æˆåŠŸï¼Œå³ä¸ºè·å–é”æˆåŠŸã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè·å–é”ä¸€èˆ¬æ˜¯é€šè¿‡è‡ªæ—‹æ–¹å¼ï¼Œå¹¶è®¾ç½®å°è¯•æ¬¡æ•°ï¼Œè¶…è¿‡æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œæ‰åˆ¤å®šè·å–é”å¤±è´¥ã€‚</li>
<li>åˆ é™¤è®°å½•ï¼Œå³ä¸ºé‡Šæ”¾é”ã€‚</li>
<li>å› ä¸ºæ•°æ®åº“æ²¡æœ‰æ·˜æ±°æœºåˆ¶ï¼Œä¸ºäº†é¿å…è·å–é”æ°¸ä¸é‡Šæ”¾ï¼Œåº”ç”¨éœ€è¦è‡ªèº«å®ç°å®šæœŸæ£€æŸ¥ï¼Œåˆ é™¤è¿‡æœŸè®°å½•ï¼ˆæ ¹æ® time åˆ¤æ–­ï¼‰ã€‚</li>
</ul>
</li>
<li>åŸºäº Redis å®ç°<ul>
<li>ç”Ÿæˆä¸€ä¸ªåˆ†å¸ƒå¼ ID ä½œä¸º keyï¼Œé€šè¿‡ <code>setnx</code> å†™å…¥</li>
<li>å†™å…¥æˆåŠŸï¼Œå³ä¸ºè·å–é”æˆåŠŸã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè·å–é”ä¸€èˆ¬æ˜¯é€šè¿‡è‡ªæ—‹æ–¹å¼ï¼Œå¹¶è®¾ç½®å°è¯•æ¬¡æ•°ï¼Œè¶…è¿‡æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œæ‰åˆ¤å®šè·å–é”å¤±è´¥ã€‚</li>
<li>åˆ é™¤ keyï¼Œå³ä¸ºè·å–é”å¤±è´¥ã€‚</li>
<li>Redis è‡ªèº«æœ‰å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Œæ‰€ä»¥åªè¦è®¾ç½® expireï¼Œå°±å¯ä»¥è®© key è‡ªåŠ¨è¿‡æœŸã€‚</li>
</ul>
</li>
<li>åŸºäº ZooKeeper å®ç°<ul>
<li>åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½ Watch æ­¤èŠ‚ç‚¹ã€‚</li>
<li>ä»»æ„èŠ‚ç‚¹çš„ä»»æ„çº¿ç¨‹åªè¦å‘è¿™ä¸ªèŠ‚ç‚¹åˆ›å»ºä¸´æ—¶å­èŠ‚ç‚¹æˆåŠŸï¼Œå³ä¸ºè·å–é”æˆåŠŸã€‚</li>
<li>ç”±äºåˆ›å»ºä¸´æ—¶å­èŠ‚ç‚¹æ˜¯åŸå­æ€§çš„ï¼Œä¸å­˜åœ¨ç«æ€ï¼Œä¸éœ€è¦è‡ªæ—‹å°è¯•ï¼Œæ€§èƒ½å¾ˆå¥½ã€‚</li>
<li>å› ä¸º ZooKeeper åªè¦å’ŒèŠ‚ç‚¹æ–­å¼€ä¼šè¯ï¼Œå°±ä¼šè‡ªåŠ¨åˆ é™¤ä¸´æ—¶èŠ‚ç‚¹ã€‚å³ä¸ºåˆ é™¤é”ã€‚æ‰€ä»¥æ— éœ€è¿‡æœŸæœºåˆ¶ã€‚</li>
</ul>
</li>
</ul>
<p>ä»å®ç°æ–¹å¼å¯ä»¥çœ‹å‡ºï¼Œä¸‰ç§æ–¹æ¡ˆçš„å¯¹æ¯”ï¼š</p>
<ul>
<li>Mysql æ–¹æ¡ˆæ€§èƒ½æœ€å·®ï¼Œå¹¶ä¸”å½±å“ Mysql ååé‡ã€‚è€Œä¸”è¿˜è¦ç¨‹åºä¿è¯å®¹é”™å¤„ç†ã€‚ä¸å»ºè®®é‡‡ç”¨è¿™ç§æ–¹æ¡ˆã€‚</li>
<li>Redis æ–¹æ¡ˆéœ€è¦ä¸æ–­è‡ªæ—‹å°è¯•è·å–é”ï¼Œåº”ç”¨ä¼šæ¶ˆè€—ä¸€äº›æ€§èƒ½å¼€é”€ã€‚è€Œä¸”ä¸ºäº†ä¿è¯åˆ†å¸ƒå¼é”çš„å¯é‡å…¥æ€§ï¼Œéœ€è¦è®¾ç½®å¯¹äºæ‰€æœ‰èŠ‚ç‚¹ã€æ‰€æœ‰çº¿ç¨‹éƒ½å”¯ä¸€çš„åˆ†å¸ƒå¼ IDï¼Œç”Ÿæˆ ID ä¹Ÿéœ€è¦ä¸€å®šçš„ CPU å¼€é”€ã€‚</li>
<li>ZooKeeper æ–¹æ¡ˆå®ç°æœ€ç®€å•ï¼Œæœ€ç¨³å®šã€‚æ˜¯æ¨èçš„æ–¹æ¡ˆã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼šZooKeeper çš„ä¸»ä»æ¶æ„ï¼Œæ‰€æœ‰å†™éƒ½ç”± Master èŠ‚ç‚¹è´Ÿè´£ï¼Œæ‰€ä»¥ ZooKeeper è‡ªèº«æœ‰ä¸€å®šçš„æ€§èƒ½ç“¶é¢ˆã€‚</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/8cbae8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/8cbae8/" class="post-title-link" itemprop="url">å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-09 00:00:00" itemprop="dateCreated datePublished" datetime="2018-07-09T00:00:00+08:00">2018-07-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">è®¾è®¡</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">æ¶æ„</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>5.4k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>5 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯"><a href="#å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯"></a>å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯</h1><blockquote>
<p>å¤§å‹ç³»ç»Ÿçš„è®¾è®¡ç›®æ ‡å°±æ˜¯ä¸ºäº†å¿«é€Ÿã€é«˜æ•ˆã€ç¨³å®šçš„å¤„ç†æµ·é‡çš„æ•°æ®ä»¥åŠé«˜å¹¶å‘çš„è¯·æ±‚ã€‚</p>
<p>å•æœºæœåŠ¡å—é™äºç¡¬ä»¶ï¼Œå®¢è§‚å­˜åœ¨ç€èµ„æºç“¶é¢ˆï¼Œéš¾ä»¥åº”å¯¹ä¸æ–­å¢é•¿çš„æ•°æ®é‡å’Œè¯·æ±‚é‡ï¼Œä¸ºäº†æ‰“ç ´ç“¶é¢ˆï¼Œå¤§å‹ç³»ç»ŸåŸºæœ¬ä¸Šéƒ½è¢«è®¾è®¡ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p>
<p>åˆ†å¸ƒå¼ç³»ç»Ÿç”±äºå…¶é¢ä¸´çš„å…±æ€§é—®é¢˜ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹çš„è§£å†³æ–¹æ¡ˆå¾€å¾€ä¹Ÿå­˜åœ¨ç€å…±æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¾ˆå¤šä¼˜ç§€çš„å¤§å‹ç³»ç»Ÿåœ¨è®¾è®¡æ–¹æ¡ˆä¸Šå­˜åœ¨ç€å¾ˆå¤šçš„å…±åŒç‚¹ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦è®¨è®ºåº”å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿå…±æ€§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™æ—¢å¯ä»¥åŠ æ·±å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿè¿ä½œåŸç†çš„ç†è§£ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè®¾è®¡å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶çš„å€Ÿé‰´ã€‚</p>
</blockquote>
<h2 id="åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="åˆ†å¸ƒå¼äº‹åŠ¡"></a>åˆ†å¸ƒå¼äº‹åŠ¡</h2><blockquote>
<p>å‚è€ƒï¼š<a href="%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86.md#4-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98">åˆ†å¸ƒå¼åŸç†#4-åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</a></p>
</blockquote>
<h2 id="åˆ†å¸ƒå¼é”"><a href="#åˆ†å¸ƒå¼é”" class="headerlink" title="åˆ†å¸ƒå¼é”"></a>åˆ†å¸ƒå¼é”</h2><p>Java åŸç”Ÿ API è™½ç„¶æœ‰å¹¶å‘é”ï¼Œä½†å¹¶æ²¡æœ‰æä¾›åˆ†å¸ƒå¼é”çš„èƒ½åŠ›ï¼Œæ‰€ä»¥é’ˆå¯¹åˆ†å¸ƒå¼åœºæ™¯ä¸­çš„é”éœ€è¦è§£å†³çš„æ–¹æ¡ˆã€‚</p>
<p>åˆ†å¸ƒå¼é”çš„è§£å†³æ–¹æ¡ˆå¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>åŸºäºæ•°æ®åº“å®ç°</li>
<li>åŸºäºç¼“å­˜ï¼ˆredisï¼Œmemcached ç­‰ï¼‰å®ç°</li>
<li>åŸºäº Zookeeper å®ç°</li>
</ul>
<h3 id="åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”"><a href="#åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”"></a>åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”</h3><h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><h5 id="åˆ›å»ºè¡¨"><a href="#åˆ›å»ºè¡¨" class="headerlink" title="åˆ›å»ºè¡¨"></a>åˆ›å»ºè¡¨</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `methodLock` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">  `method_name` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;é”å®šçš„æ–¹æ³•å&#x27;</span>,</span><br><span class="line">  `<span class="keyword">desc</span>` <span class="type">varchar</span>(<span class="number">1024</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;å¤‡æ³¨ä¿¡æ¯&#x27;</span>,</span><br><span class="line">  `update_time` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä¿å­˜æ•°æ®æ—¶é—´ï¼Œè‡ªåŠ¨ç”Ÿæˆ&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uidx_method_name` (`method_name `) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;é”å®šä¸­çš„æ–¹æ³•&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h5 id="è·å–é”"><a href="#è·å–é”" class="headerlink" title="è·å–é”"></a>è·å–é”</h5><p>æƒ³è¦é”ä½æŸä¸ªæ–¹æ³•æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> methodLock(method_name,<span class="keyword">desc</span>) <span class="keyword">values</span> (â€˜method_nameâ€™,â€˜<span class="keyword">desc</span>â€™)</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæˆ‘ä»¬å¯¹ <code>method_name</code> åšäº†å”¯ä¸€æ€§çº¦æŸï¼Œè¿™é‡Œå¦‚æœæœ‰å¤šä¸ªè¯·æ±‚åŒæ—¶æäº¤åˆ°æ•°æ®åº“çš„è¯ï¼Œæ•°æ®åº“ä¼šä¿è¯åªæœ‰ä¸€ä¸ªæ“ä½œå¯ä»¥æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºæ“ä½œæˆåŠŸçš„é‚£ä¸ªçº¿ç¨‹è·å¾—äº†è¯¥æ–¹æ³•çš„é”ï¼Œå¯ä»¥æ‰§è¡Œæ–¹æ³•ä½“å†…å®¹ã€‚</p>
<p>æˆåŠŸæ’å…¥åˆ™è·å–é”ã€‚</p>
<h5 id="é‡Šæ”¾é”"><a href="#é‡Šæ”¾é”" class="headerlink" title="é‡Šæ”¾é”"></a>é‡Šæ”¾é”</h5><p>å½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæƒ³è¦é‡Šæ”¾é”çš„è¯ï¼Œéœ€è¦æ‰§è¡Œä»¥ä¸‹ Sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> methodLock <span class="keyword">where</span> method_name <span class="operator">=</span><span class="string">&#x27;method_name&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><ol>
<li>è¿™æŠŠé”å¼ºä¾èµ–æ•°æ®åº“çš„å¯ç”¨æ€§ã€‚å¦‚æœæ•°æ®åº“æ˜¯ä¸€ä¸ªå•ç‚¹ï¼Œä¸€æ—¦æ•°æ®åº“æŒ‚æ‰ï¼Œä¼šå¯¼è‡´ä¸šåŠ¡ç³»ç»Ÿä¸å¯ç”¨ã€‚</li>
<li>è¿™æŠŠé”æ²¡æœ‰å¤±æ•ˆæ—¶é—´ï¼Œä¸€æ—¦è§£é”æ“ä½œå¤±è´¥ï¼Œå°±ä¼šå¯¼è‡´é”è®°å½•ä¸€ç›´åœ¨æ•°æ®åº“ä¸­ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•å†è·å¾—åˆ°é”ã€‚</li>
<li>è¿™æŠŠé”åªèƒ½æ˜¯éé˜»å¡çš„ï¼Œå› ä¸ºæ•°æ®çš„ insert æ“ä½œï¼Œä¸€æ—¦æ’å…¥å¤±è´¥å°±ä¼šç›´æ¥æŠ¥é”™ã€‚æ²¡æœ‰è·å¾—é”çš„çº¿ç¨‹å¹¶ä¸ä¼šè¿›å…¥æ’é˜Ÿé˜Ÿåˆ—ï¼Œè¦æƒ³å†æ¬¡è·å¾—é”å°±è¦å†æ¬¡è§¦å‘è·å¾—é”æ“ä½œã€‚</li>
<li>è¿™æŠŠé”æ˜¯éé‡å…¥çš„ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰é‡Šæ”¾é”ä¹‹å‰æ— æ³•å†æ¬¡è·å¾—è¯¥é”ã€‚å› ä¸ºæ•°æ®ä¸­æ•°æ®å·²ç»å­˜åœ¨äº†ã€‚</li>
</ol>
<h4 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h4><ol>
<li>å•ç‚¹é—®é¢˜å¯ä»¥ç”¨å¤šæ•°æ®åº“å®ä¾‹ï¼ŒåŒæ—¶å¡ N ä¸ªè¡¨ï¼ŒN&#x2F;2+1 ä¸ªæˆåŠŸå°±ä»»åŠ¡é”å®šæˆåŠŸ</li>
<li>å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œéš”ä¸€æ®µæ—¶é—´æ¸…é™¤ä¸€æ¬¡è¿‡æœŸçš„æ•°æ®ã€‚</li>
<li>å†™ä¸€ä¸ª while å¾ªç¯ï¼Œä¸æ–­çš„é‡è¯•æ’å…¥ï¼Œç›´åˆ°æˆåŠŸã€‚</li>
<li>åœ¨æ•°æ®åº“è¡¨ä¸­åŠ ä¸ªå­—æ®µï¼Œè®°å½•å½“å‰è·å¾—é”çš„æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸‹æ¬¡å†è·å–é”çš„æ—¶å€™å…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚æœå½“å‰æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯åœ¨æ•°æ®åº“å¯ä»¥æŸ¥åˆ°çš„è¯ï¼Œç›´æ¥æŠŠé”åˆ†é…ç»™ä»–å°±å¯ä»¥äº†ã€‚</li>
</ol>
<h4 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><ul>
<li>ä¼˜ç‚¹: ç›´æ¥å€ŸåŠ©æ•°æ®åº“ï¼Œå®¹æ˜“ç†è§£ã€‚</li>
<li>ç¼ºç‚¹: ä¼šæœ‰å„ç§å„æ ·çš„é—®é¢˜ï¼Œåœ¨è§£å†³é—®é¢˜çš„è¿‡ç¨‹ä¸­ä¼šä½¿æ•´ä¸ªæ–¹æ¡ˆå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚æ“ä½œæ•°æ®åº“éœ€è¦ä¸€å®šçš„å¼€é”€ï¼Œæ€§èƒ½é—®é¢˜éœ€è¦è€ƒè™‘ã€‚</li>
</ul>
<h3 id="åŸºäº-Redis-å®ç°åˆ†å¸ƒå¼é”"><a href="#åŸºäº-Redis-å®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº Redis å®ç°åˆ†å¸ƒå¼é”"></a>åŸºäº Redis å®ç°åˆ†å¸ƒå¼é”</h3><p>ç›¸æ¯”äºç”¨æ•°æ®åº“æ¥å®ç°åˆ†å¸ƒå¼é”ï¼ŒåŸºäºç¼“å­˜å®ç°çš„åˆ†å¸ƒå¼é”çš„æ€§èƒ½ä¼šæ›´å¥½ä¸€äº›ã€‚ç›®å‰æœ‰å¾ˆå¤šæˆç†Ÿçš„åˆ†å¸ƒå¼äº§å“ï¼ŒåŒ…æ‹¬ Redisã€memcacheã€Tair ç­‰ã€‚è¿™é‡Œä»¥ Redis ä¸¾ä¾‹ã€‚</p>
<h4 id="Redis-å‘½ä»¤"><a href="#Redis-å‘½ä»¤" class="headerlink" title="Redis å‘½ä»¤"></a>Redis å‘½ä»¤</h4><ul>
<li>setnx - setnx key valï¼šå½“ä¸”ä»…å½“ key ä¸å­˜åœ¨æ—¶ï¼Œset ä¸€ä¸ª key ä¸º val çš„å­—ç¬¦ä¸²ï¼Œè¿”å› 1ï¼›è‹¥ key å­˜åœ¨ï¼Œåˆ™ä»€ä¹ˆéƒ½ä¸åšï¼Œè¿”å› 0ã€‚</li>
<li>expire - expire key timeoutï¼šä¸º key è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸º secondï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´é”ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œé¿å…æ­»é”ã€‚</li>
<li>delete - delete keyï¼šåˆ é™¤ key</li>
</ul>
<h4 id="å®ç°-1"><a href="#å®ç°-1" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>å•ç‚¹å®ç°æ­¥éª¤ï¼š</p>
<ol>
<li>è·å–é”çš„ä½¿ç”¨ï¼Œä½¿ç”¨ setnx åŠ é”ï¼Œé”çš„ value å€¼ä¸ºä¸€ä¸ªéšæœºç”Ÿæˆçš„ UUIDï¼Œå†ä½¿ç”¨ expire è®¾ç½®ä¸€ä¸ªè¿‡æœŸå€¼ã€‚</li>
<li>è·å–é”çš„æ—¶å€™è¿˜è®¾ç½®ä¸€ä¸ªè·å–çš„è¶…æ—¶æ—¶é—´ï¼Œè‹¥è¶…è¿‡è¿™ä¸ªæ—¶é—´åˆ™æ”¾å¼ƒè·å–é”ã€‚</li>
<li>é‡Šæ”¾é”çš„æ—¶å€™ï¼Œé€šè¿‡ UUID åˆ¤æ–­æ˜¯ä¸æ˜¯è¯¥é”ï¼Œè‹¥æ˜¯è¯¥é”ï¼Œåˆ™æ‰§è¡Œ delete è¿›è¡Œé”é‡Šæ”¾ã€‚</li>
</ol>
<h4 id="é—®é¢˜-1"><a href="#é—®é¢˜-1" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><ul>
<li>å•ç‚¹é—®é¢˜ã€‚å¦‚æœå•æœº redis æŒ‚æ‰äº†ï¼Œé‚£ä¹ˆç¨‹åºä¼šè·Ÿç€å‡ºé”™ã€‚</li>
<li>å¦‚æœè½¬ç§»ä½¿ç”¨ slave èŠ‚ç‚¹ï¼Œå¤åˆ¶ä¸æ˜¯åŒæ­¥å¤åˆ¶ï¼Œä¼šå‡ºç°å¤šä¸ªç¨‹åºè·å–é”çš„æƒ…å†µ</li>
</ul>
<h4 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><p>å¯ä»¥è€ƒè™‘ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8">redisson çš„è§£å†³æ–¹æ¡ˆ</a>ã€‚</p>
<h3 id="åŸºäº-ZooKeeper-å®ç°åˆ†å¸ƒå¼é”"><a href="#åŸºäº-ZooKeeper-å®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº ZooKeeper å®ç°åˆ†å¸ƒå¼é”"></a>åŸºäº ZooKeeper å®ç°åˆ†å¸ƒå¼é”</h3><h4 id="å®ç°-2"><a href="#å®ç°-2" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>è¿™ä¹Ÿæ˜¯ ZooKeeper å®¢æˆ·ç«¯ curator çš„åˆ†å¸ƒå¼é”å®ç°ã€‚</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç›®å½• mylockï¼›</li>
<li>çº¿ç¨‹ A æƒ³è·å–é”å°±åœ¨ mylock ç›®å½•ä¸‹åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼›</li>
<li>è·å– mylock ç›®å½•ä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œç„¶åè·å–æ¯”è‡ªå·±å°çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹é¡ºåºå·æœ€å°ï¼Œè·å¾—é”ï¼›</li>
<li>çº¿ç¨‹ B è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ¤æ–­è‡ªå·±ä¸æ˜¯æœ€å°èŠ‚ç‚¹ï¼Œè®¾ç½®ç›‘å¬æ¯”è‡ªå·±æ¬¡å°çš„èŠ‚ç‚¹ï¼›</li>
<li>çº¿ç¨‹ A å¤„ç†å®Œï¼Œåˆ é™¤è‡ªå·±çš„èŠ‚ç‚¹ï¼Œçº¿ç¨‹ B ç›‘å¬åˆ°å˜æ›´äº‹ä»¶ï¼Œåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åˆ™è·å¾—é”ã€‚</li>
</ol>
<h4 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><p>ZooKeeper ç‰ˆæœ¬çš„åˆ†å¸ƒå¼é”é—®é¢˜ç›¸å¯¹æ¯”è¾ƒæ¥è¯´å°‘ã€‚</p>
<ul>
<li>é”çš„å ç”¨æ—¶é—´é™åˆ¶ï¼šredis å°±æœ‰å ç”¨æ—¶é—´é™åˆ¶ï¼Œè€Œ ZooKeeper åˆ™æ²¡æœ‰ï¼Œæœ€ä¸»è¦çš„åŸå› æ˜¯ redis ç›®å‰æ²¡æœ‰åŠæ³•çŸ¥é“å·²ç»è·å–é”çš„å®¢æˆ·ç«¯çš„çŠ¶æ€ï¼Œæ˜¯å·²ç»æŒ‚äº†å‘¢è¿˜æ˜¯æ­£åœ¨æ‰§è¡Œè€—æ—¶è¾ƒé•¿çš„ä¸šåŠ¡é€»è¾‘ã€‚è€Œ ZooKeeper é€šè¿‡ä¸´æ—¶èŠ‚ç‚¹å°±èƒ½æ¸…æ™°çŸ¥é“ï¼Œå¦‚æœä¸´æ—¶èŠ‚ç‚¹å­˜åœ¨è¯´æ˜è¿˜åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æœä¸´æ—¶èŠ‚ç‚¹ä¸å­˜åœ¨è¯´æ˜å·²ç»æ‰§è¡Œå®Œæ¯•é‡Šæ”¾é”æˆ–è€…æ˜¯æŒ‚äº†ã€‚ç”±æ­¤çœ‹æ¥ redis å¦‚æœèƒ½åƒ ZooKeeper ä¸€æ ·æ·»åŠ ä¸€äº›ä¸å®¢æˆ·ç«¯ç»‘å®šçš„ä¸´æ—¶é”®ï¼Œä¹Ÿæ˜¯ä¸€å¤§å¥½äº‹ã€‚</li>
<li>æ˜¯å¦å•ç‚¹æ•…éšœï¼šredis æœ¬èº«æœ‰å¾ˆå¤šä¸­ç©æ³•ï¼Œå¦‚å®¢æˆ·ç«¯ä¸€è‡´æ€§ hashï¼ŒæœåŠ¡å™¨ç«¯ sentinel æ–¹æ¡ˆæˆ–è€… cluster æ–¹æ¡ˆï¼Œå¾ˆéš¾åšåˆ°ä¸€ç§åˆ†å¸ƒå¼é”æ–¹å¼èƒ½åº”å¯¹æ‰€æœ‰è¿™äº›æ–¹æ¡ˆã€‚è€Œ ZooKeeper åªæœ‰ä¸€ç§ç©æ³•ï¼Œå¤šå°æœºå™¨çš„èŠ‚ç‚¹æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Œæ²¡æœ‰ redis çš„é‚£ä¹ˆå¤šçš„éº»çƒ¦å› ç´ è¦è€ƒè™‘ã€‚</li>
</ul>
<p>æ€»ä½“ä¸Šæ¥è¯´ ZooKeeper å®ç°åˆ†å¸ƒå¼é”æ›´åŠ çš„ç®€å•ï¼Œå¯é æ€§æ›´é«˜ã€‚ä½† ZooKeeper å› ä¸ºéœ€è¦é¢‘ç¹çš„åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ€§èƒ½ä¸Šä¸å¦‚ Redis æ–¹å¼ã€‚</p>
<h2 id="åˆ†å¸ƒå¼-Session"><a href="#åˆ†å¸ƒå¼-Session" class="headerlink" title="åˆ†å¸ƒå¼ Session"></a>åˆ†å¸ƒå¼ Session</h2><p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªç”¨æˆ·çš„ Session å¦‚æœåªå­˜å‚¨åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆå½“è´Ÿè½½å‡è¡¡å™¨æŠŠç”¨æˆ·çš„ä¸‹ä¸€ä¸ªè¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¯¥æœåŠ¡å™¨æ²¡æœ‰ç”¨æˆ·çš„ Sessionï¼Œå°±å¯èƒ½å¯¼è‡´ç”¨æˆ·éœ€è¦é‡æ–°è¿›è¡Œç™»å½•ç­‰æ“ä½œã€‚</p>
<p>åˆ†å¸ƒå¼ Session çš„å‡ ç§å®ç°ç­–ç•¥ï¼š</p>
<ol>
<li>ç²˜æ€§ session</li>
<li>åº”ç”¨æœåŠ¡å™¨é—´çš„ session å¤åˆ¶å…±äº«</li>
<li>åŸºäº cache DB ç¼“å­˜çš„ session å…±äº«</li>
</ol>
<h3 id="Sticky-Sessions"><a href="#Sticky-Sessions" class="headerlink" title="Sticky Sessions"></a>Sticky Sessions</h3><p>éœ€è¦é…ç½®è´Ÿè½½å‡è¡¡å™¨ï¼Œä½¿å¾—ä¸€ä¸ªç”¨æˆ·çš„æ‰€æœ‰è¯·æ±‚éƒ½è·¯ç”±åˆ°ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥æŠŠç”¨æˆ·çš„ Session å­˜æ”¾åœ¨è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸­ã€‚</p>
<p>ç¼ºç‚¹ï¼šå½“æœåŠ¡å™¨èŠ‚ç‚¹å®•æœºæ—¶ï¼Œå°†ä¸¢å¤±è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰ Sessionã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/MultiNode-StickySessions.jpg" />
</div>

<h3 id="Session-Replication"><a href="#Session-Replication" class="headerlink" title="Session Replication"></a>Session Replication</h3><p>åœ¨æœåŠ¡å™¨èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œ Session åŒæ­¥æ“ä½œï¼Œè¿™æ ·çš„è¯ç”¨æˆ·å¯ä»¥è®¿é—®ä»»ä½•ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ã€‚</p>
<p>ç¼ºç‚¹ï¼šå ç”¨è¿‡å¤šå†…å­˜ï¼›åŒæ­¥è¿‡ç¨‹å ç”¨ç½‘ç»œå¸¦å®½ä»¥åŠæœåŠ¡å™¨å¤„ç†å™¨æ—¶é—´ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/MultiNode-SessionReplication.jpg" />
</div>

<h3 id="Session-Server"><a href="#Session-Server" class="headerlink" title="Session Server"></a>Session Server</h3><p>ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„æœåŠ¡å™¨å­˜å‚¨ Session æ•°æ®ï¼Œå¯ä»¥å­˜åœ¨ MySQL æ•°æ®åº“ä¸Šï¼Œä¹Ÿå¯ä»¥å­˜åœ¨ Redis æˆ–è€… Memcached è¿™ç§å†…å­˜å‹æ•°æ®åº“ã€‚</p>
<p>ç¼ºç‚¹ï¼šéœ€è¦å»å®ç°å­˜å– Session çš„ä»£ç ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/MultiNode-SpringSession.jpg" />
</div>

<h2 id="åˆ†å¸ƒå¼å­˜å‚¨"><a href="#åˆ†å¸ƒå¼å­˜å‚¨" class="headerlink" title="åˆ†å¸ƒå¼å­˜å‚¨"></a>åˆ†å¸ƒå¼å­˜å‚¨</h2><p>é€šå¸¸æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>æ•°æ®åˆ†å¸ƒï¼šå°±æ˜¯æŠŠæ•°æ®åˆ†å—å­˜åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼ˆåˆ†åº“åˆ†è¡¨ï¼‰ã€‚</li>
<li>æ•°æ®å¤åˆ¶ï¼šè®©æ‰€æœ‰çš„æœåŠ¡å™¨éƒ½æœ‰ç›¸åŒçš„æ•°æ®ï¼Œæä¾›ç›¸å½“çš„æœåŠ¡ã€‚</li>
</ol>
<blockquote>
<p>å‚è€ƒï¼š<a href="%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86.md#2-%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83">åˆ†å¸ƒå¼åŸç†.md#2-æ•°æ®åˆ†å¸ƒ</a></p>
</blockquote>
<h2 id="åˆ†å¸ƒå¼ç¼“å­˜"><a href="#åˆ†å¸ƒå¼ç¼“å­˜" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜"></a>åˆ†å¸ƒå¼ç¼“å­˜</h2><p>ä½¿ç”¨ç¼“å­˜çš„å¥½å¤„ï¼š</p>
<ul>
<li>æå‡æ•°æ®è¯»å–é€Ÿåº¦</li>
<li>æå‡ç³»ç»Ÿæ‰©å±•èƒ½åŠ›ï¼Œé€šè¿‡æ‰©å±•ç¼“å­˜ï¼Œæå‡ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›</li>
<li>é™ä½å­˜å‚¨æˆæœ¬ï¼ŒCache+DB çš„æ–¹å¼å¯ä»¥æ‰¿æ‹…åŸæœ‰éœ€è¦å¤šå° DB æ‰èƒ½æ‰¿æ‹…çš„è¯·æ±‚é‡ï¼ŒèŠ‚çœæœºå™¨æˆæœ¬</li>
</ul>
<p>æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼Œé€šå¸¸ç¼“å­˜æœ‰ä»¥ä¸‹å‡ ç§ä½¿ç”¨æ–¹å¼</p>
<ul>
<li>æ‡’æ±‰å¼(è¯»æ—¶è§¦å‘)ï¼šå†™å…¥ DB å, ç„¶åæŠŠç›¸å…³çš„æ•°æ®ä¹Ÿå†™å…¥ Cache</li>
<li>é¥¥é¥¿å¼(å†™æ—¶è§¦å‘)ï¼šå…ˆæŸ¥è¯¢ DB é‡Œçš„æ•°æ®, ç„¶åæŠŠç›¸å…³çš„æ•°æ®å†™å…¥ Cache</li>
<li>å®šæœŸåˆ·æ–°ï¼šé€‚åˆå‘¨æœŸæ€§çš„è·‘æ•°æ®çš„ä»»åŠ¡ï¼Œæˆ–è€…åˆ—è¡¨å‹çš„æ•°æ®ï¼Œè€Œä¸”ä¸è¦æ±‚ç»å¯¹å®æ—¶æ€§</li>
</ul>
<p>ç¼“å­˜åˆ†ç±»ï¼š</p>
<ul>
<li>åº”ç”¨å†…ç¼“å­˜ï¼šå¦‚ï¼šEHCache</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜ï¼šå¦‚ï¼šMemachedã€Redis</li>
</ul>
<blockquote>
<p>å‚è€ƒï¼š<a href="%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86.md#6-%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98">åˆ†å¸ƒå¼åŸç†.md#6-åˆ†å¸ƒå¼ç¼“å­˜é—®é¢˜</a></p>
</blockquote>
<h2 id="åˆ†å¸ƒå¼è®¡ç®—"><a href="#åˆ†å¸ƒå¼è®¡ç®—" class="headerlink" title="åˆ†å¸ƒå¼è®¡ç®—"></a>åˆ†å¸ƒå¼è®¡ç®—</h2><h2 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h2><h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><h4 id="è½®è¯¢ï¼ˆRound-Robinï¼‰"><a href="#è½®è¯¢ï¼ˆRound-Robinï¼‰" class="headerlink" title="è½®è¯¢ï¼ˆRound Robinï¼‰"></a>è½®è¯¢ï¼ˆRound Robinï¼‰</h4><p>è½®è¯¢ç®—æ³•æŠŠæ¯ä¸ªè¯·æ±‚è½®æµå‘é€åˆ°æ¯ä¸ªæœåŠ¡å™¨ä¸Šã€‚ä¸‹å›¾ä¸­ï¼Œä¸€å…±æœ‰ 6 ä¸ªå®¢æˆ·ç«¯äº§ç”Ÿäº† 6 ä¸ªè¯·æ±‚ï¼Œè¿™ 6 ä¸ªè¯·æ±‚æŒ‰ (1, 2, 3, 4, 5, 6) çš„é¡ºåºå‘é€ã€‚æœ€åï¼Œ(1, 3, 5) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(2, 4, 6) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹è½®è¯¢-01.jpg" width="640"/>
</div>

<p>è¯¥ç®—æ³•æ¯”è¾ƒé€‚åˆæ¯ä¸ªæœåŠ¡å™¨çš„æ€§èƒ½å·®ä¸å¤šçš„åœºæ™¯ï¼Œå¦‚æœæœ‰æ€§èƒ½å­˜åœ¨å·®å¼‚çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆæ€§èƒ½è¾ƒå·®çš„æœåŠ¡å™¨å¯èƒ½æ— æ³•æ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ï¼ˆä¸‹å›¾çš„ Server 2ï¼‰ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹è½®è¯¢-02.jpg" width="640"/>
</div>

<h4 id="åŠ æƒè½®è¯¢ï¼ˆWeighted-Round-Robbinï¼‰"><a href="#åŠ æƒè½®è¯¢ï¼ˆWeighted-Round-Robbinï¼‰" class="headerlink" title="åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robbinï¼‰"></a>åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robbinï¼‰</h4><p>åŠ æƒè½®è¯¢æ˜¯åœ¨è½®è¯¢çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½å·®å¼‚ï¼Œä¸ºæœåŠ¡å™¨èµ‹äºˆä¸€å®šçš„æƒå€¼ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 è¢«èµ‹äºˆçš„æƒå€¼ä¸º 5ï¼ŒæœåŠ¡å™¨ 2 è¢«èµ‹äºˆçš„æƒå€¼ä¸º 1ï¼Œé‚£ä¹ˆ (1, 2, 3, 4, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(6) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹åŠ æƒè½®è¯¢.jpg" width="640"/>
</div>

<h4 id="æœ€å°‘è¿æ¥ï¼ˆleast-Connectionsï¼‰"><a href="#æœ€å°‘è¿æ¥ï¼ˆleast-Connectionsï¼‰" class="headerlink" title="æœ€å°‘è¿æ¥ï¼ˆleast Connectionsï¼‰"></a>æœ€å°‘è¿æ¥ï¼ˆleast Connectionsï¼‰</h4><p>ç”±äºæ¯ä¸ªè¯·æ±‚çš„è¿æ¥æ—¶é—´ä¸ä¸€æ ·ï¼Œä½¿ç”¨è½®è¯¢æˆ–è€…åŠ æƒè½®è¯¢ç®—æ³•çš„è¯ï¼Œå¯èƒ½ä¼šè®©ä¸€å°æœåŠ¡å™¨å½“å‰è¿æ¥æ•°è¿‡å¤§ï¼Œè€Œå¦ä¸€å°æœåŠ¡å™¨çš„è¿æ¥è¿‡å°ï¼Œé€ æˆè´Ÿè½½ä¸å‡è¡¡ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼Œ(1, 3, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œä½†æ˜¯ (1, 3) å¾ˆå¿«å°±æ–­å¼€è¿æ¥ï¼Œæ­¤æ—¶åªæœ‰ (5) è¯·æ±‚è¿æ¥æœåŠ¡å™¨ 1ï¼›(2, 4, 6) è¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ 2ï¼Œåªæœ‰ (2) çš„è¿æ¥æ–­å¼€ã€‚è¯¥ç³»ç»Ÿç»§ç»­è¿è¡Œæ—¶ï¼ŒæœåŠ¡å™¨ 2 ä¼šæ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹æœ€å°‘è¿æ¥-01.jpg" width="640"/>
</div>

<p>æœ€å°‘è¿æ¥ç®—æ³•å°±æ˜¯å°†è¯·æ±‚å‘é€ç»™å½“å‰æœ€å°‘è¿æ¥æ•°çš„æœåŠ¡å™¨ä¸Šã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 å½“å‰è¿æ¥æ•°æœ€å°ï¼Œé‚£ä¹ˆæ–°åˆ°æ¥çš„è¯·æ±‚ 6 å°±ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1 ä¸Šã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹æœ€å°‘è¿æ¥-02.jpg" width="640"/>
</div>

<h4 id="åŠ æƒæœ€å°‘è¿æ¥ï¼ˆWeighted-Least-Connectionï¼‰"><a href="#åŠ æƒæœ€å°‘è¿æ¥ï¼ˆWeighted-Least-Connectionï¼‰" class="headerlink" title="åŠ æƒæœ€å°‘è¿æ¥ï¼ˆWeighted Least Connectionï¼‰"></a>åŠ æƒæœ€å°‘è¿æ¥ï¼ˆWeighted Least Connectionï¼‰</h4><p>åœ¨æœ€å°‘è¿æ¥çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½ä¸ºæ¯å°æœåŠ¡å™¨åˆ†é…æƒé‡ï¼Œå†æ ¹æ®æƒé‡è®¡ç®—å‡ºæ¯å°æœåŠ¡å™¨èƒ½å¤„ç†çš„è¿æ¥æ•°ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹åŠ æƒæœ€å°‘è¿æ¥.jpg" width="640"/>
</div>

<h4 id="éšæœºç®—æ³•ï¼ˆRandomï¼‰"><a href="#éšæœºç®—æ³•ï¼ˆRandomï¼‰" class="headerlink" title="éšæœºç®—æ³•ï¼ˆRandomï¼‰"></a>éšæœºç®—æ³•ï¼ˆRandomï¼‰</h4><p>æŠŠè¯·æ±‚éšæœºå‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚å’Œè½®è¯¢ç®—æ³•ç±»ä¼¼ï¼Œè¯¥ç®—æ³•æ¯”è¾ƒé€‚åˆæœåŠ¡å™¨æ€§èƒ½å·®ä¸å¤šçš„åœºæ™¯ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹éšæœº.jpg" width="640"/>
</div>

<h4 id="æºåœ°å€å“ˆå¸Œæ³•-IP-Hash"><a href="#æºåœ°å€å“ˆå¸Œæ³•-IP-Hash" class="headerlink" title="æºåœ°å€å“ˆå¸Œæ³• (IP Hash)"></a>æºåœ°å€å“ˆå¸Œæ³• (IP Hash)</h4><p>æºåœ°å€å“ˆå¸Œé€šè¿‡å¯¹å®¢æˆ·ç«¯ IP å“ˆå¸Œè®¡ç®—å¾—åˆ°çš„ä¸€ä¸ªæ•°å€¼ï¼Œç”¨è¯¥æ•°å€¼å¯¹æœåŠ¡å™¨æ•°é‡è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œå–æ¨¡ç»“æœä¾¿æ˜¯ç›®æ ‡æœåŠ¡å™¨çš„åºå·ã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šä¿è¯åŒä¸€ IP çš„å®¢æˆ·ç«¯éƒ½ä¼šè¢« hash åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šã€‚</li>
<li>ç¼ºç‚¹ï¼šä¸åˆ©äºé›†ç¾¤æ‰©å±•ï¼Œåå°æœåŠ¡å™¨æ•°é‡å˜æ›´éƒ½ä¼šå½±å“ hash ç»“æœã€‚å¯ä»¥é‡‡ç”¨ä¸€è‡´æ€§ Hash æ”¹è¿›ã€‚</li>
</ul>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹IpHash.jpg" width="640"/>
</div>

<h3 id="å®ç°-3"><a href="#å®ç°-3" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="HTTP-é‡å®šå‘"><a href="#HTTP-é‡å®šå‘" class="headerlink" title="HTTP é‡å®šå‘"></a>HTTP é‡å®šå‘</h4><p>HTTP é‡å®šå‘è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ”¶åˆ° HTTP è¯·æ±‚ä¹‹åä¼šè¿”å›æœåŠ¡å™¨çš„åœ°å€ï¼Œå¹¶å°†è¯¥åœ°å€å†™å…¥ HTTP é‡å®šå‘å“åº”ä¸­è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ”¶åˆ°åéœ€è¦å†æ¬¡å‘é€è¯·æ±‚ã€‚</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç”¨æˆ·è®¿é—®çš„å»¶è¿Ÿä¼šå¢åŠ ï¼›</li>
<li>å¦‚æœè´Ÿè½½å‡è¡¡å™¨å®•æœºï¼Œå°±æ— æ³•è®¿é—®è¯¥ç«™ç‚¹ã€‚</li>
</ul>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/Httpé‡å®šå‘.png" width="640"/>
</div>

<h4 id="DNS-é‡å®šå‘"><a href="#DNS-é‡å®šå‘" class="headerlink" title="DNS é‡å®šå‘"></a>DNS é‡å®šå‘</h4><p>ä½¿ç”¨ DNS ä½œä¸ºè´Ÿè½½å‡è¡¡å™¨ï¼Œæ ¹æ®è´Ÿè½½æƒ…å†µè¿”å›ä¸åŒæœåŠ¡å™¨çš„ IP åœ°å€ã€‚å¤§å‹ç½‘ç«™åŸºæœ¬ä½¿ç”¨äº†è¿™ç§æ–¹å¼åšä¸ºç¬¬ä¸€çº§è´Ÿè½½å‡è¡¡æ‰‹æ®µï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨å…¶å®ƒæ–¹å¼åšç¬¬äºŒçº§è´Ÿè½½å‡è¡¡ã€‚</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>DNS æŸ¥æ‰¾è¡¨å¯èƒ½ä¼šè¢«å®¢æˆ·ç«¯ç¼“å­˜èµ·æ¥ï¼Œé‚£ä¹ˆä¹‹åçš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«é‡å®šå‘åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ã€‚</li>
</ul>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/Dnsé‡å®šå‘.png" width="640"/>
</div>

<h4 id="ä¿®æ”¹-MAC-åœ°å€"><a href="#ä¿®æ”¹-MAC-åœ°å€" class="headerlink" title="ä¿®æ”¹ MAC åœ°å€"></a>ä¿®æ”¹ MAC åœ°å€</h4><p>ä½¿ç”¨ LVSï¼ˆLinux Virtual Serverï¼‰è¿™ç§é“¾è·¯å±‚è´Ÿè½½å‡è¡¡å™¨ï¼Œæ ¹æ®è´Ÿè½½æƒ…å†µä¿®æ”¹è¯·æ±‚çš„ MAC åœ°å€ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/ä¿®æ”¹Macåœ°å€.png" width="640"/>
</div>

<h4 id="ä¿®æ”¹-IP-åœ°å€"><a href="#ä¿®æ”¹-IP-åœ°å€" class="headerlink" title="ä¿®æ”¹ IP åœ°å€"></a>ä¿®æ”¹ IP åœ°å€</h4><p>åœ¨ç½‘ç»œå±‚ä¿®æ”¹è¯·æ±‚çš„ç›®çš„ IP åœ°å€ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/ä¿®æ”¹IPåœ°å€.png" width="640"/>
</div>

<h4 id="ä»£ç†è‡ªåŠ¨é…ç½®"><a href="#ä»£ç†è‡ªåŠ¨é…ç½®" class="headerlink" title="ä»£ç†è‡ªåŠ¨é…ç½®"></a>ä»£ç†è‡ªåŠ¨é…ç½®</h4><p>æ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„åŒºåˆ«ï¼š</p>
<ul>
<li>æ­£å‘ä»£ç†ï¼šå‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼Œæ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å‘èµ·çš„ã€‚æ¯”å¦‚ç¿»å¢™ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸»åŠ¨è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œè®©ä»£ç†æœåŠ¡å™¨è·å¾—éœ€è¦çš„å¤–ç½‘æ•°æ®ï¼Œç„¶åè½¬å‘å›å®¢æˆ·ç«¯ã€‚</li>
<li>åå‘ä»£ç†ï¼šå‘ç”Ÿåœ¨æœåŠ¡å™¨ç«¯ï¼Œç”¨æˆ·ä¸çŸ¥é“ä»£ç†çš„å­˜åœ¨ã€‚</li>
</ul>
<p>PAC æœåŠ¡å™¨æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªè¯·æ±‚æ˜¯å¦è¦ç»è¿‡ä»£ç†ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/ä»£ç†è‡ªåŠ¨é…ç½®.jpg" width="640"/>
</div>

<h2 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html">https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CyC2018/Interview-Notebook/blob/master/notes/%E5%88%86%E5%B8%83%E5%BC%8F%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90.md">https://github.com/CyC2018/Interview-Notebook/blob/master/notes/%E5%88%86%E5%B8%83%E5%BC%8F%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90.md</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/453c6e7ff81c">https://www.jianshu.com/p/453c6e7ff81c</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/5a20cd8bf265da43163cdd9a">https://juejin.im/post/5a20cd8bf265da43163cdd9a</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8">https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/L316476844/distributed-session">https://github.com/L316476844/distributed-session</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/entry/57e39e320e3dd90058021bff">åˆ†å¸ƒå¼ç¼“å­˜æ¶æ„åŸºç¡€</a></li>
<li><a target="_blank" rel="noopener" href="https://www.toutiao.com/i6533812974807679495/?tt_from=weixin&utm_campaign=client_share&from=singlemessage&timestamp=1521281305&app=news_article&utm_source=weixin&iid=28128279343&utm_medium=toutiao_android&weixin_list=1&wxshare_count=2&pbid=6517746516513195523">é˜¿é‡Œ P8 æŠ€æœ¯ä¸“å®¶ç»†ç©¶åˆ†å¸ƒå¼ç¼“å­˜é—®é¢˜</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/98a1c1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/98a1c1/" class="post-title-link" itemprop="url">æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-05 15:50:00" itemprop="dateCreated datePublished" datetime="2018-07-05T15:50:00+08:00">2018-07-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">åˆ†å¸ƒå¼</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E8%B0%83%E5%BA%A6/" itemprop="url" rel="index"><span itemprop="name">åˆ†å¸ƒå¼è°ƒåº¦</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>18k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>16 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡"><a href="#æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡" class="headerlink" title="æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡"></a>æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡</h1><p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200528155252.png" alt="img"></p>
<h2 id="è´Ÿè½½å‡è¡¡ç®€ä»‹"><a href="#è´Ÿè½½å‡è¡¡ç®€ä»‹" class="headerlink" title="è´Ÿè½½å‡è¡¡ç®€ä»‹"></a>è´Ÿè½½å‡è¡¡ç®€ä»‹</h2><h3 id="å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜"><a href="#å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜" class="headerlink" title="å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜"></a>å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜</h3><p>å¤§å‹ç½‘ç«™éƒ½è¦é¢å¯¹åºå¤§çš„ç”¨æˆ·é‡ï¼Œé«˜å¹¶å‘ï¼Œæµ·é‡æ•°æ®ç­‰æŒ‘æˆ˜ã€‚</p>
<p>ä¸ºäº†æå‡ç³»ç»Ÿæ•´ä½“çš„æ€§èƒ½ï¼Œå¯ä»¥é‡‡ç”¨å‚ç›´æ‰©å±•å’Œæ°´å¹³æ‰©å±•ä¸¤ç§æ–¹å¼ã€‚</p>
<ul>
<li><strong>å‚ç›´æ‰©å±•</strong>ï¼šåœ¨ç½‘ç«™å‘å±•æ—©æœŸï¼Œå¯ä»¥ä»å•æœºçš„è§’åº¦é€šè¿‡<strong>å¢åŠ ç¡¬ä»¶å¤„ç†èƒ½åŠ›</strong>ï¼Œæ¯”å¦‚ CPU å¤„ç†èƒ½åŠ›ï¼Œå†…å­˜å®¹é‡ï¼Œç£ç›˜ç­‰æ–¹é¢ï¼Œå®ç°æœåŠ¡å™¨å¤„ç†èƒ½åŠ›çš„æå‡ã€‚ä½†æ˜¯ï¼Œå•æœºæ˜¯æœ‰æ€§èƒ½ç“¶é¢ˆçš„ï¼Œä¸€æ—¦è§¦åŠç“¶é¢ˆï¼Œå†æƒ³æå‡ï¼Œä»˜å‡ºçš„æˆæœ¬å’Œä»£ä»·ä¼šæé«˜ã€‚è¿™æ˜¾ç„¶ä¸èƒ½æ»¡è¶³å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆç½‘ç«™ï¼‰æ‰€æœ‰åº”å¯¹çš„å¤§æµé‡ï¼Œé«˜å¹¶å‘ï¼Œæµ·é‡æ•°æ®ç­‰æŒ‘æˆ˜ã€‚</li>
<li><strong>æ°´å¹³æ‰©å±•</strong>ï¼šé€šè¿‡é›†ç¾¤æ¥åˆ†æ‹…å¤§å‹ç½‘ç«™çš„æµé‡ã€‚é›†ç¾¤ä¸­çš„åº”ç”¨æœåŠ¡å™¨ï¼ˆèŠ‚ç‚¹ï¼‰é€šå¸¸è¢«è®¾è®¡æˆæ— çŠ¶æ€ï¼Œç”¨æˆ·å¯ä»¥è¯·æ±‚ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹å…±åŒåˆ†æ‹…è®¿é—®å‹åŠ›ã€‚æ°´å¹³æ‰©å±•æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼š<ul>
<li><strong>åº”ç”¨é›†ç¾¤</strong>ï¼šå°†åŒä¸€åº”ç”¨éƒ¨ç½²åˆ°å¤šå°æœºå™¨ä¸Šï¼Œç»„æˆå¤„ç†é›†ç¾¤ï¼Œæ¥æ”¶è´Ÿè½½å‡è¡¡è®¾å¤‡åˆ†å‘çš„è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç†ï¼Œå¹¶è¿”å›ç›¸åº”æ•°æ®ã€‚</li>
<li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šå°†ç”¨æˆ·è®¿é—®è¯·æ±‚ï¼Œé€šè¿‡æŸç§ç®—æ³•ï¼Œåˆ†å‘åˆ°é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ã€‚</li>
</ul>
</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡"><a href="#ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡" class="headerlink" title="ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡"></a>ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡</h3><p>è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼Œç®€ç§° LBï¼‰æ˜¯é«˜å¹¶å‘ã€é«˜å¯ç”¨ç³»ç»Ÿå¿…ä¸å¯å°‘çš„å…³é”®ç»„ä»¶ï¼Œç›®æ ‡æ˜¯ <strong>å°½åŠ›å°†ç½‘ç»œæµé‡å¹³å‡åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œä»¥æé«˜ç³»ç»Ÿæ•´ä½“çš„å“åº”é€Ÿåº¦å’Œå¯ç”¨æ€§</strong>ã€‚</p>
<p>è´Ÿè½½å‡è¡¡çš„ä¸»è¦ä½œç”¨å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>é«˜å¹¶å‘</strong>ï¼šè´Ÿè½½å‡è¡¡é€šè¿‡ç®—æ³•è°ƒæ•´è´Ÿè½½ï¼Œå°½åŠ›å‡åŒ€çš„åˆ†é…åº”ç”¨é›†ç¾¤ä¸­å„èŠ‚ç‚¹çš„å·¥ä½œé‡ï¼Œä»¥æ­¤æé«˜åº”ç”¨é›†ç¾¤çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼ˆååé‡ï¼‰ã€‚</li>
<li><strong>ä¼¸ç¼©æ€§</strong>ï¼šæ·»åŠ æˆ–å‡å°‘æœåŠ¡å™¨æ•°é‡ï¼Œç„¶åç”±è´Ÿè½½å‡è¡¡è¿›è¡Œåˆ†å‘æ§åˆ¶ã€‚è¿™ä½¿å¾—åº”ç”¨é›†ç¾¤å…·å¤‡ä¼¸ç¼©æ€§ã€‚</li>
<li><strong>é«˜å¯ç”¨</strong>ï¼šè´Ÿè½½å‡è¡¡å™¨å¯ä»¥ç›‘æ§å€™é€‰æœåŠ¡å™¨ï¼Œå½“æœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼Œè‡ªåŠ¨è·³è¿‡ï¼Œå°†è¯·æ±‚åˆ†å‘ç»™å¯ç”¨çš„æœåŠ¡å™¨ã€‚è¿™ä½¿å¾—åº”ç”¨é›†ç¾¤å…·å¤‡é«˜å¯ç”¨çš„ç‰¹æ€§ã€‚</li>
<li><strong>å®‰å…¨é˜²æŠ¤</strong>ï¼šæœ‰äº›è´Ÿè½½å‡è¡¡è½¯ä»¶æˆ–ç¡¬ä»¶æä¾›äº†å®‰å…¨æ€§åŠŸèƒ½ï¼Œå¦‚ï¼šé»‘ç™½åå•å¤„ç†ã€é˜²ç«å¢™ï¼Œé˜² DDos æ”»å‡»ç­‰ã€‚</li>
</ul>
<h2 id="è´Ÿè½½å‡è¡¡çš„åˆ†ç±»"><a href="#è´Ÿè½½å‡è¡¡çš„åˆ†ç±»" class="headerlink" title="è´Ÿè½½å‡è¡¡çš„åˆ†ç±»"></a>è´Ÿè½½å‡è¡¡çš„åˆ†ç±»</h2><p>æ”¯æŒè´Ÿè½½å‡è¡¡çš„æŠ€æœ¯å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸åŒç»´åº¦å»è¿›è¡Œåˆ†ç±»ã€‚</p>
<h3 id="è½½ä½“ç»´åº¦åˆ†ç±»"><a href="#è½½ä½“ç»´åº¦åˆ†ç±»" class="headerlink" title="è½½ä½“ç»´åº¦åˆ†ç±»"></a>è½½ä½“ç»´åº¦åˆ†ç±»</h3><p>ä»æ”¯æŒè´Ÿè½½å‡è¡¡çš„è½½ä½“æ¥çœ‹ï¼Œå¯ä»¥å°†è´Ÿè½½å‡è¡¡åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li>ç¡¬ä»¶è´Ÿè½½å‡è¡¡</li>
<li>è½¯ä»¶è´Ÿè½½å‡è¡¡</li>
</ul>
<h4 id="ç¡¬ä»¶è´Ÿè½½å‡è¡¡"><a href="#ç¡¬ä»¶è´Ÿè½½å‡è¡¡" class="headerlink" title="ç¡¬ä»¶è´Ÿè½½å‡è¡¡"></a>ç¡¬ä»¶è´Ÿè½½å‡è¡¡</h4><p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬æ˜¯åœ¨å®šåˆ¶å¤„ç†å™¨ä¸Šè¿è¡Œçš„ç‹¬ç«‹è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œ<strong>ä»·æ ¼æ˜‚è´µï¼ŒåœŸè±ªä¸“å±</strong>ã€‚</p>
<p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¸»æµäº§å“</strong> æœ‰ï¼š<a target="_blank" rel="noopener" href="https://f5.com/zh">F5</a> å’Œ <a target="_blank" rel="noopener" href="https://www.a10networks.com.cn/">A10</a>ã€‚</p>
<p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>åŠŸèƒ½å¼ºå¤§</strong>ï¼šæ”¯æŒå…¨å±€è´Ÿè½½å‡è¡¡å¹¶æä¾›è¾ƒå…¨é¢çš„ã€å¤æ‚çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚</li>
<li><strong>æ€§èƒ½å¼ºæ‚</strong>ï¼šç¡¬ä»¶è´Ÿè½½å‡è¡¡ç”±äºæ˜¯åœ¨ä¸“ç”¨å¤„ç†å™¨ä¸Šè¿è¡Œï¼Œå› æ­¤ååé‡å¤§ï¼Œå¯æ”¯æŒå•æœºç™¾ä¸‡ä»¥ä¸Šçš„å¹¶å‘ã€‚</li>
<li><strong>å®‰å…¨æ€§é«˜</strong>ï¼šå¾€å¾€å…·å¤‡é˜²ç«å¢™ï¼Œé˜² DDos æ”»å‡»ç­‰å®‰å…¨åŠŸèƒ½ã€‚</li>
</ul>
<p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æˆæœ¬æ˜‚è´µ</strong>ï¼šè´­ä¹°å’Œç»´æŠ¤ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„æˆæœ¬éƒ½å¾ˆé«˜ã€‚</li>
<li><strong>æ‰©å±•æ€§å·®</strong>ï¼šå½“è®¿é—®é‡çªå¢æ—¶ï¼Œè¶…è¿‡é™åº¦ä¸èƒ½åŠ¨æ€æ‰©å®¹ã€‚</li>
</ul>
<h4 id="è½¯ä»¶è´Ÿè½½å‡è¡¡"><a href="#è½¯ä»¶è´Ÿè½½å‡è¡¡" class="headerlink" title="è½¯ä»¶è´Ÿè½½å‡è¡¡"></a>è½¯ä»¶è´Ÿè½½å‡è¡¡</h4><p>è½¯ä»¶è´Ÿè½½å‡è¡¡ï¼Œ<strong>åº”ç”¨æœ€å¹¿æ³›</strong>ï¼Œæ— è®ºå¤§å…¬å¸è¿˜æ˜¯å°å…¬å¸éƒ½ä¼šä½¿ç”¨ã€‚</p>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡ä»è½¯ä»¶å±‚é¢å®ç°è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬å¯ä»¥åœ¨ä»»ä½•æ ‡å‡†ç‰©ç†è®¾å¤‡ä¸Šè¿è¡Œã€‚</p>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¸»æµäº§å“</strong> æœ‰ï¼š<a target="_blank" rel="noopener" href="https://www.nginx.com/">Nginx</a>ã€<a target="_blank" rel="noopener" href="http://www.haproxy.org/">HAProxy</a>ã€<a target="_blank" rel="noopener" href="https://github.com/alibaba/LVS">LVS</a>ã€‚</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/LVS">LVS</a> å¯ä»¥ä½œä¸ºå››å±‚è´Ÿè½½å‡è¡¡å™¨ã€‚å…¶è´Ÿè½½å‡è¡¡çš„æ€§èƒ½è¦ä¼˜äº Nginxã€‚</li>
<li><a target="_blank" rel="noopener" href="http://www.haproxy.org/">HAProxy</a> å¯ä»¥ä½œä¸º HTTP å’Œ TCP è´Ÿè½½å‡è¡¡å™¨ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/">Nginx</a>ã€<a target="_blank" rel="noopener" href="http://www.haproxy.org/">HAProxy</a> å¯ä»¥ä½œä¸ºå››å±‚æˆ–ä¸ƒå±‚è´Ÿè½½å‡è¡¡å™¨ã€‚</li>
</ul>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ‰©å±•æ€§å¥½</strong>ï¼šé€‚åº”åŠ¨æ€å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ è½¯ä»¶è´Ÿè½½å‡è¡¡å®ä¾‹ï¼ŒåŠ¨æ€æ‰©å±•åˆ°è¶…å‡ºåˆå§‹å®¹é‡çš„èƒ½åŠ›ã€‚</li>
<li><strong>æˆæœ¬ä½å»‰</strong>ï¼šè½¯ä»¶è´Ÿè½½å‡è¡¡å¯ä»¥åœ¨ä»»ä½•æ ‡å‡†ç‰©ç†è®¾å¤‡ä¸Šè¿è¡Œï¼Œé™ä½äº†è´­ä¹°å’Œè¿ç»´çš„æˆæœ¬ã€‚</li>
</ul>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ€§èƒ½ç•¥å·®</strong>ï¼šç›¸æ¯”äºç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼Œè½¯ä»¶è´Ÿè½½å‡è¡¡çš„æ€§èƒ½è¦ç•¥ä½ä¸€äº›ã€‚</li>
</ul>
<h3 id="ç½‘ç»œé€šä¿¡åˆ†ç±»"><a href="#ç½‘ç»œé€šä¿¡åˆ†ç±»" class="headerlink" title="ç½‘ç»œé€šä¿¡åˆ†ç±»"></a>ç½‘ç»œé€šä¿¡åˆ†ç±»</h3><p>è½¯ä»¶è´Ÿè½½å‡è¡¡ä»é€šä¿¡å±‚é¢æ¥çœ‹ï¼Œåˆå¯ä»¥åˆ†ä¸ºå››å±‚å’Œä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<ul>
<li>ä¸ƒå±‚è´Ÿè½½å‡è¡¡ï¼šå°±æ˜¯å¯ä»¥æ ¹æ®è®¿é—®ç”¨æˆ·çš„ HTTP è¯·æ±‚å¤´ã€URL ä¿¡æ¯å°†è¯·æ±‚è½¬å‘åˆ°ç‰¹å®šçš„ä¸»æœºã€‚<ul>
<li>DNS é‡å®šå‘</li>
<li>HTTP é‡å®šå‘</li>
<li>åå‘ä»£ç†</li>
</ul>
</li>
<li>å››å±‚è´Ÿè½½å‡è¡¡ï¼šåŸºäº IP åœ°å€å’Œç«¯å£è¿›è¡Œè¯·æ±‚çš„è½¬å‘ã€‚<ul>
<li>ä¿®æ”¹ IP åœ°å€</li>
<li>ä¿®æ”¹ MAC åœ°å€</li>
</ul>
</li>
</ul>
<h4 id="DNS-è´Ÿè½½å‡è¡¡"><a href="#DNS-è´Ÿè½½å‡è¡¡" class="headerlink" title="DNS è´Ÿè½½å‡è¡¡"></a>DNS è´Ÿè½½å‡è¡¡</h4><p>DNS è´Ÿè½½å‡è¡¡ä¸€èˆ¬ç”¨äºäº’è”ç½‘å…¬å¸ï¼Œå¤æ‚çš„ä¸šåŠ¡ç³»ç»Ÿä¸é€‚åˆä½¿ç”¨ã€‚å¤§å‹ç½‘ç«™ä¸€èˆ¬ä½¿ç”¨ DNS è´Ÿè½½å‡è¡¡ä½œä¸º <strong>ç¬¬ä¸€çº§è´Ÿè½½å‡è¡¡æ‰‹æ®µ</strong>ï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨å…¶å®ƒæ–¹å¼åšç¬¬äºŒçº§è´Ÿè½½å‡è¡¡ã€‚DNS è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p>DNS å³ <strong>åŸŸåè§£ææœåŠ¡</strong>ï¼Œæ˜¯ OSI ç¬¬ä¸ƒå±‚ç½‘ç»œåè®®ã€‚DNS è¢«è®¾è®¡ä¸ºä¸€ä¸ªæ ‘å½¢ç»“æ„çš„åˆ†å¸ƒå¼åº”ç”¨ï¼Œè‡ªä¸Šè€Œä¸‹ä¾æ¬¡ä¸ºï¼šæ ¹åŸŸåæœåŠ¡å™¨ï¼Œä¸€çº§åŸŸåæœåŠ¡å™¨ï¼ŒäºŒçº§åŸŸåæœåŠ¡å™¨ï¼Œâ€¦ ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚æ˜¾ç„¶ï¼Œå¦‚æœæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨æ ¹åŸŸåæœåŠ¡å™¨ï¼Œé‚£ä¹ˆ DNS æŸ¥è¯¢çš„è´Ÿè½½å’Œå¼€é”€ä¼šéå¸¸åºå¤§ã€‚</p>
<p>å› æ­¤ï¼ŒDNS æŸ¥è¯¢ç›¸å¯¹äº DNS å±‚çº§ç»“æ„ï¼Œæ˜¯ä¸€ä¸ªé€†å‘çš„é€’å½’æµç¨‹ï¼ŒDNS å®¢æˆ·ç«¯ä¾æ¬¡è¯·æ±‚æœ¬åœ° DNS æœåŠ¡å™¨ï¼Œä¸Šä¸€çº§ DNS æœåŠ¡å™¨ï¼Œä¸Šä¸Šä¸€çº§ DNS æœåŠ¡å™¨ï¼Œâ€¦ ï¼Œæ ¹ DNS æœåŠ¡å™¨ï¼ˆåˆå«æƒå¨ DNS æœåŠ¡å™¨ï¼‰ï¼Œä¸€æ—¦å‘½ä¸­ï¼Œç«‹å³è¿”å›ã€‚ä¸ºäº†å‡å°‘æŸ¥è¯¢æ¬¡æ•°ï¼Œæ¯ä¸€çº§ DNS æœåŠ¡å™¨éƒ½ä¼šè®¾ç½® DNS æŸ¥è¯¢ç¼“å­˜ã€‚</p>
<p>DNS è´Ÿè½½å‡è¡¡çš„å·¥ä½œåŸç†å°±æ˜¯ï¼š<strong>åŸºäº DNS æŸ¥è¯¢ç¼“å­˜ï¼ŒæŒ‰ç…§è´Ÿè½½æƒ…å†µè¿”å›ä¸åŒæœåŠ¡å™¨çš„ IP åœ°å€</strong>ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117220007.png" alt="img"></p>
<p>DNS é‡å®šå‘çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>ä½¿ç”¨ç®€å•</strong>ï¼šè´Ÿè½½å‡è¡¡å·¥ä½œï¼Œäº¤ç»™ DNS æœåŠ¡å™¨å¤„ç†ï¼Œçœæ‰äº†è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç»´æŠ¤çš„éº»çƒ¦</li>
<li><strong>æé«˜æ€§èƒ½</strong>ï¼šå¯ä»¥æ”¯æŒåŸºäºåœ°å€çš„åŸŸåè§£æï¼Œè§£ææˆè·ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡å™¨åœ°å€ï¼ˆç±»ä¼¼ CDN çš„åŸç†ï¼‰ï¼Œå¯ä»¥åŠ å¿«è®¿é—®é€Ÿåº¦ï¼Œæ”¹å–„æ€§èƒ½ï¼›</li>
</ul>
<p>DNS é‡å®šå‘çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å¯ç”¨æ€§å·®</strong>ï¼šDNS è§£ææ˜¯å¤šçº§è§£æï¼Œæ–°å¢&#x2F;ä¿®æ”¹ DNS åï¼Œè§£ææ—¶é—´è¾ƒé•¿ï¼›è§£æè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·è®¿é—®ç½‘ç«™å°†å¤±è´¥ï¼›</li>
<li><strong>æ‰©å±•æ€§å·®</strong>ï¼šDNS è´Ÿè½½å‡è¡¡çš„æ§åˆ¶æƒåœ¨åŸŸåå•†é‚£é‡Œï¼Œæ— æ³•å¯¹å…¶åšæ›´å¤šçš„æ”¹å–„å’Œæ‰©å±•ï¼›</li>
<li><strong>ç»´æŠ¤æ€§å·®</strong>ï¼šä¹Ÿä¸èƒ½åæ˜ æœåŠ¡å™¨çš„å½“å‰è¿è¡ŒçŠ¶æ€ï¼›æ”¯æŒçš„ç®—æ³•å°‘ï¼›ä¸èƒ½åŒºåˆ†æœåŠ¡å™¨çš„å·®å¼‚ï¼ˆä¸èƒ½æ ¹æ®ç³»ç»Ÿä¸æœåŠ¡çš„çŠ¶æ€æ¥åˆ¤æ–­è´Ÿè½½ï¼‰</li>
</ul>
<h4 id="HTTP-è´Ÿè½½å‡è¡¡"><a href="#HTTP-è´Ÿè½½å‡è¡¡" class="headerlink" title="HTTP è´Ÿè½½å‡è¡¡"></a>HTTP è´Ÿè½½å‡è¡¡</h4><p><strong>HTTP è´Ÿè½½å‡è¡¡æ˜¯åŸºäº HTTP é‡å®šå‘å®ç°çš„</strong>ã€‚HTTP è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p>HTTP é‡å®šå‘åŸç†æ˜¯ï¼š<strong>æ ¹æ®ç”¨æˆ·çš„ HTTP è¯·æ±‚è®¡ç®—å‡ºä¸€ä¸ªçœŸå®çš„æœåŠ¡å™¨åœ°å€ï¼Œå°†è¯¥æœåŠ¡å™¨åœ°å€å†™å…¥ HTTP é‡å®šå‘å“åº”ä¸­ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œç”±æµè§ˆå™¨é‡æ–°è¿›è¡Œè®¿é—®</strong>ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117220310.png" alt="img"></p>
<p>HTTP é‡å®šå‘çš„ <strong>ä¼˜ç‚¹</strong>ï¼š<strong>æ–¹æ¡ˆç®€å•</strong>ã€‚</p>
<p>HTTP é‡å®šå‘çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>é¢å¤–çš„è½¬å‘å¼€é”€</strong>ï¼šæ¯æ¬¡è®¿é—®éœ€è¦ä¸¤æ¬¡è¯·æ±‚æœåŠ¡å™¨ï¼Œå¢åŠ äº†è®¿é—®çš„å»¶è¿Ÿã€‚</li>
<li><strong>é™ä½æœç´¢æ’å</strong>ï¼šä½¿ç”¨é‡å®šå‘åï¼Œæœç´¢å¼•æ“ä¼šè§†ä¸º SEO ä½œå¼Šã€‚</li>
<li>å¦‚æœè´Ÿè½½å‡è¡¡å™¨å®•æœºï¼Œå°±æ— æ³•è®¿é—®è¯¥ç«™ç‚¹ã€‚</li>
</ul>
<p>ç”±äºå…¶ç¼ºç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥è¿™ç§è´Ÿè½½å‡è¡¡ç­–ç•¥å®é™…åº”ç”¨è¾ƒå°‘ã€‚</p>
<h4 id="åå‘ä»£ç†è´Ÿè½½å‡è¡¡"><a href="#åå‘ä»£ç†è´Ÿè½½å‡è¡¡" class="headerlink" title="åå‘ä»£ç†è´Ÿè½½å‡è¡¡"></a>åå‘ä»£ç†è´Ÿè½½å‡è¡¡</h4><p>åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥ <strong>ä»£ç†æœåŠ¡å™¨</strong> æ¥æ¥å—ç½‘ç»œè¯·æ±‚ï¼Œç„¶å <strong>å°†è¯·æ±‚è½¬å‘ç»™å†…ç½‘ä¸­çš„æœåŠ¡å™¨</strong>ï¼Œå¹¶å°†ä»å†…ç½‘ä¸­çš„æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ç½‘ç»œè¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚åå‘ä»£ç†è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p>åå‘ä»£ç†æœåŠ¡çš„ä¸»æµäº§å“ï¼š<strong>Nginx</strong>ã€<strong>Apache</strong>ã€‚</p>
<p>æ­£å‘ä»£ç†ä¸åå‘ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<ul>
<li>æ­£å‘ä»£ç†ï¼šå‘ç”Ÿåœ¨ <strong>å®¢æˆ·ç«¯</strong>ï¼Œæ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å‘èµ·çš„ã€‚ç¿»å¢™è½¯ä»¶å°±æ˜¯å…¸å‹çš„æ­£å‘ä»£ç†ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸»åŠ¨è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œè®©ä»£ç†æœåŠ¡å™¨è·å¾—éœ€è¦çš„å¤–ç½‘æ•°æ®ï¼Œç„¶åè½¬å‘å›å®¢æˆ·ç«¯ã€‚</li>
<li>åå‘ä»£ç†ï¼šå‘ç”Ÿåœ¨ <strong>æœåŠ¡ç«¯</strong>ï¼Œç”¨æˆ·ä¸çŸ¥é“ä»£ç†çš„å­˜åœ¨ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117222209.png" alt="img"></p>
<p>åå‘ä»£ç†æ˜¯å¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡çš„å‘¢ï¼Ÿä»¥ Nginx ä¸ºä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/web/nginx/nginx-load-balance.png" alt="img"></p>
<p>é¦–å…ˆï¼Œåœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè®¾å®šå¥½è´Ÿè½½å‡è¡¡è§„åˆ™ã€‚ç„¶åï¼Œå½“æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚ï¼Œåå‘ä»£ç†æœåŠ¡å™¨æ‹¦æˆªæŒ‡å®šçš„åŸŸåæˆ– IP è¯·æ±‚ï¼Œæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨ä¸Šã€‚å…¶æ¬¡ï¼Œå¦‚æœæŸå°å€™é€‰æœåŠ¡å™¨å®•æœºï¼Œåå‘ä»£ç†æœåŠ¡å™¨ä¼šæœ‰å®¹é”™å¤„ç†ï¼Œæ¯”å¦‚åˆ†å‘è¯·æ±‚å¤±è´¥ 3 æ¬¡ä»¥ä¸Šï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å…¶ä»–å€™é€‰æœåŠ¡å™¨ä¸Šã€‚</p>
<p>åå‘ä»£ç†çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•</strong>ï¼šæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä»¥åº”å¯¹ä¸åŒçš„åœºæ™¯éœ€æ±‚ã€‚</li>
<li><strong>å¯ä»¥ç›‘æ§æœåŠ¡å™¨</strong>ï¼šåŸºäº HTTP åè®®ï¼Œå¯ä»¥ç›‘æ§è½¬å‘æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¦‚ï¼šç³»ç»Ÿè´Ÿè½½ã€å“åº”æ—¶é—´ã€æ˜¯å¦å¯ç”¨ã€è¿æ¥æ•°ã€æµé‡ç­‰ï¼Œä»è€Œæ ¹æ®è¿™äº›æ•°æ®è°ƒæ•´è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ã€‚</li>
</ul>
<p>åå‘ä»£ç†çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><p><strong>é¢å¤–çš„è½¬å‘å¼€é”€</strong>ï¼šåå‘ä»£ç†çš„è½¬å‘æ“ä½œæœ¬èº«æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œå¯èƒ½ä¼šåŒ…æ‹¬åˆ›å»ºè¿æ¥ï¼Œç­‰å¾…è¿æ¥å“åº”ï¼Œåˆ†æå“åº”ç»“æœç­‰æ“ä½œã€‚</p>
</li>
<li><p><strong>å¢åŠ ç³»ç»Ÿå¤æ‚åº¦</strong>ï¼šåå‘ä»£ç†å¸¸ç”¨äºåšåˆ†å¸ƒå¼åº”ç”¨çš„æ°´å¹³æ‰©å±•ï¼Œä½†åå‘ä»£ç†æœåŠ¡å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼Œä¸ºäº†è§£å†³ä»¥ä¸‹é—®é¢˜ä¼šç»™ç³»ç»Ÿæ•´ä½“å¢åŠ é¢å¤–çš„å¤æ‚åº¦å’Œè¿ç»´æˆæœ¬ï¼š</p>
</li>
<li><p>åå‘ä»£ç†æœåŠ¡å¦‚æœè‡ªèº«å®•æœºï¼Œå°±æ— æ³•è®¿é—®ç«™ç‚¹ï¼Œæ‰€ä»¥éœ€è¦æœ‰ <strong>é«˜å¯ç”¨</strong> æ–¹æ¡ˆï¼Œå¸¸è§çš„æ–¹æ¡ˆæœ‰ï¼šä¸»å¤‡æ¨¡å¼ï¼ˆä¸€ä¸»ä¸€å¤‡ï¼‰ã€åŒä¸»æ¨¡å¼ï¼ˆäº’ä¸ºä¸»å¤‡ï¼‰ã€‚</p>
<ul>
<li>åå‘ä»£ç†æœåŠ¡è‡ªèº«ä¹Ÿå­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Œéšç€éœ€è¦è½¬å‘çš„è¯·æ±‚é‡ä¸æ–­æ”€å‡ï¼Œéœ€è¦æœ‰ <strong>å¯æ‰©å±•</strong> æ–¹æ¡ˆã€‚</li>
</ul>
</li>
</ul>
<h4 id="IP-è´Ÿè½½å‡è¡¡"><a href="#IP-è´Ÿè½½å‡è¡¡" class="headerlink" title="IP è´Ÿè½½å‡è¡¡"></a>IP è´Ÿè½½å‡è¡¡</h4><p>IP è´Ÿè½½å‡è¡¡æ˜¯åœ¨ç½‘ç»œå±‚é€šè¿‡ä¿®æ”¹è¯·æ±‚ç›®çš„åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210119000529.png" alt="img"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒIP å‡è¡¡å¤„ç†æµç¨‹å¤§è‡´ä¸ºï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯è¯·æ±‚ 192.168.137.10ï¼Œç”±è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ¥æ”¶åˆ°æŠ¥æ–‡ã€‚</li>
<li>è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ ¹æ®ç®—æ³•é€‰å‡ºä¸€ä¸ªæœåŠ¡èŠ‚ç‚¹ 192.168.0.1ï¼Œç„¶åå°†æŠ¥æ–‡è¯·æ±‚åœ°å€æ”¹ä¸ºè¯¥èŠ‚ç‚¹çš„ IPã€‚</li>
<li>çœŸå®æœåŠ¡èŠ‚ç‚¹æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡ï¼Œå¤„ç†åï¼Œè¿”å›å“åº”æ•°æ®åˆ°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚</li>
<li>è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å°†å“åº”æ•°æ®çš„æºåœ°å€æ”¹è´Ÿè½½å‡è¡¡æœåŠ¡å™¨åœ°å€ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
</ol>
<p>IP è´Ÿè½½å‡è¡¡åœ¨å†…æ ¸è¿›ç¨‹å®Œæˆæ•°æ®åˆ†å‘ï¼Œè¾ƒåå‘ä»£ç†è´Ÿè½½å‡è¡¡æœ‰æ›´å¥½çš„å¤„ç†æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œç”±äºæ‰€æœ‰è¯·æ±‚å“åº”éƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œé›†ç¾¤çš„ååé‡å—åˆ¶äºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨çš„å¸¦å®½ã€‚</p>
<h4 id="æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"><a href="#æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡" class="headerlink" title="æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"></a>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡</h4><p>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡æ˜¯æŒ‡åœ¨é€šä¿¡åè®®çš„æ•°æ®é“¾è·¯å±‚ä¿®æ”¹ mac åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117222127.png" alt="img"></p>
<p>åœ¨ Linux å¹³å°ä¸Šæœ€å¥½çš„é“¾è·¯å±‚è´Ÿè½½å‡è¡¡å¼€æºäº§å“æ˜¯ LVS (Linux Virtual Server)ã€‚</p>
<p>LVS æ˜¯åŸºäº Linux å†…æ ¸ä¸­ netfilter æ¡†æ¶å®ç°çš„è´Ÿè½½å‡è¡¡ç³»ç»Ÿã€‚netfilter æ˜¯å†…æ ¸æ€çš„ Linux é˜²ç«å¢™æœºåˆ¶ï¼Œå¯ä»¥åœ¨æ•°æ®åŒ…æµç»è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®è§„åˆ™è®¾ç½®è‹¥å¹²ä¸ªå…³å¡ï¼ˆhook å‡½æ•°ï¼‰æ¥æ‰§è¡Œç›¸å…³çš„æ“ä½œã€‚</p>
<p>LVS çš„å·¥ä½œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<ul>
<li>å½“ç”¨æˆ·è®¿é—® <a target="_blank" rel="noopener" href="http://www.sina.com.cn/">www.sina.com.cn</a> æ—¶ï¼Œç”¨æˆ·æ•°æ®é€šè¿‡å±‚å±‚ç½‘ç»œï¼Œæœ€åé€šè¿‡äº¤æ¢æœºè¿›å…¥ LVS æœåŠ¡å™¨ç½‘å¡ï¼Œå¹¶è¿›å…¥å†…æ ¸ç½‘ç»œå±‚ã€‚</li>
<li>è¿›å…¥ PREROUTING åç»è¿‡è·¯ç”±æŸ¥æ‰¾ï¼Œç¡®å®šè®¿é—®çš„ç›®çš„ VIP æ˜¯æœ¬æœº IP åœ°å€ï¼Œæ‰€ä»¥æ•°æ®åŒ…è¿›å…¥åˆ° INPUT é“¾ä¸Š</li>
<li>IPVS æ˜¯å·¥ä½œåœ¨ INPUT é“¾ä¸Šï¼Œä¼šæ ¹æ®è®¿é—®çš„ <code>vip+port</code> åˆ¤æ–­è¯·æ±‚æ˜¯å¦ IPVS æœåŠ¡ï¼Œå¦‚æœæ˜¯åˆ™è°ƒç”¨æ³¨å†Œçš„ IPVS HOOK å‡½æ•°ï¼Œè¿›è¡Œ IPVS ç›¸å…³ä¸»æµç¨‹ï¼Œå¼ºè¡Œä¿®æ”¹æ•°æ®åŒ…çš„ç›¸å…³æ•°æ®ï¼Œå¹¶å°†æ•°æ®åŒ…å‘å¾€ POSTROUTING é“¾ä¸Šã€‚</li>
<li>POSTROUTING ä¸Šæ”¶åˆ°æ•°æ®åŒ…åï¼Œæ ¹æ®ç›®æ ‡ IP åœ°å€ï¼ˆåç«¯æœåŠ¡å™¨ï¼‰ï¼Œé€šè¿‡è·¯ç”±é€‰è·¯ï¼Œå°†æ•°æ®åŒ…æœ€ç»ˆå‘å¾€åç«¯çš„æœåŠ¡å™¨ä¸Šã€‚</li>
</ul>
<p>å¼€æº LVS ç‰ˆæœ¬æœ‰ 3 ç§å·¥ä½œæ¨¡å¼ï¼Œæ¯ç§æ¨¡å¼å·¥ä½œåŸç†æˆªç„¶ä¸åŒï¼Œè¯´å„ç§æ¨¡å¼éƒ½æœ‰è‡ªå·±çš„ä¼˜ç¼ºç‚¹ï¼Œåˆ†åˆ«é€‚åˆä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œä¸è¿‡æœ€ç»ˆæœ¬è´¨çš„åŠŸèƒ½éƒ½æ˜¯èƒ½å®ç°å‡è¡¡çš„æµé‡è°ƒåº¦å’Œè‰¯å¥½çš„æ‰©å±•æ€§ã€‚ä¸»è¦åŒ…æ‹¬ä¸‰ç§æ¨¡å¼ï¼šDR æ¨¡å¼ã€NAT æ¨¡å¼ã€Tunnel æ¨¡å¼ã€‚</p>
<h2 id="è´Ÿè½½å‡è¡¡ç®—æ³•"><a href="#è´Ÿè½½å‡è¡¡ç®—æ³•" class="headerlink" title="è´Ÿè½½å‡è¡¡ç®—æ³•"></a>è´Ÿè½½å‡è¡¡ç®—æ³•</h2><p>è´Ÿè½½å‡è¡¡å™¨çš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>æ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•åœ¨å€™é€‰æœåŠ¡å™¨åˆ—è¡¨é€‰å‡ºä¸€ä¸ªæœåŠ¡å™¨ï¼›</li>
<li>å°†è¯·æ±‚æ•°æ®å‘é€åˆ°è¯¥æœåŠ¡å™¨ä¸Šã€‚</li>
</ul>
<p>è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯è´Ÿè½½å‡è¡¡æœåŠ¡æ ¸å¿ƒä¸­çš„æ ¸å¿ƒã€‚è´Ÿè½½å‡è¡¡äº§å“å¤šç§å¤šæ ·ï¼Œä½†æ˜¯å„ç§è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†æ˜¯å…±æ€§çš„ã€‚</p>
<p>è´Ÿè½½å‡è¡¡ç®—æ³•æœ‰å¾ˆå¤šç§ï¼Œåˆ†åˆ«é€‚ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œæœ¬æ–‡ä»…ä»‹ç»æœ€ä¸ºå¸¸è§çš„è´Ÿè½½å‡è¡¡ç®—æ³•çš„ç‰¹æ€§åŠåŸç†ï¼šè½®è¯¢ã€éšæœºã€æœ€å°æ´»è·ƒæ•°ã€æºåœ°å€å“ˆå¸Œã€ä¸€è‡´æ€§å“ˆå¸Œã€‚</p>
<blockquote>
<p>æ³¨ï¼šè´Ÿè½½å‡è¡¡ç®—æ³•çš„å®ç°ï¼Œæ¨èé˜…è¯» <a target="_blank" rel="noopener" href="https://dubbo.apache.org/zh/docs/v2.7/dev/source/loadbalance/">Dubbo å®˜æ–¹è´Ÿè½½å‡è¡¡ç®—æ³•è¯´æ˜</a> ï¼Œæºç è®²è§£éå¸¸è¯¦ç»†ï¼Œéå¸¸å€¼å¾—å€Ÿé‰´ã€‚</p>
<p>ä¸‹æ–‡ä¸­çš„å„ç§ç®—æ³•çš„å¯æ‰§è¡Œç¤ºä¾‹å·²å½’æ¡£åœ¨ Github ä»“åº“ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/java-tutorial/tree/master/codes/java-distributed/java-load-balance%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E6%89%A7%E8%A1%8C">https://github.com/dunwu/java-tutorial/tree/master/codes/java-distributed/java-load-balanceï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œ</a> io.github.dunwu.javatech.LoadBalanceDemo æŸ¥çœ‹å„ç®—æ³•æ‰§è¡Œæ•ˆæœã€‚</p>
</blockquote>
<h3 id="éšæœº"><a href="#éšæœº" class="headerlink" title="éšæœº"></a>éšæœº</h3><h4 id="éšæœºç®—æ³•"><a href="#éšæœºç®—æ³•" class="headerlink" title="éšæœºç®—æ³•"></a>éšæœºç®—æ³•</h4><p><strong><code>éšæœºï¼ˆRandomï¼‰</code></strong> ç®—æ³• <strong>å°†è¯·æ±‚éšæœºåˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨</strong>ã€‚</p>
<p>éšæœºç®—æ³• <strong>é€‚åˆæœåŠ¡å™¨ç¡¬ä»¶ç›¸åŒçš„åœºæ™¯</strong>ã€‚å­¦ä¹ è¿‡æ¦‚ç‡è®ºçš„éƒ½çŸ¥é“ï¼Œè°ƒç”¨é‡è¾ƒå°çš„æ—¶å€™ï¼Œå¯èƒ½è´Ÿè½½å¹¶ä¸å‡åŒ€ï¼Œ<strong>è°ƒç”¨é‡è¶Šå¤§ï¼Œè´Ÿè½½è¶Šå‡è¡¡</strong>ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165323.png" alt="img"></p>
<p>ã€ç¤ºä¾‹ã€‘éšæœºç®—æ³•å®ç°ç¤ºä¾‹</p>
<p>è´Ÿè½½å‡è¡¡æ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">LoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">    N <span class="title function_">select</span><span class="params">(List&lt;N&gt; nodes, String ip)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è´Ÿè½½å‡è¡¡æŠ½è±¡ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> N <span class="title function_">select</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtil.isEmpty(nodes)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœ nodes åˆ—è¡¨ä¸­ä»…æœ‰ä¸€ä¸ª nodeï¼Œç›´æ¥è¿”å›å³å¯ï¼Œæ— éœ€è¿›è¡Œè´Ÿè½½å‡è¡¡</span></span><br><span class="line">        <span class="keyword">if</span> (nodes.size() == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> nodes.get(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> doSelect(nodes, ip);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨èŠ‚ç‚¹ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Node</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Node&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String url;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Integer weight;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Integer active;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éšæœºç®—æ³•å®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RandomLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">extends</span> <span class="title class_">BaseLoadBalance</span>&lt;N&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line">        <span class="comment">// åœ¨åˆ—è¡¨ä¸­éšæœºé€‰å–ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> random.nextInt(nodes.size());</span><br><span class="line">        <span class="keyword">return</span> nodes.get(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åŠ æƒéšæœºç®—æ³•"><a href="#åŠ æƒéšæœºç®—æ³•" class="headerlink" title="åŠ æƒéšæœºç®—æ³•"></a>åŠ æƒéšæœºç®—æ³•</h4><p><strong><code>åŠ æƒéšæœºï¼ˆWeighted Randomï¼‰</code></strong> ç®—æ³•åœ¨éšæœºç®—æ³•çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§æ¦‚ç‡è°ƒæ•´æƒé‡ï¼Œè¿›è¡Œè´Ÿè½½åˆ†é…ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘åŠ æƒéšæœºç®—æ³•å®ç°ç¤ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeightRandomLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">extends</span> <span class="title class_">BaseLoadBalance</span>&lt;N&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> ThreadLocalRandom.current();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nodes.size();</span><br><span class="line">        <span class="type">AtomicInteger</span> <span class="variable">totalWeight</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (N node : nodes) &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">weight</span> <span class="operator">=</span> node.getWeight();</span><br><span class="line">            totalWeight.getAndAdd(weight);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (totalWeight.get() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> random.nextInt(totalWeight.get());</span><br><span class="line">            <span class="keyword">for</span> (N node : nodes) &#123;</span><br><span class="line">                <span class="comment">// è®©éšæœºå€¼ offset å‡å»æƒé‡å€¼</span></span><br><span class="line">                offset -= node.getWeight();</span><br><span class="line">                <span class="keyword">if</span> (offset &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">// è¿”å›ç›¸åº”çš„ Node</span></span><br><span class="line">                    <span class="keyword">return</span> node;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç›´æ¥éšæœºè¿”å›ä¸€ä¸ª</span></span><br><span class="line">        <span class="keyword">return</span> nodes.get(random.nextInt(length));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è½®è¯¢"><a href="#è½®è¯¢" class="headerlink" title="è½®è¯¢"></a>è½®è¯¢</h3><h4 id="è½®è¯¢ç®—æ³•"><a href="#è½®è¯¢ç®—æ³•" class="headerlink" title="è½®è¯¢ç®—æ³•"></a>è½®è¯¢ç®—æ³•</h4><p><strong><code>è½®è¯¢ï¼ˆRound Robinï¼‰</code></strong> ç®—æ³•çš„ç­–ç•¥æ˜¯ï¼š<strong>å°†è¯·æ±‚ä¾æ¬¡åˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨</strong>ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè´Ÿè½½å‡è¡¡å™¨æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„ 6 ä¸ªè¯·æ±‚ï¼Œ(1, 3, 5) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(2, 4, 6) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415164758.png" alt="img"></p>
<p>è¯¥ç®—æ³•é€‚åˆåœºæ™¯ï¼šå„æœåŠ¡å™¨å¤„ç†èƒ½åŠ›ç›¸è¿‘ï¼Œä¸”æ¯ä¸ªäº‹åŠ¡å·¥ä½œé‡å·®å¼‚ä¸å¤§ã€‚å¦‚æœå­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œé‚£ä¹ˆå¤„ç†è¾ƒæ…¢çš„æœåŠ¡å™¨å°±å¯èƒ½ä¼šç§¯å‹è¯·æ±‚ï¼Œæœ€ç»ˆæ— æ³•æ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165041.png" alt="img"></p>
<p>ã€ç¤ºä¾‹ã€‘è½®è¯¢ç®—æ³•ç¤ºä¾‹</p>
<p>è½®è¯¢è´Ÿè½½å‡è¡¡ç®—æ³•å®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RoundRobinLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">extends</span> <span class="title class_">BaseLoadBalance</span>&lt;N&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">position</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nodes.size();</span><br><span class="line">        <span class="comment">// å¦‚æœä½ç½®å€¼å·²ç»ç­‰äºèŠ‚ç‚¹æ•°ï¼Œé‡ç½®ä¸º 0</span></span><br><span class="line">        position.compareAndSet(length, <span class="number">0</span>);</span><br><span class="line">        <span class="type">N</span> <span class="variable">node</span> <span class="operator">=</span> nodes.get(position.get());</span><br><span class="line">        position.getAndIncrement();</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åŠ æƒè½®è¯¢ç®—æ³•"><a href="#åŠ æƒè½®è¯¢ç®—æ³•" class="headerlink" title="åŠ æƒè½®è¯¢ç®—æ³•"></a>åŠ æƒè½®è¯¢ç®—æ³•</h4><p><strong><code>åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robbinï¼‰</code></strong> ç®—æ³•åœ¨è½®è¯¢ç®—æ³•çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†æƒé‡å±æ€§æ¥è°ƒèŠ‚è½¬å‘æœåŠ¡å™¨çš„è¯·æ±‚æ•°ç›®ã€‚æ€§èƒ½é«˜ã€å¤„ç†é€Ÿåº¦å¿«çš„èŠ‚ç‚¹åº”è¯¥è®¾ç½®æ›´é«˜çš„æƒé‡ï¼Œä½¿å¾—åˆ†å‘æ—¶ä¼˜å…ˆå°†è¯·æ±‚åˆ†å‘åˆ°æƒé‡è¾ƒé«˜çš„èŠ‚ç‚¹ä¸Šã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒæœåŠ¡å™¨ A è®¾ç½®æƒé‡ä¸º 5ï¼ŒæœåŠ¡å™¨ B è®¾ç½®æƒé‡ä¸º 1ï¼Œè´Ÿè½½å‡è¡¡å™¨æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„ 6 ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆ (1, 2, 3, 4, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ Aï¼Œ(6) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ Bã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165140.png" alt="img"></p>
<p>ã€ç¤ºä¾‹ã€‘åŠ æƒè½®è¯¢ç®—æ³•å®ç°ç¤ºä¾‹</p>
<p>ä»¥ä¸‹å®ç°åŸºäº Dubbo åŠ æƒè½®è¯¢ç®—æ³•åšäº†ä¸€äº›ç®€åŒ–ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeightRoundRobinLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">extends</span> <span class="title class_">BaseLoadBalance</span>&lt;N&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 60ç§’</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">RECYCLE_PERIOD</span> <span class="operator">=</span> <span class="number">60000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Node hashcode åˆ° WeightedRoundRobin çš„æ˜ å°„å…³ç³»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> ConcurrentMap&lt;Integer, WeightedRoundRobin&gt; weightMap = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŸå­æ›´æ–°é”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">AtomicBoolean</span> <span class="variable">updateLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicBoolean</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">totalWeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">maxCurrent</span> <span class="operator">=</span> Long.MIN_VALUE;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–å½“å‰æ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">now</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">N</span> <span class="variable">selectedNode</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">WeightedRoundRobin</span> <span class="variable">selectedWRR</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸‹é¢è¿™ä¸ªå¾ªç¯ä¸»è¦åšäº†è¿™æ ·å‡ ä»¶äº‹æƒ…ï¼š</span></span><br><span class="line">        <span class="comment">//   1. éå† Node åˆ—è¡¨ï¼Œæ£€æµ‹å½“å‰ Node æ˜¯å¦æœ‰ç›¸åº”çš„ WeightedRoundRobinï¼Œæ²¡æœ‰åˆ™åˆ›å»º</span></span><br><span class="line">        <span class="comment">//   2. æ£€æµ‹ Node æƒé‡æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œè‹¥å˜åŒ–äº†ï¼Œåˆ™æ›´æ–° WeightedRoundRobin çš„ weight å­—æ®µ</span></span><br><span class="line">        <span class="comment">//   3. è®© current å­—æ®µåŠ ä¸Šè‡ªèº«æƒé‡ï¼Œç­‰ä»·äº current += weight</span></span><br><span class="line">        <span class="comment">//   4. è®¾ç½® lastUpdate å­—æ®µï¼Œå³ lastUpdate = now</span></span><br><span class="line">        <span class="comment">//   5. å¯»æ‰¾å…·æœ‰æœ€å¤§ current çš„ Nodeï¼Œä»¥åŠ Node å¯¹åº”çš„ WeightedRoundRobinï¼Œ</span></span><br><span class="line">        <span class="comment">//      æš‚å­˜èµ·æ¥ï¼Œç•™ä½œåç”¨</span></span><br><span class="line">        <span class="comment">//   6. è®¡ç®—æƒé‡æ€»å’Œ</span></span><br><span class="line">        <span class="keyword">for</span> (N node : nodes) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">hashCode</span> <span class="operator">=</span> node.hashCode();</span><br><span class="line">            <span class="type">WeightedRoundRobin</span> <span class="variable">weightedRoundRobin</span> <span class="operator">=</span> weightMap.get(hashCode);</span><br><span class="line">            <span class="type">int</span> <span class="variable">weight</span> <span class="operator">=</span> node.getWeight();</span><br><span class="line">            <span class="keyword">if</span> (weight &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                weight = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ£€æµ‹å½“å‰ Node æ˜¯å¦æœ‰å¯¹åº”çš„ WeightedRoundRobinï¼Œæ²¡æœ‰åˆ™åˆ›å»º</span></span><br><span class="line">            <span class="keyword">if</span> (weightedRoundRobin == <span class="literal">null</span>) &#123;</span><br><span class="line">                weightedRoundRobin = <span class="keyword">new</span> <span class="title class_">WeightedRoundRobin</span>();</span><br><span class="line">                <span class="comment">// è®¾ç½® Node æƒé‡</span></span><br><span class="line">                weightedRoundRobin.setWeight(weight);</span><br><span class="line">                <span class="comment">// å­˜å‚¨ url å”¯ä¸€æ ‡è¯† identifyString åˆ° weightedRoundRobin çš„æ˜ å°„å…³ç³»</span></span><br><span class="line">                weightMap.putIfAbsent(hashCode, weightedRoundRobin);</span><br><span class="line">                weightedRoundRobin = weightMap.get(hashCode);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Node æƒé‡ä¸ç­‰äº WeightedRoundRobin ä¸­ä¿å­˜çš„æƒé‡ï¼Œè¯´æ˜æƒé‡å˜åŒ–äº†ï¼Œæ­¤æ—¶è¿›è¡Œæ›´æ–°</span></span><br><span class="line">            <span class="keyword">if</span> (weight != weightedRoundRobin.getWeight()) &#123;</span><br><span class="line">                weightedRoundRobin.setWeight(weight);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®© current åŠ ä¸Šè‡ªèº«æƒé‡ï¼Œç­‰ä»·äº current += weight</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">current</span> <span class="operator">=</span> weightedRoundRobin.increaseCurrent();</span><br><span class="line">            <span class="comment">// è®¾ç½® lastUpdateï¼Œè¡¨ç¤ºè¿‘æœŸæ›´æ–°è¿‡</span></span><br><span class="line">            weightedRoundRobin.setLastUpdate(now);</span><br><span class="line">            <span class="comment">// æ‰¾å‡ºæœ€å¤§çš„ current</span></span><br><span class="line">            <span class="keyword">if</span> (current &gt; maxCurrent) &#123;</span><br><span class="line">                maxCurrent = current;</span><br><span class="line">                <span class="comment">// å°†å…·æœ‰æœ€å¤§ current æƒé‡çš„ Node èµ‹å€¼ç»™ selectedNode</span></span><br><span class="line">                selectedNode = node;</span><br><span class="line">                <span class="comment">// å°† Node å¯¹åº”çš„ weightedRoundRobin èµ‹å€¼ç»™ selectedWRRï¼Œç•™ä½œåç”¨</span></span><br><span class="line">                selectedWRR = weightedRoundRobin;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®¡ç®—æƒé‡æ€»å’Œ</span></span><br><span class="line">            totalWeight += weight;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹ weightMap è¿›è¡Œæ£€æŸ¥ï¼Œè¿‡æ»¤æ‰é•¿æ—¶é—´æœªè¢«æ›´æ–°çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        <span class="comment">// è¯¥èŠ‚ç‚¹å¯èƒ½æŒ‚äº†ï¼Œnodes ä¸­ä¸åŒ…å«è¯¥èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¯¥èŠ‚ç‚¹çš„ lastUpdate é•¿æ—¶é—´æ— æ³•è¢«æ›´æ–°ã€‚</span></span><br><span class="line">        <span class="comment">// è‹¥æœªæ›´æ–°æ—¶é•¿è¶…è¿‡é˜ˆå€¼åï¼Œå°±ä¼šè¢«ç§»é™¤æ‰ï¼Œé»˜è®¤é˜ˆå€¼ä¸º60ç§’ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (!updateLock.get() &amp;&amp; nodes.size() != weightMap.size()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (updateLock.compareAndSet(<span class="literal">false</span>, <span class="literal">true</span>)) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// éå†ä¿®æ”¹ï¼Œå³ç§»é™¤è¿‡æœŸè®°å½•</span></span><br><span class="line">                    weightMap.entrySet().removeIf(item -&gt; now - item.getValue().getLastUpdate() &gt; RECYCLE_PERIOD);</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    updateLock.set(<span class="literal">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (selectedNode != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// è®© current å‡å»æƒé‡æ€»å’Œï¼Œç­‰ä»·äº current -= totalWeight</span></span><br><span class="line">            selectedWRR.decreaseCurrent(totalWeight);</span><br><span class="line">            <span class="comment">// è¿”å›å…·æœ‰æœ€å¤§ current çš„ Node</span></span><br><span class="line">            <span class="keyword">return</span> selectedNode;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// should not happen here</span></span><br><span class="line">        <span class="keyword">return</span> nodes.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WeightedRoundRobin</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æœåŠ¡æä¾›è€…æƒé‡</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> weight;</span><br><span class="line">        <span class="comment">// å½“å‰æƒé‡</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">AtomicLong</span> <span class="variable">current</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicLong</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// æœ€åä¸€æ¬¡æ›´æ–°æ—¶é—´</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">long</span> lastUpdate;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">increaseCurrent</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">// current = current + weightï¼›</span></span><br><span class="line">            <span class="keyword">return</span> current.addAndGet(weight);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">decreaseCurrent</span><span class="params">(<span class="type">int</span> total)</span> &#123;</span><br><span class="line">            <span class="comment">// current = current - total;</span></span><br><span class="line">            <span class="keyword">return</span> current.addAndGet(-<span class="number">1</span> * total);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getWeight</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> weight;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setWeight</span><span class="params">(<span class="type">int</span> weight)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.weight = weight;</span><br><span class="line">            <span class="comment">// åˆå§‹æƒ…å†µä¸‹ï¼Œcurrent = 0</span></span><br><span class="line">            current.set(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AtomicLong <span class="title function_">getCurrent</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> current;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCurrent</span><span class="params">(AtomicLong current)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.current = current;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getLastUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> lastUpdate;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLastUpdate</span><span class="params">(<span class="type">long</span> lastUpdate)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.lastUpdate = lastUpdate;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æœ€å°æ´»è·ƒæ•°"><a href="#æœ€å°æ´»è·ƒæ•°" class="headerlink" title="æœ€å°æ´»è·ƒæ•°"></a>æœ€å°æ´»è·ƒæ•°</h3><p><strong><code>æœ€å°æ´»è·ƒæ•°ï¼ˆLeast Activeï¼‰</code></strong> ç®—æ³• <strong>å°†è¯·æ±‚åˆ†å‘åˆ°è¿æ¥æ•°&#x2F;è¯·æ±‚æ•°æœ€å°‘çš„å€™é€‰æœåŠ¡å™¨</strong>ï¼ˆç›®å‰å¤„ç†è¯·æ±‚æœ€å°‘çš„æœåŠ¡å™¨ï¼‰ã€‚</p>
<ul>
<li>ç‰¹ç‚¹ï¼šæ ¹æ®å€™é€‰æœåŠ¡å™¨å½“å‰çš„è¯·æ±‚è¿æ¥æ•°ï¼ŒåŠ¨æ€åˆ†é…ã€‚</li>
<li>åœºæ™¯ï¼š<strong>é€‚ç”¨äºå¯¹ç³»ç»Ÿè´Ÿè½½è¾ƒä¸ºæ•æ„Ÿæˆ–è¯·æ±‚è¿æ¥æ—¶é•¿ç›¸å·®è¾ƒå¤§çš„åœºæ™¯</strong>ã€‚</li>
</ul>
<p>ç”±äºæ¯ä¸ªè¯·æ±‚çš„è¿æ¥æ—¶é•¿ä¸ä¸€æ ·ï¼Œå¦‚æœé‡‡ç”¨ç®€å•çš„è½®å¾ªæˆ–éšæœºç®—æ³•ï¼Œéƒ½å¯èƒ½å‡ºç°<strong>æŸäº›æœåŠ¡å™¨å½“å‰è¿æ¥æ•°è¿‡å¤§ï¼Œè€Œå¦ä¸€äº›æœåŠ¡å™¨çš„è¿æ¥è¿‡å°</strong>çš„æƒ…å†µï¼Œè¿™å°±é€ æˆäº†è´Ÿè½½å¹¶éçœŸæ­£å‡è¡¡ã€‚è™½ç„¶ï¼Œè½®è¯¢æˆ–ç®—æ³•éƒ½å¯ä»¥é€šè¿‡åŠ æƒé‡å±æ€§çš„æ–¹å¼è¿›è¡Œè´Ÿè½½è°ƒæ•´ï¼Œä½†åŠ æƒæ–¹å¼éš¾ä»¥åº”å¯¹åŠ¨æ€å˜åŒ–ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415171432.png" alt="img"></p>
<p>æœ€å°æ´»è·ƒæ•°ç®—æ³•ä¼šè®°å½•å½“å‰æ—¶åˆ»ï¼Œæ¯ä¸ªå€™é€‰èŠ‚ç‚¹æ­£åœ¨å¤„ç†çš„è¿æ¥æ•°ï¼Œç„¶åé€‰æ‹©è¿æ¥æ•°æœ€å°çš„èŠ‚ç‚¹ã€‚è¯¥ç­–ç•¥èƒ½å¤ŸåŠ¨æ€ã€å®æ—¶åœ°ååº”æœåŠ¡å™¨çš„å½“å‰çŠ¶å†µï¼Œè¾ƒä¸ºåˆç†åœ°å°†è´Ÿè´£åˆ†é…å‡åŒ€ï¼Œé€‚ç”¨äºå¯¹å½“å‰ç³»ç»Ÿè´Ÿè½½è¾ƒä¸ºæ•æ„Ÿçš„åœºæ™¯ã€‚</p>
<p>ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 å½“å‰è¿æ¥æ•°æœ€å°ï¼Œé‚£ä¹ˆæ–°åˆ°æ¥çš„è¯·æ±‚ 6 å°±ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1 ä¸Šã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165935.png" alt="img"></p>
<p>**<code>åŠ æƒæœ€å°æ´»è·ƒæ•°ï¼ˆWeighted Least Connectionï¼‰</code>**åœ¨æœ€å°æ´»è·ƒæ•°çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½ä¸ºæ¯å°æœåŠ¡å™¨åˆ†é…æƒé‡ï¼Œå†æ ¹æ®æƒé‡è®¡ç®—å‡ºæ¯å°æœåŠ¡å™¨èƒ½å¤„ç†çš„è¿æ¥æ•°ã€‚</p>
<p>æœ€å°æ´»è·ƒæ•°ç®—æ³•å®ç°è¦ç‚¹ï¼šæ´»è·ƒè°ƒç”¨æ•°è¶Šå°ï¼Œè¡¨æ˜è¯¥æœåŠ¡èŠ‚ç‚¹å¤„ç†èƒ½åŠ›è¶Šé«˜ï¼Œå•ä½æ—¶é—´å†…å¯å¤„ç†æ›´å¤šçš„è¯·æ±‚ï¼Œåº”ä¼˜å…ˆå°†è¯·æ±‚åˆ†å‘ç»™è¯¥æœåŠ¡ã€‚åœ¨å…·ä½“å®ç°ä¸­ï¼Œæ¯ä¸ªæœåŠ¡èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæ´»è·ƒæ•° activeã€‚åˆå§‹æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æœåŠ¡æä¾›è€…æ´»è·ƒæ•°å‡ä¸º 0ã€‚æ¯æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œæ´»è·ƒæ•°åŠ  1ï¼Œå®Œæˆè¯·æ±‚ååˆ™å°†æ´»è·ƒæ•°å‡ 1ã€‚åœ¨æœåŠ¡è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œæ€§èƒ½å¥½çš„æœåŠ¡æä¾›è€…å¤„ç†è¯·æ±‚çš„é€Ÿåº¦æ›´å¿«ï¼Œå› æ­¤æ´»è·ƒæ•°ä¸‹é™çš„ä¹Ÿè¶Šå¿«ï¼Œæ­¤æ—¶è¿™æ ·çš„æœåŠ¡æä¾›è€…èƒ½å¤Ÿä¼˜å…ˆè·å–åˆ°æ–°çš„æœåŠ¡è¯·æ±‚ã€è¿™å°±æ˜¯æœ€å°æ´»è·ƒæ•°è´Ÿè½½å‡è¡¡ç®—æ³•çš„åŸºæœ¬æ€æƒ³ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘æœ€å°æ´»è·ƒæ•°ç®—æ³•å®ç°</p>
<p>ä»¥ä¸‹å®ç°åŸºäº Dubbo æœ€å°æ´»è·ƒæ•°è´Ÿè½½å‡è¡¡ç®—æ³•åšäº†äº›è®¸æ”¹åŠ¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LeastActiveLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">extends</span> <span class="title class_">BaseLoadBalance</span>&lt;N&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nodes.size();</span><br><span class="line">        <span class="comment">// æœ€å°çš„æ´»è·ƒæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">leastActive</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// å…·æœ‰ç›¸åŒâ€œæœ€å°æ´»è·ƒæ•°â€çš„æœåŠ¡è€…æä¾›è€…ï¼ˆä»¥ä¸‹ç”¨ Node ä»£ç§°ï¼‰æ•°é‡</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">leastCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// leastIndexs ç”¨äºè®°å½•å…·æœ‰ç›¸åŒâ€œæœ€å°æ´»è·ƒæ•°â€çš„ Node åœ¨ nodes åˆ—è¡¨ä¸­çš„ä¸‹æ ‡ä¿¡æ¯</span></span><br><span class="line">        <span class="type">int</span>[] leastIndexs = <span class="keyword">new</span> <span class="title class_">int</span>[length];</span><br><span class="line">        <span class="type">int</span> <span class="variable">totalWeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªæœ€å°æ´»è·ƒæ•°çš„ Node æƒé‡å€¼ï¼Œç”¨äºä¸å…¶ä»–å…·æœ‰ç›¸åŒæœ€å°æ´»è·ƒæ•°çš„ Node çš„æƒé‡è¿›è¡Œå¯¹æ¯”ï¼Œ</span></span><br><span class="line">        <span class="comment">// ä»¥æ£€æµ‹æ˜¯å¦â€œæ‰€æœ‰å…·æœ‰ç›¸åŒæœ€å°æ´»è·ƒæ•°çš„ Node çš„æƒé‡â€å‡ç›¸ç­‰</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">firstWeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">sameWeight</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éå† nodes åˆ—è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="type">N</span> <span class="variable">node</span> <span class="operator">=</span> nodes.get(i);</span><br><span class="line">            <span class="comment">// å‘ç°æ›´å°çš„æ´»è·ƒæ•°ï¼Œé‡æ–°å¼€å§‹</span></span><br><span class="line">            <span class="keyword">if</span> (leastActive == -<span class="number">1</span> || node.getActive() &lt; leastActive) &#123;</span><br><span class="line">                <span class="comment">// ä½¿ç”¨å½“å‰æ´»è·ƒæ•°æ›´æ–°æœ€å°æ´»è·ƒæ•° leastActive</span></span><br><span class="line">                leastActive = node.getActive();</span><br><span class="line">                <span class="comment">// æ›´æ–° leastCount ä¸º 1</span></span><br><span class="line">                leastCount = <span class="number">1</span>;</span><br><span class="line">                <span class="comment">// è®°å½•å½“å‰ä¸‹æ ‡å€¼åˆ° leastIndexs ä¸­</span></span><br><span class="line">                leastIndexs[<span class="number">0</span>] = i;</span><br><span class="line">                totalWeight = node.getWeight();</span><br><span class="line">                firstWeight = node.getWeight();</span><br><span class="line">                sameWeight = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å½“å‰ Node çš„æ´»è·ƒæ•° node.getActive() ä¸æœ€å°æ´»è·ƒæ•° leastActive ç›¸åŒ</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.getActive() == leastActive) &#123;</span><br><span class="line">                <span class="comment">// åœ¨ leastIndexs ä¸­è®°å½•ä¸‹å½“å‰ Node åœ¨ nodes é›†åˆä¸­çš„ä¸‹æ ‡</span></span><br><span class="line">                leastIndexs[leastCount++] = i;</span><br><span class="line">                <span class="comment">// ç´¯åŠ æƒé‡</span></span><br><span class="line">                totalWeight += node.getWeight();</span><br><span class="line">                <span class="comment">// æ£€æµ‹å½“å‰ Node çš„æƒé‡ä¸ firstWeight æ˜¯å¦ç›¸ç­‰ï¼Œ</span></span><br><span class="line">                <span class="comment">// ä¸ç›¸ç­‰åˆ™å°† sameWeight ç½®ä¸º false</span></span><br><span class="line">                <span class="keyword">if</span> (sameWeight &amp;&amp; i &gt; <span class="number">0</span></span><br><span class="line">                    &amp;&amp; node.getWeight() != firstWeight) &#123;</span><br><span class="line">                    sameWeight = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å½“åªæœ‰ä¸€ä¸ª Node å…·æœ‰æœ€å°æ´»è·ƒæ•°ï¼Œæ­¤æ—¶ç›´æ¥è¿”å›è¯¥ Node å³å¯</span></span><br><span class="line">        <span class="keyword">if</span> (leastCount == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> nodes.get(leastIndexs[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æœ‰å¤šä¸ª Node å…·æœ‰ç›¸åŒçš„æœ€å°æ´»è·ƒæ•°ï¼Œä½†å®ƒä»¬ä¹‹é—´çš„æƒé‡ä¸åŒ</span></span><br><span class="line">        <span class="keyword">if</span> (!sameWeight &amp;&amp; totalWeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// éšæœºç”Ÿæˆä¸€ä¸ª [0, totalWeight) ä¹‹é—´çš„æ•°å­—</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">offsetWeight</span> <span class="operator">=</span> random.nextInt(totalWeight);</span><br><span class="line">            <span class="comment">// å¾ªç¯è®©éšæœºæ•°å‡å»å…·æœ‰æœ€å°æ´»è·ƒæ•°çš„ Node çš„æƒé‡å€¼ï¼Œ</span></span><br><span class="line">            <span class="comment">// å½“ offset å°äºç­‰äº0æ—¶ï¼Œè¿”å›ç›¸åº”çš„ Node</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; leastCount; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">leastIndex</span> <span class="operator">=</span> leastIndexs[i];</span><br><span class="line">                <span class="comment">// è·å–æƒé‡å€¼ï¼Œå¹¶è®©éšæœºæ•°å‡å»æƒé‡å€¼</span></span><br><span class="line">                offsetWeight -= nodes.get(leastIndex).getWeight();</span><br><span class="line">                <span class="keyword">if</span> (offsetWeight &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> nodes.get(leastIndex);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæƒé‡ç›¸åŒæˆ–æƒé‡ä¸º0æ—¶ï¼Œéšæœºè¿”å›ä¸€ä¸ª Node</span></span><br><span class="line">        <span class="keyword">return</span> nodes.get(leastIndexs[random.nextInt(leastCount)]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å“ˆå¸Œ"><a href="#å“ˆå¸Œ" class="headerlink" title="å“ˆå¸Œ"></a>å“ˆå¸Œ</h3><p><strong><code>å“ˆå¸Œï¼ˆHashï¼‰</code></strong> ç®—æ³•<strong>æ ¹æ®ä¸€ä¸ª key ï¼ˆå¯ä»¥æ˜¯å”¯ä¸€ IDã€IP ç­‰ï¼‰ï¼Œé€šè¿‡å“ˆå¸Œè®¡ç®—å¾—åˆ°ä¸€ä¸ªæ•°å€¼ï¼Œç”¨è¯¥æ•°å€¼åœ¨å€™é€‰æœåŠ¡å™¨åˆ—è¡¨çš„è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœä¾¿æ˜¯é€‰ä¸­çš„æœåŠ¡å™¨</strong>ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415172716.png" alt="img"></p>
<p>å¯ä»¥ä¿è¯åŒä¸€ IP çš„å®¢æˆ·ç«¯çš„è¯·æ±‚ä¼šè½¬å‘åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œç”¨æ¥å®ç°ä¼šè¯ç²˜æ»ï¼ˆSticky Sessionï¼‰ã€‚</p>
<ul>
<li>ç‰¹ç‚¹ï¼šä¿è¯ç‰¹å®šç”¨æˆ·æ€»æ˜¯è¯·æ±‚åˆ°ç›¸åŒçš„æœåŠ¡å™¨ï¼Œè‹¥æœåŠ¡å™¨å®•æœºï¼Œä¼šè¯ä¼šä¸¢å¤±ã€‚</li>
</ul>
<p>ã€ç¤ºä¾‹ã€‘æºåœ°å€å“ˆå¸Œç®—æ³•å®ç°ç¤ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IpHashLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">extends</span> <span class="title class_">BaseLoadBalance</span>&lt;N&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isBlank(ip)) &#123;</span><br><span class="line">            ip = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nodes.size();</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hash(ip) % length;</span><br><span class="line">        <span class="keyword">return</span> nodes.get(index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(String text)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> HashUtil.fnvHash(text);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸€è‡´æ€§å“ˆå¸Œ"><a href="#ä¸€è‡´æ€§å“ˆå¸Œ" class="headerlink" title="ä¸€è‡´æ€§å“ˆå¸Œ"></a>ä¸€è‡´æ€§å“ˆå¸Œ</h3><p><strong><code>ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰</code></strong> ç®—æ³•çš„ç›®æ ‡æ˜¯ï¼š<strong>ç›¸åŒçš„è¯·æ±‚å°½å¯èƒ½è½åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Š</strong>ã€‚</p>
<p><strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong> å¯ä»¥å¾ˆå¥½çš„è§£å†³ <strong>ç¨³å®šæ€§é—®é¢˜</strong>ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„å­˜å‚¨èŠ‚ç‚¹æ’åˆ—åœ¨é¦–å°¾ç›¸æ¥çš„ <code>Hash</code> ç¯ä¸Šï¼Œæ¯ä¸ª <code>key</code> åœ¨è®¡ç®— <code>Hash</code> åä¼š <strong>é¡ºæ—¶é’ˆ</strong> æ‰¾åˆ° <strong>é‚»æ¥</strong> çš„å­˜å‚¨èŠ‚ç‚¹å­˜æ”¾ã€‚è€Œå½“æœ‰èŠ‚ç‚¹ <strong>åŠ å…¥</strong> æˆ– <strong>é€€å‡º</strong> æ—¶ï¼Œä»…å½±å“è¯¥èŠ‚ç‚¹åœ¨ <code>Hash</code> ç¯ä¸Š <strong>é¡ºæ—¶é’ˆç›¸é‚»</strong> çš„ <strong>åç»­èŠ‚ç‚¹</strong>ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/partition-consistent-hash.png" alt="img"></p>
<ul>
<li><strong>ç›¸åŒçš„è¯·æ±‚</strong>æ˜¯æŒ‡ï¼šä¸€èˆ¬åœ¨ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œæ—¶ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ª key ç”¨äº hash è®¡ç®—ï¼Œå¯èƒ½æ˜¯ï¼šç”¨æˆ· IDã€è¯·æ±‚æ–¹ IPã€è¯·æ±‚æœåŠ¡åç§°ï¼Œå‚æ•°åˆ—è¡¨æ„æˆçš„ä¸²</li>
<li><strong>å°½å¯èƒ½</strong>æ˜¯æŒ‡ï¼šæœåŠ¡å™¨å¯èƒ½å‘ç”Ÿä¸Šä¸‹çº¿ï¼Œå°‘æ•°æœåŠ¡å™¨çš„å˜åŒ–ä¸åº”è¯¥å½±å“å¤§å¤šæ•°çš„è¯·æ±‚ã€‚</li>
</ul>
<p>å½“æŸå°å€™é€‰æœåŠ¡å™¨å®•æœºæ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¼šåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒå€™é€‰æœåŠ¡å™¨ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚</p>
<ul>
<li><strong>ä¼˜ç‚¹</strong></li>
</ul>
<p><strong>åŠ å…¥</strong> å’Œ <strong>åˆ é™¤</strong> èŠ‚ç‚¹åªå½±å“ <strong>å“ˆå¸Œç¯</strong> ä¸­ <strong>é¡ºæ—¶é’ˆæ–¹å‘</strong> çš„ <strong>ç›¸é‚»çš„èŠ‚ç‚¹</strong>ï¼Œå¯¹å…¶ä»–èŠ‚ç‚¹æ— å½±å“ã€‚</p>
<ul>
<li><strong>ç¼ºç‚¹</strong></li>
</ul>
<p><strong>åŠ å‡èŠ‚ç‚¹</strong> ä¼šé€ æˆ <strong>å“ˆå¸Œç¯</strong> ä¸­éƒ¨åˆ†æ•°æ® <strong>æ— æ³•å‘½ä¸­</strong>ã€‚å½“ä½¿ç”¨ <strong>å°‘é‡èŠ‚ç‚¹</strong> æ—¶ï¼Œ<strong>èŠ‚ç‚¹å˜åŒ–</strong> å°†å¤§èŒƒå›´å½±å“ <strong>å“ˆå¸Œç¯</strong> ä¸­ <strong>æ•°æ®æ˜ å°„</strong>ï¼Œä¸é€‚åˆ <strong>å°‘é‡æ•°æ®èŠ‚ç‚¹</strong> çš„åˆ†å¸ƒå¼æ–¹æ¡ˆã€‚<strong>æ™®é€š</strong> çš„ <strong>ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº</strong> åœ¨å¢å‡èŠ‚ç‚¹æ—¶éœ€è¦ <strong>å¢åŠ ä¸€å€</strong> æˆ– <strong>å‡å»ä¸€åŠ</strong> èŠ‚ç‚¹æ‰èƒ½ä¿è¯ <strong>æ•°æ®</strong> å’Œ <strong>è´Ÿè½½çš„å‡è¡¡</strong>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå› ä¸º <strong>ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº</strong> çš„è¿™äº›ç¼ºç‚¹ï¼Œä¸€äº›åˆ†å¸ƒå¼ç³»ç»Ÿé‡‡ç”¨ <strong>è™šæ‹Ÿæ§½</strong> å¯¹ <strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong> è¿›è¡Œæ”¹è¿›ï¼Œæ¯”å¦‚ <code>Dynamo</code> ç³»ç»Ÿã€Redisã€‚</p>
</blockquote>
<p>ã€ç¤ºä¾‹ã€‘ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ç¤ºä¾‹</p>
<p>ä»¥ä¸‹ç¤ºä¾‹åŸºäº Dubbo çš„ä¸€è‡´æ€§å“ˆå¸Œè´Ÿè½½å‡è¡¡ç®—æ³•åšäº†ä¸€äº›ç®€åŒ–ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsistentHashLoadBalance</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; <span class="keyword">extends</span> <span class="title class_">BaseLoadBalance</span>&lt;N&gt; <span class="keyword">implements</span> <span class="title class_">LoadBalance</span>&lt;N&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ConcurrentMap&lt;String, ConsistentHashSelector&lt;?&gt;&gt; selectors = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> N <span class="title function_">doSelect</span><span class="params">(List&lt;N&gt; nodes, String ip)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ†ç‰‡æ•°ï¼Œè¿™é‡Œè®¾ä¸ºèŠ‚ç‚¹æ•°çš„ 4 å€</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">replicaNum</span> <span class="operator">=</span> nodes.size() * <span class="number">4</span>;</span><br><span class="line">        <span class="comment">// è·å– nodes åŸå§‹çš„ hashcode</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">identityHashCode</span> <span class="operator">=</span> System.identityHashCode(nodes);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœ nodes æ˜¯ä¸€ä¸ªæ–°çš„ List å¯¹è±¡ï¼Œæ„å‘³ç€èŠ‚ç‚¹æ•°é‡å‘ç”Ÿäº†å˜åŒ–</span></span><br><span class="line">        <span class="comment">// æ­¤æ—¶ selector.identityHashCode != identityHashCode æ¡ä»¶æˆç«‹</span></span><br><span class="line">        ConsistentHashSelector&lt;N&gt; selector = (ConsistentHashSelector&lt;N&gt;) selectors.get(ip);</span><br><span class="line">        <span class="keyword">if</span> (selector == <span class="literal">null</span> || selector.identityHashCode != identityHashCode) &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæ–°çš„ ConsistentHashSelector</span></span><br><span class="line">            selectors.put(ip, <span class="keyword">new</span> <span class="title class_">ConsistentHashSelector</span>&lt;&gt;(nodes, identityHashCode, replicaNum));</span><br><span class="line">            selector = (ConsistentHashSelector&lt;N&gt;) selectors.get(ip);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ ConsistentHashSelector çš„ select æ–¹æ³•é€‰æ‹© Node</span></span><br><span class="line">        <span class="keyword">return</span> selector.select(ip);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸€è‡´æ€§å“ˆå¸Œé€‰æ‹©å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ConsistentHashSelector</span>&lt;N <span class="keyword">extends</span> <span class="title class_">Node</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å­˜å‚¨è™šæ‹ŸèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> TreeMap&lt;Long, N&gt; virtualNodes;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> identityHashCode;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ„é€ å™¨</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> nodes            èŠ‚ç‚¹åˆ—è¡¨</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> identityHashCode hashcode</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> replicaNum       åˆ†ç‰‡æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        ConsistentHashSelector(List&lt;N&gt; nodes, <span class="type">int</span> identityHashCode, Integer replicaNum) &#123;</span><br><span class="line">            <span class="built_in">this</span>.virtualNodes = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;();</span><br><span class="line">            <span class="built_in">this</span>.identityHashCode = identityHashCode;</span><br><span class="line">            <span class="comment">// è·å–è™šæ‹ŸèŠ‚ç‚¹æ•°ï¼Œé»˜è®¤ä¸º 100</span></span><br><span class="line">            <span class="keyword">if</span> (replicaNum == <span class="literal">null</span>) &#123;</span><br><span class="line">                replicaNum = <span class="number">100</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (N node : nodes) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; replicaNum / <span class="number">4</span>; i++) &#123;</span><br><span class="line">                    <span class="comment">// å¯¹ url è¿›è¡Œ md5 è¿ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º16çš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line">                    <span class="type">byte</span>[] digest = md5(node.getUrl());</span><br><span class="line">                    <span class="comment">// å¯¹ digest éƒ¨åˆ†å­—èŠ‚è¿›è¡Œ 4 æ¬¡ hash è¿ç®—ï¼Œå¾—åˆ°å››ä¸ªä¸åŒçš„ long å‹æ­£æ•´æ•°</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                        <span class="comment">// h = 0 æ—¶ï¼Œå– digest ä¸­ä¸‹æ ‡ä¸º 0 ~ 3 çš„4ä¸ªå­—èŠ‚è¿›è¡Œä½è¿ç®—</span></span><br><span class="line">                        <span class="comment">// h = 1 æ—¶ï¼Œå– digest ä¸­ä¸‹æ ‡ä¸º 4 ~ 7 çš„4ä¸ªå­—èŠ‚è¿›è¡Œä½è¿ç®—</span></span><br><span class="line">                        <span class="comment">// h = 2, h = 3 æ—¶è¿‡ç¨‹åŒä¸Š</span></span><br><span class="line">                        <span class="type">long</span> <span class="variable">m</span> <span class="operator">=</span> hash(digest, j);</span><br><span class="line">                        <span class="comment">// å°† hash åˆ° node çš„æ˜ å°„å…³ç³»å­˜å‚¨åˆ° virtualNodes ä¸­ï¼Œ</span></span><br><span class="line">                        <span class="comment">// virtualNodes éœ€è¦æä¾›é«˜æ•ˆçš„æŸ¥è¯¢æ“ä½œï¼Œå› æ­¤é€‰ç”¨ TreeMap ä½œä¸ºå­˜å‚¨ç»“æ„</span></span><br><span class="line">                        virtualNodes.put(m, node);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> N <span class="title function_">select</span><span class="params">(String key)</span> &#123;</span><br><span class="line">            <span class="comment">// å¯¹å‚æ•° key è¿›è¡Œ md5 è¿ç®—</span></span><br><span class="line">            <span class="type">byte</span>[] digest = md5(key);</span><br><span class="line">            <span class="comment">// å– digest æ•°ç»„çš„å‰å››ä¸ªå­—èŠ‚è¿›è¡Œ hash è¿ç®—ï¼Œå†å°† hash å€¼ä¼ ç»™ selectForKey æ–¹æ³•ï¼Œ</span></span><br><span class="line">            <span class="comment">// å¯»æ‰¾åˆé€‚çš„ Node</span></span><br><span class="line">            <span class="keyword">return</span> selectForKey(hash(digest, <span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> N <span class="title function_">selectForKey</span><span class="params">(<span class="type">long</span> hash)</span> &#123;</span><br><span class="line">            <span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºæˆ–ç­‰äºå½“å‰ hash çš„èŠ‚ç‚¹</span></span><br><span class="line">            Map.Entry&lt;Long, N&gt; entry = virtualNodes.ceilingEntry(hash);</span><br><span class="line">            <span class="comment">// å¦‚æœ hash å¤§äº Node åœ¨å“ˆå¸Œç¯ä¸Šæœ€å¤§çš„ä½ç½®ï¼Œæ­¤æ—¶ entry = nullï¼Œ</span></span><br><span class="line">            <span class="comment">// éœ€è¦å°† TreeMap çš„å¤´èŠ‚ç‚¹èµ‹å€¼ç»™ entry</span></span><br><span class="line">            <span class="keyword">if</span> (entry == <span class="literal">null</span>) &#123;</span><br><span class="line">                entry = virtualNodes.firstEntry();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¿”å› Node</span></span><br><span class="line">            <span class="keyword">return</span> entry.getValue();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¡ç®— hash å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">hash</span><span class="params">(<span class="type">byte</span>[] digest, <span class="type">int</span> number)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (((<span class="type">long</span>) (digest[<span class="number">3</span> + number * <span class="number">4</span>] &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>)</span><br><span class="line">            | ((<span class="type">long</span>) (digest[<span class="number">2</span> + number * <span class="number">4</span>] &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">16</span>)</span><br><span class="line">            | ((<span class="type">long</span>) (digest[<span class="number">1</span> + number * <span class="number">4</span>] &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">8</span>)</span><br><span class="line">            | (digest[number * <span class="number">4</span>] &amp; <span class="number">0xFF</span>))</span><br><span class="line">            &amp; <span class="number">0xFFFFFFFFL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¡ç®— MD5 å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] md5(String value) &#123;</span><br><span class="line">        MessageDigest md5;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            md5 = MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        md5.reset();</span><br><span class="line">        <span class="type">byte</span>[] bytes = value.getBytes(StandardCharsets.UTF_8);</span><br><span class="line">        md5.update(bytes);</span><br><span class="line">        <span class="keyword">return</span> md5.digest();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?reload=9&app=desktop&v=iqOTT7_7qXY">Comparing Load Balancing Algorithms</a></li>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/11322972.html">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/itfly8/p/5043435.html">å¤§å‹ç½‘ç«™æ¶æ„ç³»åˆ—ï¼šè´Ÿè½½å‡è¡¡è¯¦è§£ï¼ˆ1ï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/32841479">ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡</a></li>
<li><a target="_blank" rel="noopener" href="https://avinetworks.com/what-is-load-balancing/">What Is Load Balancing</a></li>
<li><a target="_blank" rel="noopener" href="https://dubbo.apache.org/zh/docs/v2.7/dev/source/loadbalance/">Dubbo å®˜æ–¹è´Ÿè½½å‡è¡¡ç®—æ³•è¯´æ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000004492447">è´Ÿè½½å‡è¡¡ç®—æ³•åŠæ‰‹æ®µ</a></li>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000002578457">åˆ©ç”¨ dns è§£ææ¥å®ç°ç½‘ç«™çš„è´Ÿè½½å‡è¡¡</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/db2390/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/db2390/" class="post-title-link" itemprop="url">ç³»ç»Ÿæ¶æ„æ¦‚è¿°</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-05 15:11:00" itemprop="dateCreated datePublished" datetime="2018-07-05T15:11:00+08:00">2018-07-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">è®¾è®¡</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">æ¶æ„</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>8.7k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>8 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ç³»ç»Ÿæ¶æ„æ¦‚è¿°"><a href="#ç³»ç»Ÿæ¶æ„æ¦‚è¿°" class="headerlink" title="ç³»ç»Ÿæ¶æ„æ¦‚è¿°"></a>ç³»ç»Ÿæ¶æ„æ¦‚è¿°</h1><h2 id="å¤§å‹ç³»ç»Ÿæ¶æ„æ¼”åŒ–"><a href="#å¤§å‹ç³»ç»Ÿæ¶æ„æ¼”åŒ–" class="headerlink" title="å¤§å‹ç³»ç»Ÿæ¶æ„æ¼”åŒ–"></a>å¤§å‹ç³»ç»Ÿæ¶æ„æ¼”åŒ–</h2><p>ä¸€ä¸ªå¤§å‹ç³»ç»Ÿçš„æ¶æ„æ˜¯ä¸€ä¸ªæ¸è¿›çš„æ¼”åŒ–è¿‡ç¨‹ã€‚ç½—é©¬ä¸æ˜¯ä¸€å¤©å»ºæˆçš„ï¼ŒåŒç†ï¼Œå¾®ä¿¡ã€æ·˜å®ç­‰å¤§å‹ç³»ç»Ÿç»ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ã€‚éšç€ä¸šåŠ¡çš„ä¸æ–­å‘å±•ï¼Œç”¨æˆ·ä½“é‡çš„å¢åŠ ï¼Œç³»ç»Ÿçš„å¤æ‚åº¦åŠ¿å¿…ä¸æ–­æ”€å‡ï¼Œæœ€ç»ˆè¿«ä½¿ç³»ç»Ÿæ¶æ„è¿›åŒ–ï¼Œä»¥åº”å¯¹æŒ‘æˆ˜ã€‚</p>
<p>äº†è§£å¤§å‹ç³»ç»Ÿæ¶æ„çš„æ¼”åŒ–è¿‡ç¨‹ï¼Œæœ‰åˆ©äºæˆ‘ä»¬äº†è§£æ¶æ„è¿›åŒ–çš„å‘å±•è§„å¾‹å’Œä¸šç•Œä¸€äº›æˆç†Ÿçš„åº”å¯¹æ–¹æ¡ˆã€‚å¸®åŠ©æˆ‘ä»¬åœ¨å®é™…å·¥ä½œä¸­ï¼Œå¦‚ä½•å»æ€è€ƒæ¶æ„ï¼Œå¦‚ä½•å»å‡ç»ƒè§£å†³æ–¹æ¡ˆã€‚</p>
<p>å¤§å‹ç³»ç»Ÿæ¶æ„æ¼”åŒ–æ¯”è¾ƒå…·æœ‰ä»£è¡¨æ€§çš„å°±æ˜¯å¤§å‹ç½‘ç«™çš„æ¼”åŒ–è¿‡ç¨‹ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹å¤§å‹ç½‘ç«™æ¼”åŒ–çš„ä¸€èˆ¬è§„å¾‹ã€‚</p>
<h3 id="å•æœºæ¶æ„"><a href="#å•æœºæ¶æ„" class="headerlink" title="å•æœºæ¶æ„"></a>å•æœºæ¶æ„</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šç½‘ç«™è¿è¥åˆæœŸï¼Œè®¿é—®ç”¨æˆ·å°‘ï¼Œä¸€å°æœåŠ¡å™¨ç»°ç»°æœ‰ä½™ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>åº”ç”¨ç¨‹åºã€æ•°æ®åº“ã€æ–‡ä»¶ç­‰æ‰€æœ‰çš„èµ„æºéƒ½åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šé€šå¸¸æœåŠ¡å™¨æ“ä½œç³»ç»Ÿä½¿ç”¨ linuxï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨ PHP å¼€å‘ï¼Œç„¶åéƒ¨ç½²åœ¨ Apache ä¸Šï¼Œæ•°æ®åº“ä½¿ç”¨ Mysqlï¼Œé€šä¿—ç§°ä¸º LAMPã€‚æ±‡é›†å„ç§å…è´¹å¼€æºè½¯ä»¶ä»¥åŠä¸€å°å»‰ä»·æœåŠ¡å™¨å°±å¯ä»¥å¼€å§‹ç³»ç»Ÿçš„å‘å±•ä¹‹è·¯äº†ã€‚</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102174033.png" style="width: 500px" />

<h3 id="åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»"><a href="#åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»" class="headerlink" title="åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»"></a>åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šè¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è®¿é—®å¯¼è‡´æ€§èƒ½è¶Šæ¥è¶Šå·®ï¼Œè¶Šæ¥è¶Šå¤šçš„æ•°æ®å¯¼è‡´å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œä¸€å°æœåŠ¡å™¨å·²ä¸è¶³ä»¥æ”¯æ’‘ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>åº”ç”¨æœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨ã€æ–‡ä»¶æœåŠ¡å™¨åˆ†åˆ«ç‹¬ç«‹éƒ¨ç½²ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šä¸‰å°æœåŠ¡å™¨å¯¹æ€§èƒ½è¦æ±‚å„ä¸ç›¸åŒï¼š<ul>
<li>åº”ç”¨æœåŠ¡å™¨è¦å¤„ç†å¤§é‡ä¸šåŠ¡é€»è¾‘ï¼Œå› æ­¤éœ€è¦æ›´å¿«æ›´å¼ºå¤§çš„ CPUï¼›</li>
<li>æ•°æ®åº“æœåŠ¡å™¨éœ€è¦å¿«é€Ÿç£ç›˜æ£€ç´¢å’Œæ•°æ®ç¼“å­˜ï¼Œå› æ­¤éœ€è¦æ›´å¿«çš„ç¡¬ç›˜å’Œæ›´å¤§çš„å†…å­˜ï¼›</li>
<li>æ–‡ä»¶æœåŠ¡å™¨éœ€è¦å­˜å‚¨å¤§é‡æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦æ›´å¤§å®¹é‡çš„ç¡¬ç›˜ã€‚</li>
</ul>
</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102174220.png" style="width: 500px" />

<h3 id="ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½"><a href="#ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½" class="headerlink" title="ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½"></a>ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€ç”¨æˆ·é€æ¸å¢å¤šï¼Œæ•°æ®åº“å‹åŠ›å¤ªå¤§å¯¼è‡´è®¿é—®å»¶è¿Ÿã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼šç”±äºç½‘ç«™è®¿é—®å’Œè´¢å¯Œåˆ†é…ä¸€æ ·éµå¾ªäºŒå…«å®šå¾‹ï¼š_80% çš„ä¸šåŠ¡è®¿é—®é›†ä¸­åœ¨ 20% çš„æ•°æ®ä¸Š_ã€‚<strong>å°†æ•°æ®åº“ä¸­è®¿é—®è¾ƒé›†ä¸­çš„å°‘éƒ¨åˆ†æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥å‡å°‘æ•°æ®åº“çš„è®¿é—®æ¬¡æ•°ï¼Œé™ä½æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šç¼“å­˜åˆ†ä¸ºä¸¤ç§ï¼šåº”ç”¨æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ä¸Šçš„è¿œç¨‹ç¼“å­˜ã€‚<ul>
<li>æœ¬åœ°ç¼“å­˜è®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼“å­˜æ•°æ®é‡æœ‰é™ï¼ŒåŒæ—¶å­˜åœ¨ä¸åº”ç”¨ç¨‹åºäº‰ç”¨å†…å­˜çš„æƒ…å†µã€‚</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜å¯ä»¥é‡‡ç”¨é›†ç¾¤æ–¹å¼ï¼Œç†è®ºä¸Šå¯ä»¥åšåˆ°ä¸å—å†…å­˜å®¹é‡é™åˆ¶çš„ç¼“å­˜æœåŠ¡ã€‚</li>
</ul>
</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102174506.png" style="width: 500px" />

<h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šä½¿ç”¨ç¼“å­˜åï¼Œæ•°æ®åº“è®¿é—®å‹åŠ›å¾—åˆ°æœ‰æ•ˆç¼“è§£ã€‚ä½†æ˜¯å•ä¸€åº”ç”¨æœåŠ¡å™¨èƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚è¿æ¥æœ‰é™ï¼Œåœ¨è®¿é—®é«˜å³°æœŸï¼Œæˆä¸ºç“¶é¢ˆã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>å¤šå°æœåŠ¡å™¨é€šè¿‡è´Ÿè½½å‡è¡¡åŒæ—¶å‘å¤–éƒ¨æä¾›æœåŠ¡ï¼Œè§£å†³å•ä¸€æœåŠ¡å™¨å¤„ç†èƒ½åŠ›å’Œå­˜å‚¨ç©ºé—´ä¸è¶³çš„é—®é¢˜ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šä½¿ç”¨é›†ç¾¤æ˜¯ç³»ç»Ÿè§£å†³é«˜å¹¶å‘ã€æµ·é‡æ•°æ®é—®é¢˜çš„å¸¸ç”¨æ‰‹æ®µã€‚é€šè¿‡å‘é›†ç¾¤ä¸­è¿½åŠ èµ„æºï¼Œæå‡ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œä½¿å¾—æœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ä¸å†æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆã€‚</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102174630.png" style="width: 800px" />

<h3 id="æ•°æ®åº“è¯»å†™åˆ†ç¦»"><a href="#æ•°æ®åº“è¯»å†™åˆ†ç¦»" class="headerlink" title="æ•°æ®åº“è¯»å†™åˆ†ç¦»"></a>æ•°æ®åº“è¯»å†™åˆ†ç¦»</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šç½‘ç«™ä½¿ç”¨ç¼“å­˜åï¼Œä½¿ç»å¤§éƒ¨åˆ†æ•°æ®è¯»æ“ä½œè®¿é—®éƒ½å¯ä»¥ä¸é€šè¿‡æ•°æ®åº“å°±èƒ½å®Œæˆï¼Œä½†æ˜¯ä»æœ‰ä¸€éƒ¨åˆ†è¯»æ“ä½œå’Œå…¨éƒ¨çš„å†™æ“ä½œéœ€è¦è®¿é—®æ•°æ®åº“ï¼Œåœ¨ç½‘ç«™çš„ç”¨æˆ·è¾¾åˆ°ä¸€å®šè§„æ¨¡åï¼Œæ•°æ®åº“å› ä¸ºè´Ÿè½½å‹åŠ›è¿‡é«˜è€Œæˆä¸ºç½‘ç«™çš„ç“¶é¢ˆã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼šç›®å‰å¤§éƒ¨åˆ†çš„ä¸»æµæ•°æ®åº“éƒ½æä¾›ä¸»ä»çƒ­å¤‡åŠŸèƒ½ï¼Œé€šè¿‡é…ç½®ä¸¤å°æ•°æ®åº“ä¸»ä»å…³ç³»ï¼Œå¯ä»¥å°†ä¸€å°æ•°æ®åº“æœåŠ¡å™¨çš„æ•°æ®æ›´æ–°åŒæ­¥åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šã€‚<strong>ç½‘ç«™åˆ©ç”¨æ•°æ®åº“çš„ä¸»ä»çƒ­å¤‡åŠŸèƒ½ï¼Œå®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦»ï¼Œä»è€Œæ”¹å–„æ•°æ®åº“è´Ÿè½½å‹åŠ›ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šåº”ç”¨æœåŠ¡å™¨åœ¨å†™æ“ä½œçš„æ—¶å€™ï¼Œè®¿é—®ä¸»æ•°æ®åº“ï¼Œä¸»æ•°æ®åº“é€šè¿‡ä¸»ä»å¤åˆ¶æœºåˆ¶å°†æ•°æ®æ›´æ–°åŒæ­¥åˆ°ä»æ•°æ®åº“ã€‚è¿™æ ·å½“åº”ç”¨æœåŠ¡å™¨åœ¨è¯»æ“ä½œçš„æ—¶å€™ï¼Œè®¿é—®ä»æ•°æ®åº“è·å¾—æ•°æ®ã€‚ä¸ºäº†ä¾¿äºåº”ç”¨ç¨‹åºè®¿é—®è¯»å†™åˆ†ç¦»åçš„æ•°æ®åº“ï¼Œé€šå¸¸åœ¨åº”ç”¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ä¸“é—¨çš„æ•°æ®è®¿é—®æ¨¡å—ï¼Œä½¿æ•°æ®åº“è¯»å†™åˆ†ç¦»çš„å¯¹åº”ç”¨é€æ˜ã€‚</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102174744.png" style="width: 800px" />

<h3 id="å¤šçº§ç¼“å­˜"><a href="#å¤šçº§ç¼“å­˜" class="headerlink" title="å¤šçº§ç¼“å­˜"></a>å¤šçº§ç¼“å­˜</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šä¸­å›½ç½‘ç»œç¯å¢ƒå¤æ‚ï¼Œä¸åŒåœ°åŒºçš„ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ï¼Œé€Ÿåº¦å·®åˆ«ä¹Ÿæå¤§ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>é‡‡ç”¨ CDN å’Œåå‘ä»£ç†åŠ å¿«ç³»ç»Ÿçš„é™æ€èµ„æºè®¿é—®é€Ÿåº¦ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šCDN å’Œåå‘ä»£ç†çš„åŸºæœ¬åŸç†éƒ½æ˜¯ç¼“å­˜ï¼ŒåŒºåˆ«åœ¨äºï¼š<ul>
<li>CDN éƒ¨ç½²åœ¨ç½‘ç»œæä¾›å•†çš„æœºæˆ¿ï¼Œä½¿ç”¨æˆ·åœ¨è¯·æ±‚ç½‘ç«™æœåŠ¡æ—¶ï¼Œå¯ä»¥ä»è·ç¦»è‡ªå·±æœ€è¿‘çš„ç½‘ç»œæä¾›å•†æœºæˆ¿è·å–æ•°æ®ï¼›</li>
<li>è€Œåå‘ä»£ç†åˆ™éƒ¨ç½²åœ¨ç½‘ç«™çš„ä¸­å¿ƒæœºæˆ¿ï¼Œå½“ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ä¸­å¿ƒæœºæˆ¿åï¼Œé¦–å…ˆè®¿é—®çš„æœåŠ¡å™¨æ—¶åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¦‚æœåå‘ä»£ç†æœåŠ¡å™¨ä¸­ç¼“å­˜ç€ç”¨æˆ·è¯·æ±‚çš„èµ„æºï¼Œå°±å°†å…¶ç›´æ¥è¿”å›ç»™ç”¨æˆ·ã€‚</li>
</ul>
</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102174848.png" style="width: 800px" />

<h3 id="ä¸šåŠ¡æ‹†åˆ†"><a href="#ä¸šåŠ¡æ‹†åˆ†" class="headerlink" title="ä¸šåŠ¡æ‹†åˆ†"></a>ä¸šåŠ¡æ‹†åˆ†</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šå¤§å‹ç½‘ç«™çš„ä¸šåŠ¡åœºæ™¯æ—¥ç›Šå¤æ‚ï¼Œåˆ†ä¸ºå¤šä¸ªäº§å“çº¿ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼šé‡‡ç”¨åˆ†è€Œæ²»ä¹‹çš„æ‰‹æ®µå°†æ•´ä¸ªç½‘ç«™ä¸šåŠ¡åˆ†æˆä¸åŒçš„äº§å“çº¿ã€‚<strong>ç³»ç»Ÿä¸ŠæŒ‰ç…§ä¸šåŠ¡è¿›è¡Œæ‹†åˆ†æ”¹é€ ï¼Œåº”ç”¨æœåŠ¡å™¨æŒ‰ç…§ä¸šåŠ¡åŒºåˆ†è¿›è¡Œåˆ†åˆ«éƒ¨ç½²ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šåº”ç”¨ä¹‹é—´å¯ä»¥é€šè¿‡è¶…é“¾æ¥å»ºç«‹å…³ç³»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œæ•°æ®åˆ†å‘ï¼Œå½“ç„¶æ›´å¤šçš„è¿˜æ˜¯é€šè¿‡è®¿é—®åŒä¸€ä¸ªæ•°æ®å­˜å‚¨ç³»ç»Ÿæ¥æ„æˆä¸€ä¸ªå…³è”çš„å®Œæ•´ç³»ç»Ÿã€‚<ul>
<li><strong>çºµå‘æ‹†åˆ†</strong>ï¼š<strong>å°†ä¸€ä¸ªå¤§åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªå°åº”ç”¨</strong>ï¼Œå¦‚æœæ–°ä¸šåŠ¡è¾ƒä¸ºç‹¬ç«‹ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†å…¶è®¾è®¡éƒ¨ç½²ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ Web åº”ç”¨ç³»ç»Ÿã€‚çºµå‘æ‹†åˆ†ç›¸å¯¹è¾ƒä¸ºç®€å•ï¼Œé€šè¿‡æ¢³ç†ä¸šåŠ¡ï¼Œå°†è¾ƒå°‘ç›¸å…³çš„ä¸šåŠ¡å‰¥ç¦»å³å¯ã€‚</li>
<li><strong>æ¨ªå‘æ‹†åˆ†</strong>ï¼š<strong>å°†å¤ç”¨çš„ä¸šåŠ¡æ‹†åˆ†å‡ºæ¥ï¼Œç‹¬ç«‹éƒ¨ç½²ä¸ºåˆ†å¸ƒå¼æœåŠ¡</strong>ï¼Œæ–°å¢ä¸šåŠ¡åªéœ€è¦è°ƒç”¨è¿™äº›åˆ†å¸ƒå¼æœåŠ¡æ¨ªå‘æ‹†åˆ†éœ€è¦è¯†åˆ«å¯å¤ç”¨çš„ä¸šåŠ¡ï¼Œè®¾è®¡æœåŠ¡æ¥å£ï¼Œè§„èŒƒæœåŠ¡ä¾èµ–å…³ç³»ã€‚</li>
</ul>
</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102175001.png" style="width: 800px" />

<h3 id="åˆ†åº“åˆ†è¡¨"><a href="#åˆ†åº“åˆ†è¡¨" class="headerlink" title="åˆ†åº“åˆ†è¡¨"></a>åˆ†åº“åˆ†è¡¨</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€å¤§å‹ç½‘ç«™ä¸šåŠ¡æŒç»­å¢é•¿ï¼Œæ•°æ®åº“ç»è¿‡è¯»å†™åˆ†ç¦»ï¼Œä»ä¸€å°æœåŠ¡å™¨æ‹†åˆ†ä¸ºä¸¤å°æœåŠ¡å™¨ï¼Œä¾ç„¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>æ•°æ®åº“é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šåˆ†å¸ƒå¼æ•°æ®åº“æ˜¯æ•°æ®åº“æ‹†åˆ†çš„æœ€åæ–¹æ³•ï¼Œåªæœ‰åœ¨å•è¡¨æ•°æ®è§„æ¨¡éå¸¸åºå¤§çš„æ—¶å€™æ‰ä½¿ç”¨ã€‚ä¸åˆ°ä¸å¾—å·²æ—¶ï¼Œæ›´å¸¸ç”¨çš„æ•°æ®åº“æ‹†åˆ†æ‰‹æ®µæ˜¯ä¸šåŠ¡åˆ†åº“ï¼Œå°†ä¸åŒçš„ä¸šåŠ¡æ•°æ®åº“éƒ¨ç½²åœ¨ä¸åŒçš„ç‰©ç†æœåŠ¡å™¨ä¸Šã€‚</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102175326.png" style="width: 800px" />

<h3 id="åˆ†å¸ƒå¼ç»„ä»¶"><a href="#åˆ†å¸ƒå¼ç»„ä»¶" class="headerlink" title="åˆ†å¸ƒå¼ç»„ä»¶"></a>åˆ†å¸ƒå¼ç»„ä»¶</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€ç½‘ç«™ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚ï¼Œå¯¹æ•°æ®å­˜å‚¨å’Œæ£€ç´¢çš„éœ€æ±‚ä¹Ÿè¶Šæ¥è¶Šå¤æ‚ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>ç³»ç»Ÿå¼•å…¥ NoSQL æ•°æ®åº“åŠæœç´¢å¼•æ“ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šNoSQL æ•°æ®åº“åŠæœç´¢å¼•æ“å¯¹å¯ä¼¸ç¼©çš„åˆ†å¸ƒå¼ç‰¹æ€§å…·æœ‰æ›´å¥½çš„æ”¯æŒã€‚åº”ç”¨æœåŠ¡å™¨é€šè¿‡ç»Ÿä¸€æ•°æ®è®¿é—®æ¨¡å—è®¿é—®å„ç§æ•°æ®ï¼Œå‡è½»åº”ç”¨ç¨‹åºç®¡ç†è¯¸å¤šæ•°æ®æºçš„éº»çƒ¦ã€‚</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102175125.png" style="width: 800px" />

<h3 id="å¾®æœåŠ¡"><a href="#å¾®æœåŠ¡" class="headerlink" title="å¾®æœåŠ¡"></a>å¾®æœåŠ¡</h3><ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€ä¸šåŠ¡è¶Šæ‹†è¶Šå°ï¼Œå­˜å‚¨ç³»ç»Ÿè¶Šæ¥è¶Šåºå¤§ï¼Œåº”ç”¨ç³»ç»Ÿæ•´ä½“å¤æ‚ç¨‹åº¦å‘ˆæŒ‡æ•°çº§ä¸Šå‡ï¼Œéƒ¨ç½²ç»´æŠ¤è¶Šæ¥è¶Šå›°éš¾ã€‚ç”±äºæ‰€æœ‰åº”ç”¨è¦å’Œæ‰€æœ‰æ•°æ®åº“ç³»ç»Ÿè¿æ¥ï¼Œæœ€ç»ˆå¯¼è‡´æ•°æ®åº“è¿æ¥èµ„æºä¸è¶³ï¼Œæ‹’ç»æœåŠ¡ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>å…¬å…±ä¸šåŠ¡æå–å‡ºæ¥ï¼Œç‹¬ç«‹éƒ¨ç½²ã€‚ç”±è¿™äº›å¯å¤ç”¨çš„ä¸šåŠ¡è¿æ¥æ•°æ®åº“ï¼Œé€šè¿‡åˆ†å¸ƒå¼æœåŠ¡æä¾›å…±ç”¨ä¸šåŠ¡æœåŠ¡ã€‚</strong></li>
<li>æè¿°ï¼šå¤§å‹ç½‘ç«™çš„æ¶æ„æ¼”åŒ–åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šå¤§å¤šæ•°çš„æŠ€æœ¯é—®é¢˜éƒ½å¾—ä»¥è§£å†³ï¼Œè¯¸å¦‚è·¨æ•°æ®ä¸­å¿ƒçš„å®æ—¶æ•°æ®åŒæ­¥å’Œå…·ä½“ç½‘ç«™ä¸šåŠ¡ç›¸å…³çš„é—®é¢˜ä¹Ÿéƒ½å¯ä»¥ç»„åˆæ”¹è¿›ç°æœ‰æŠ€æœ¯æ¶æ„æ¥è§£å†³ã€‚</li>
</ul>
<img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20211102175430.png" style="width: 1024px" />

<h2 id="æ¶æ„è®¾è®¡çš„è€ƒé‡"><a href="#æ¶æ„è®¾è®¡çš„è€ƒé‡" class="headerlink" title="æ¶æ„è®¾è®¡çš„è€ƒé‡"></a>æ¶æ„è®¾è®¡çš„è€ƒé‡</h2><blockquote>
<p><strong>æ¯ä¸€ä¸ªæ¨¡å¼æè¿°äº†ä¸€ä¸ªä¸ä½†é‡å¤å‘ç”Ÿçš„é—®é¢˜åŠè¯¥é—®é¢˜è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒã€‚è¿™æ ·ï¼Œå°±å¯ä»¥ä¸æ–­å¤ç”¨è¯¥æ–¹æ¡ˆè€Œå‡å°‘é‡å¤å·¥ä½œ</strong>ã€‚</p>
</blockquote>
<h3 id="ä»€ä¹ˆæ˜¯æ¶æ„"><a href="#ä»€ä¹ˆæ˜¯æ¶æ„" class="headerlink" title="ä»€ä¹ˆæ˜¯æ¶æ„"></a>ä»€ä¹ˆæ˜¯æ¶æ„</h3><p>æ¶æ„æ˜¯ä¸€ä¸ªéå¸¸æŠ½è±¡çš„æ¦‚å¿µï¼Œæ¯ä¸ªäººç”±äºæŠ€æœ¯çš„æ·±åº¦ã€æ€ç»´çš„è§†è§’ç­‰å·®å¼‚ï¼Œå¯¹äºæ¶æ„çš„ç†è§£ï¼Œå„ä¸ç›¸åŒã€‚</p>
<p>è¿™é‡Œæ‘˜æŠ„ç½‘ä¸ŠæŸæ®µæ¯”è¾ƒç²¾é«“çš„å®šä¹‰ï¼š</p>
<ul>
<li><strong>æ¶æ„æ˜¯è½¯ä»¶ç³»ç»Ÿçš„é¡¶å±‚è®¾è®¡</strong>ã€‚</li>
<li><strong>æ¡†æ¶æ˜¯é¢å‘ç¼–ç¨‹æˆ–é…ç½®çš„åŠæˆå“</strong>ã€‚</li>
<li><strong>ç»„ä»¶æ˜¯ä»æŠ€æœ¯ç»´åº¦ä¸Šçš„å¤ç”¨</strong>ã€‚</li>
<li><strong>æ¨¡å—æ˜¯ä»ä¸šåŠ¡ç»´åº¦ä¸ŠèŒè´£çš„åˆ’åˆ†</strong>ã€‚</li>
<li><strong>ç³»ç»Ÿæ˜¯ç›¸äº’ååŒå¯è¿è¡Œçš„å®ä½“</strong>ã€‚</li>
</ul>
<h3 id="æ¶æ„è®¾è®¡çš„ç›®æ ‡"><a href="#æ¶æ„è®¾è®¡çš„ç›®æ ‡" class="headerlink" title="æ¶æ„è®¾è®¡çš„ç›®æ ‡"></a>æ¶æ„è®¾è®¡çš„ç›®æ ‡</h3><p><strong>æ¶æ„è®¾è®¡çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶ç³»ç»Ÿå¤æ‚åº¦å¸¦æ¥çš„é—®é¢˜</strong>ã€‚</p>
<p>æ¶æ„è®¾è®¡åº”è¯¥<strong>æŒ‰éœ€è®¾è®¡</strong>ã€‚ä»»ä½•ç½‘ç«™éƒ½æ˜¯éšç€ä¸šåŠ¡é€æ­¥å‘å±•ï¼Œä¸æ–­æ¼”åŒ–è€Œæˆï¼Œä¸è¦æŒ‡æœ›ä¸€åŠ³æ°¸é€¸ã€‚</p>
<p>å…³äºæ¶æ„è®¾è®¡çš„ç›®çš„ï¼Œå¸¸è§çš„<strong>è¯¯åŒº</strong>æœ‰ï¼š</p>
<ul>
<li>å› ä¸ºæ¶æ„å¾ˆé‡è¦ï¼Œæ‰€ä»¥è¦åšæ¶æ„è®¾è®¡</li>
<li>ä¸ºäº†é«˜æ€§èƒ½ã€é«˜å¯ç”¨ã€å¯æ‰©å±•ï¼Œæ‰€ä»¥è¦åšæ¶æ„è®¾è®¡</li>
<li>å¤§å‚éƒ½æ˜¯è¿™ä¹ˆåšçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¿™ä¹ˆåš</li>
<li>è¿™ç§æ–°æŠ€æœ¯å¾ˆç‰›é€¼ï¼Œæˆ‘ä»¬ä¹Ÿä¸€å®šè¦å¼•å…¥</li>
</ul>
<p>æ¶æ„çš„åŸåˆ™ï¼š</p>
<ul>
<li>æ¶æ„è®¾è®¡åº”è¯¥<strong>æŒ‰éœ€è®¾è®¡</strong>ã€‚ä»»ä½•ç½‘ç«™éƒ½æ˜¯éšç€ä¸šåŠ¡é€æ­¥å‘å±•ï¼Œä¸æ–­æ¼”åŒ–è€Œæˆï¼Œä¸è¦æŒ‡æœ›ä¸€åŠ³æ°¸é€¸ã€‚</li>
<li><strong>é©±åŠ¨æŠ€æœ¯å‘å±•çš„ä¸»è¦åŠ›é‡æ˜¯ä¸šåŠ¡å‘å±•</strong>ã€‚</li>
<li><strong>ä¸è¦ç›²ç›®è·Ÿé£</strong>å¤§å…¬å¸çš„è§£å†³æ–¹æ¡ˆã€‚</li>
<li><strong>ä¸è¦ç›²ç›®è¿½æ±‚æµè¡ŒæŠ€æœ¯</strong>ï¼Œè€Œè„±ç¦»äº†ä¸šåŠ¡å‘å±•çš„å®é™…æƒ…å†µã€‚</li>
<li><strong>ä¸è¦æŠŠæ‰€æœ‰é—®é¢˜éƒ½ä¸¢ç»™æŠ€æœ¯</strong>ã€‚ç°å®ä¸­ï¼Œæœ‰å¾ˆå¤šæ¡ˆä¾‹å‘Šè¯‰æˆ‘ä»¬ï¼Œå¾ˆå¤šé—®é¢˜ä¸ä¸€å®šéœ€è¦é€šè¿‡æŠ€æœ¯æ¥è§£å†³ã€‚å½’æ ¹ç»“åº•ï¼ŒæŠ€æœ¯å§‹ç»ˆéƒ½æ˜¯ä¸šåŠ¡çš„è¾…åŠ©ï¼Œä¸šåŠ¡é—®é¢˜ç©¶ç«Ÿæ˜¯é€šè¿‡æŠ€æœ¯æ¥è§£å†³è¿˜æ˜¯ç›´æ¥é€šè¿‡ä¸šåŠ¡æ¥è§£å†³ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µå»åˆ†æåˆ¤æ–­ã€‚è¿™å°±éœ€è¦å¯¹ä¸šåŠ¡é¢†åŸŸæœ‰æ¯”è¾ƒæ·±å…¥çš„ç†è§£å’Œæ€è€ƒã€‚</li>
</ul>
<h3 id="æ¶æ„è®¾è®¡çš„åŸåˆ™"><a href="#æ¶æ„è®¾è®¡çš„åŸåˆ™" class="headerlink" title="æ¶æ„è®¾è®¡çš„åŸåˆ™"></a>æ¶æ„è®¾è®¡çš„åŸåˆ™</h3><blockquote>
<p>åˆé€‚ä¼˜äºå…ˆè¿›&gt;æ¼”åŒ–ä¼˜äºä¸€æ­¥åˆ°ä½&gt;ç®€å•ä¼˜äºå¤æ‚</p>
</blockquote>
<h4 id="åˆé€‚åŸåˆ™"><a href="#åˆé€‚åŸåˆ™" class="headerlink" title="åˆé€‚åŸåˆ™"></a>åˆé€‚åŸåˆ™</h4><p>æ²¡é‚£ä¹ˆå¤šäººï¼Œå´æƒ³å¹²é‚£ä¹ˆå¤šæ´»ï¼Œæ˜¯å¤±è´¥çš„ç¬¬ä¸€ä¸ªä¸»è¦åŸå› ã€‚</p>
<p>æ²¡æœ‰é‚£ä¹ˆå¤šç§¯ç´¯ï¼Œå´æƒ³ä¸€æ­¥ç™»å¤©ï¼Œæ˜¯å¤±è´¥çš„ç¬¬äºŒä¸ªä¸»è¦åŸå› ã€‚</p>
<p>æ²¡æœ‰é‚£ä¹ˆå“è¶Šçš„ä¸šåŠ¡åœºæ™¯ï¼Œå´å¹»æƒ³çµå…‰ä¸€é—ªæˆä¸ºå¤©æ‰ï¼Œæ˜¯å¤±è´¥çš„ç¬¬ä¸‰ä¸ªä¸»è¦åŸå› ã€‚</p>
<h4 id="ç®€å•åŸåˆ™"><a href="#ç®€å•åŸåˆ™" class="headerlink" title="ç®€å•åŸåˆ™"></a>ç®€å•åŸåˆ™</h4><p>å†é«˜å¤§ä¸Šçš„è§£å†³æ–¹æ¡ˆå¦‚æœä¸èƒ½è½åœ°ï¼Œä¹Ÿæ˜¯ç™½æ‰¯ã€‚</p>
<p>æ‰€ä»¥ï¼Œåº”å¯¹éœ€æ±‚</p>
<h4 id="æ¼”åŒ–åŸåˆ™"><a href="#æ¼”åŒ–åŸåˆ™" class="headerlink" title="æ¼”åŒ–åŸåˆ™"></a>æ¼”åŒ–åŸåˆ™</h4><p>æ¼”åŒ–ä¼˜äºä¸€æ­¥åˆ°ä½ã€‚</p>
<p>ä¸è¦å¦„å›¾è®¾è®¡ä¸€ä¸ªä¸€æ­¥åˆ°ä½ï¼Œæ°¸ä¹…ä¸å˜çš„æ¶æ„ã€‚</p>
<h4 id="å¢¨è²å®šå¾‹"><a href="#å¢¨è²å®šå¾‹" class="headerlink" title="å¢¨è²å®šå¾‹"></a>å¢¨è²å®šå¾‹</h4><ul>
<li>ä»»ä½•äº‹éƒ½æ²¡æœ‰è¡¨é¢çœ‹èµ·æ¥é‚£ä¹ˆç®€å•ï¼›</li>
<li>æ‰€æœ‰çš„äº‹éƒ½ä¼šæ¯”ä½ é¢„è®¡çš„æ—¶é—´é•¿ï¼›</li>
<li>ä¼šå‡ºé”™çš„äº‹æ€»ä¼šå‡ºé”™ï¼›</li>
<li>å¦‚æœä½ æ‹…å¿ƒæŸç§æƒ…å†µå‘ç”Ÿï¼Œé‚£ä¹ˆå®ƒå°±æ›´æœ‰å¯èƒ½å‘ç”Ÿã€‚</li>
</ul>
<h4 id="åº·å¨å®šå¾‹"><a href="#åº·å¨å®šå¾‹" class="headerlink" title="åº·å¨å®šå¾‹"></a>åº·å¨å®šå¾‹</h4><p>ç³»ç»Ÿè®¾è®¡(äº§å“ç»“æ„)ç­‰åŒç»„ç»‡å½¢å¼ï¼Œæ¯ä¸ªè®¾è®¡ç³»ç»Ÿçš„ç»„ç»‡ï¼Œå…¶äº§ç”Ÿçš„è®¾è®¡ç­‰åŒäºç»„ç»‡ä¹‹é—´çš„æ²Ÿé€šç»“æ„ï¼ˆç®€å•ç‚¹è¯´å°±æ˜¯ï¼Œç³»ç»Ÿçš„è®¾è®¡å—é™äºè®¾è®¡ç³»ç»Ÿçš„ç»„ç»‡çš„äººå‘˜æ¶æ„å½¢å¼ã€‚</p>
<h4 id="äºŒå…«å®šå¾‹"><a href="#äºŒå…«å®šå¾‹" class="headerlink" title="äºŒå…«å®šå¾‹"></a>äºŒå…«å®šå¾‹</h4><h3 id="é«˜æ€§èƒ½"><a href="#é«˜æ€§èƒ½" class="headerlink" title="é«˜æ€§èƒ½"></a>é«˜æ€§èƒ½</h3><blockquote>
<p>æ€§èƒ½æ˜¯è½¯ä»¶ç³»ç»Ÿçš„é‡è¦è¡¡é‡æ ‡å‡†ã€‚å¾ˆå¤šæ‰©å±•æ€§ã€ä¼¸ç¼©æ€§ã€å¯ç”¨æ€§çš„é—®é¢˜ï¼Œæ˜¯ä¸ºäº†è§£å†³æ€§èƒ½é—®é¢˜è€Œå¼•å…¥çš„ã€‚</p>
</blockquote>
<h4 id="æ€§èƒ½æŒ‡æ ‡"><a href="#æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡"></a>æ€§èƒ½æŒ‡æ ‡</h4><p>å“åº”å»¶æ—¶ã€å¹¶å‘å¤„ç†èƒ½åŠ›ã€å†…å­˜ã€CPUã€IO å¼€é”€ç­‰éƒ½å¯ä»¥è§†ä¸ºç³»ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡ã€‚</p>
<p>åˆ†æç”¨æˆ·ä½“é‡ã€æ—¥è®¿é—®é‡çš„å³°å€¼ï¼Œä¼°ç®—å‡ºä¸ºäº†å¹³ç¨³åº”å¯¹å³°å€¼è®¿é—®æµé‡æ‰€éœ€çš„å¹¶å‘é‡ã€ååé‡ã€‚å¦‚æœæ˜¯åº”ç”¨å‹ç³»ç»Ÿï¼Œæ€§èƒ½å¤Ÿç”¨å°±å¥½ï¼Œæ²¡å¿…è¦ä¸€å‘³è¿½æ±‚é«˜æ€§èƒ½ã€‚æ¯”å¦‚ï¼šç”¨æˆ·ä½“é‡å¯èƒ½è¿˜ä¸è¿‡ä¸‡ï¼Œä¸€å¤©æ€»è®¿é—®é‡å¯èƒ½ä¹Ÿå°±ä¸€ä¸¤åƒ PVï¼Œå³°å€¼ä¹Ÿå°±å‡ ç™¾ QPSï¼Œè¿™æ ·çš„ç³»ç»Ÿå¦‚æœè¦è€ƒè™‘æ¯ç§’å‡ ä¸‡çš„ QPSï¼Œæ˜¾ç„¶æœ‰äº›å¤šè™‘äº†ã€‚</p>
<h4 id="æ€§èƒ½æå‡æ‰‹æ®µ"><a href="#æ€§èƒ½æå‡æ‰‹æ®µ" class="headerlink" title="æ€§èƒ½æå‡æ‰‹æ®µ"></a>æ€§èƒ½æå‡æ‰‹æ®µ</h4><p>å¸¸è§çš„æ€§èƒ½æå‡æ‰‹æ®µæœ‰ï¼š</p>
<ul>
<li>å‰ç«¯<ul>
<li>æµè§ˆå™¨ç¼“å­˜</li>
<li>é™æ€èµ„æºå‹ç¼©</li>
<li>åˆç†å¸ƒå±€é¡µé¢</li>
<li>å‡å°‘ cookie ä¼ è¾“</li>
<li>CDN</li>
</ul>
</li>
<li>åº”ç”¨æœåŠ¡<ul>
<li>è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†</li>
<li>æœ¬åœ°ç¼“å­˜</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜</li>
<li>å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>é›†ç¾¤</li>
<li>ä»£ç å±‚é¢ï¼šä½¿ç”¨å¤šçº¿ç¨‹ã€æ”¹å–„å†…å­˜ç®¡ç†</li>
</ul>
</li>
<li>æ•°æ®åº“<ul>
<li>ç´¢å¼•</li>
<li>æ•°æ®åº“ç¼“å­˜</li>
<li>SQL ä¼˜åŒ–</li>
</ul>
</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼š<strong>ç¼“å­˜æ˜¯æ”¹å–„è½¯ä»¶æ€§èƒ½çš„ç¬¬ä¸€æ‰‹æ®µ</strong>ã€‚ç¼“å­˜é™¤äº†å¯ä»¥åŠ å¿«æ•°æ®è®¿é—®é€Ÿåº¦ä»¥å¤–ï¼Œè¿˜å¯ä»¥å‡è½»åç«¯åº”ç”¨å’Œæ•°æ®å­˜å‚¨çš„è´Ÿè½½å‹åŠ›ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦æå‡ç³»ç»Ÿæ€§èƒ½ï¼Œåº”è¯¥ç¬¬ä¸€æ—¶é—´æƒ³åˆ°ç¼“å­˜ã€‚</p>
<p>ä½¿ç”¨ç¼“å­˜æœ‰ä¸¤ä¸ªå‰æï¼š</p>
<ul>
<li>æ•°æ®è®¿é—®çƒ­ç‚¹ä¸å‡åŒ€ï¼Œé¢‘ç¹è®¿é—®çš„æ•°æ®åº”è¯¥æ”¾åœ¨ç¼“å­˜ä¸­ã€‚</li>
<li>æ•°æ®åœ¨æŸä¸ªæ—¶é—´æ®µæœ‰æ•ˆï¼Œä¸ä¼šå¾ˆå¿«è¿‡æœŸï¼Œå¦åˆ™ç¼“å­˜æ•°æ®ä¼šå› å·²ç»å¤±æ•ˆè€Œäº§ç”Ÿè„è¯»ã€‚</li>
</ul>
</blockquote>
<h3 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="headerlink" title="é«˜å¯ç”¨"></a>é«˜å¯ç”¨</h3><blockquote>
<p>ç³»ç»Ÿæ— ä¸­æ–­åœ°æ‰§è¡Œå…¶åŠŸèƒ½çš„èƒ½åŠ›ï¼Œä»£è¡¨ç³»ç»Ÿçš„å¯ç”¨æ€§ç¨‹åº¦ï¼Œæ˜¯è¿›è¡Œç³»ç»Ÿè®¾è®¡æ—¶çš„å‡†åˆ™ä¹‹ä¸€ã€‚</p>
</blockquote>
<p><strong>é«˜æ€§èƒ½å¢åŠ æœºå™¨ç›®çš„åœ¨äºâ€œæ‰©å±•â€å¤„ç†æ€§èƒ½ï¼›é«˜å¯ç”¨å¢åŠ æœºå™¨ç›®çš„åœ¨äºâ€œå†—ä½™â€å¤„ç†å•å…ƒ</strong>ã€‚</p>
<p>å•ç‚¹ç³»ç»Ÿï¼Œæ˜¯æ— æ³•ä¿è¯é«˜å¯ç”¨çš„ã€‚ç³»ç»Ÿè‡ªèº«æ•…éšœã€æ–­ç”µã€ç¡¬ä»¶æ•…éšœã€ç½‘ç»œç­‰ç­‰ï¼Œéƒ½å¯èƒ½å¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚é«˜å¯ç”¨æ–¹æ¡ˆäº”èŠ±å…«é—¨ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡â€œ<strong>å†—ä½™</strong>â€æ¥å®ç°é«˜å¯ç”¨ã€‚</p>
<h4 id="æ— çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨"><a href="#æ— çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨" class="headerlink" title="æ— çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨"></a>æ— çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨</h4><p>æ— çŠ¶æ€åº”ç”¨ä¸€èˆ¬å…·æœ‰å¹‚ç­‰æ€§ï¼Œå³<strong>æ— è®ºåœ¨å“ªå°æœºå™¨ä¸Šè¿›è¡Œè®¡ç®—ï¼ŒåŒæ ·çš„ç®—æ³•å’Œè¾“å…¥æ•°æ®ï¼Œäº§å‡ºçš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</strong>æ‰€ä»¥ï¼Œè®¡ç®—åœ¨ä»»æ„èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œç»“æœéƒ½ä¸€æ ·ã€‚</p>
<p>æ— çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨ï¼š</p>
<ul>
<li>éœ€è¦å¢åŠ ä¸€ä¸ªä»»åŠ¡åˆ†é…å™¨ï¼Œé€‰æ‹©åˆé€‚çš„ä»»åŠ¡åˆ†é…å™¨ä¹Ÿæ˜¯ä¸€ä»¶å¤æ‚çš„äº‹æƒ…ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘æ€§èƒ½ã€æˆæœ¬ã€å¯ç»´æŠ¤æ€§ã€å¯ç”¨æ€§ç­‰å„æ–¹é¢å› ç´ ã€‚</li>
<li>ä»»åŠ¡åˆ†é…å™¨å’ŒçœŸæ­£çš„ä¸šåŠ¡æœåŠ¡å™¨ä¹‹é—´æœ‰è¿æ¥å’Œäº¤äº’ï¼Œéœ€è¦é€‰æ‹©åˆé€‚çš„è¿æ¥æ–¹å¼ï¼Œå¹¶ä¸”å¯¹è¿æ¥è¿›è¡Œç®¡ç†ã€‚ä¾‹å¦‚ï¼Œè¿æ¥å»ºç«‹ã€è¿æ¥æ£€æµ‹ã€è¿æ¥ä¸­æ–­åå¦‚ä½•å¤„ç†ç­‰ã€‚</li>
<li>ä»»åŠ¡åˆ†é…å™¨éœ€è¦å¢åŠ åˆ†é…ç®—æ³•ã€‚ä¾‹å¦‚ï¼Œå¸¸è§çš„åŒæœºç®—æ³•æœ‰ä¸»å¤‡ã€ä¸»ä¸»ï¼Œä¸»å¤‡æ–¹æ¡ˆåˆå¯ä»¥ç»†åˆ†ä¸ºå†·å¤‡ã€æ¸©å¤‡ã€çƒ­å¤‡ã€‚</li>
</ul>
<h4 id="æœ‰çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨"><a href="#æœ‰çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨" class="headerlink" title="æœ‰çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨"></a>æœ‰çŠ¶æ€åº”ç”¨çš„é«˜å¯ç”¨</h4><p>æœ‰çŠ¶æ€åº”ç”¨ï¼Œæ˜¯æŒ‡éœ€è¦å­˜å‚¨æ•°æ®çš„ç³»ç»Ÿï¼Œæ¯”å¦‚å„ç§åˆ†å¸ƒå¼å­˜å‚¨ã€‚å’Œæ— çŠ¶æ€åº”ç”¨ç›¸æ¯”ï¼Œæœ‰ä¸€ä¸ªæœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼š<strong>å„èŠ‚ç‚¹éœ€è¦é€šè¿‡åŒæ­¥ä¿æŒæ•°æ®ä¸€è‡´</strong>ã€‚åˆ†å¸ƒå¼é¢†åŸŸé‡Œé¢æœ‰ä¸€ä¸ªè‘—åçš„ CAP å®šç†ï¼Œä»ç†è®ºä¸Šè®ºè¯äº†å­˜å‚¨é«˜å¯ç”¨çš„å¤æ‚åº¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­˜å‚¨é«˜å¯ç”¨ä¸å¯èƒ½åŒæ—¶æ»¡è¶³â€œä¸€è‡´æ€§ã€å¯ç”¨æ€§ã€åˆ†åŒºå®¹é”™æ€§â€ï¼Œæœ€å¤šæ»¡è¶³å…¶ä¸­ä¸¤ä¸ªï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬åœ¨åšæ¶æ„è®¾è®¡æ—¶ç»“åˆä¸šåŠ¡è¿›è¡Œå–èˆã€‚</p>
<h4 id="é«˜å¯ç”¨æ‰‹æ®µ"><a href="#é«˜å¯ç”¨æ‰‹æ®µ" class="headerlink" title="é«˜å¯ç”¨æ‰‹æ®µ"></a>é«˜å¯ç”¨æ‰‹æ®µ</h4><p>é«˜å¯ç”¨çš„å¸¸ç”¨æ‰‹æ®µï¼š</p>
<ul>
<li><strong>è´Ÿè½½å‡è¡¡</strong> - é€šè¿‡è´Ÿè½½å‡è¡¡è®¾å¤‡å»ºç«‹é›†ç¾¤å…±åŒå¯¹å¤–æä¾›æœåŠ¡ã€‚</li>
<li><strong>å¤‡ä»½</strong> - æ•°æ®å­˜å‚¨åœ¨å¤šå°æœåŠ¡å™¨ï¼Œäº’ç›¸å¤‡ä»½ã€‚å³ä½¿è®¿é—®å’Œè´Ÿè½½å¾ˆå°çš„æœåŠ¡ä¹Ÿå¿…é¡»éƒ¨ç½²è‡³å°‘ä¸¤å°æœåŠ¡å™¨ï¼Œæ„æˆä¸€ä¸ªé›†ç¾¤ï¼Œç›®çš„å°±æ˜¯é€šè¿‡å†—ä½™å®ç°æœåŠ¡çš„é«˜å¯ç”¨ã€‚<ul>
<li><strong>å†·å¤‡ä»½</strong> - æ•°æ®åº”è¯¥å®šæœŸå¤‡ä»½ï¼›</li>
<li><strong>çƒ­å¤‡ä»½</strong> - ä¸ºäº†ä¿è¯åœ¨çº¿ä¸šåŠ¡é«˜å¯ç”¨ï¼Œè¿˜éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œä¸»ä»åˆ†ç¦»ï¼Œå®æ—¶åŒæ­¥ ã€‚</li>
<li><strong>ç¾å¤‡</strong> - ä¸ºäº†æŠµå¾¡åœ°éœ‡ã€æµ·å•¸ç­‰ä¸å¯æŠ—å› ç´ å¯¼è‡´çš„ç½‘ç«™å®Œå…¨ç˜«ç—ªï¼ŒæŸäº›å¤§å‹ç½‘ç«™ä¼šå¯¹æ•´ä¸ªæ•°æ®ä¸­å¿ƒè¿›è¡Œå¤‡ä»½ï¼Œå…¨çƒèŒƒå›´å†…éƒ¨ç½² <strong>ç¾å¤‡æ•°æ®ä¸­å¿ƒ</strong>ã€‚ç½‘ç«™ç¨‹åºå’Œæ•°æ®å®šæœŸåŒæ­¥åˆ°å¤šä¸ªç¾å¤‡æ•°æ®ä¸­å¿ƒã€‚</li>
</ul>
</li>
<li><strong>è‡ªåŠ¨åŒ–</strong> - è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œå¤§å‹ç³»ç»Ÿæœ‰å¿…è¦é€šè¿‡é¢„å‘å¸ƒéªŒè¯ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€è‡ªåŠ¨åŒ–å‘å¸ƒã€ç°åº¦å‘å¸ƒç­‰æ‰‹æ®µï¼Œå‡å°‘å°†æ•…éšœå¼•å…¥çº¿ä¸Šç¯å¢ƒçš„å¯èƒ½ã€‚å¸¸è§è‡ªåŠ¨åŒ–æ‰‹æ®µæœ‰ï¼š<ul>
<li>å‘å¸ƒè¿‡ç¨‹è‡ªåŠ¨åŒ–<ul>
<li>è‡ªåŠ¨åŒ–ä»£ç ç®¡ç†</li>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li>è‡ªåŠ¨åŒ–å®‰å…¨ç›‘æµ‹</li>
<li>è‡ªåŠ¨åŒ–éƒ¨ç½²</li>
</ul>
</li>
<li>è¿ç»´è‡ªåŠ¨åŒ–<ul>
<li>è‡ªåŠ¨åŒ–ç›‘æ§</li>
<li>è‡ªåŠ¨åŒ–æŠ¥è­¦</li>
<li>è‡ªåŠ¨åŒ–å¤±æ•ˆè½¬ç§»</li>
<li>è‡ªåŠ¨åŒ–å¤±æ•ˆæ¢å¤</li>
<li>è‡ªåŠ¨åŒ–é™çº§</li>
<li>è‡ªåŠ¨åŒ–åˆ†é…èµ„æº</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="æ‰©å±•æ€§"><a href="#æ‰©å±•æ€§" class="headerlink" title="æ‰©å±•æ€§"></a>æ‰©å±•æ€§</h3><blockquote>
<p><strong>å¯æ‰©å±•æ€§æŒ‡ç³»ç»Ÿä¸ºäº†åº”å¯¹å°†æ¥éœ€æ±‚å˜åŒ–è€Œæä¾›çš„ä¸€ç§æ‰©å±•èƒ½åŠ›</strong>ï¼Œå½“æœ‰æ–°çš„éœ€æ±‚å‡ºç°æ—¶ï¼Œç³»ç»Ÿä¸éœ€è¦æˆ–è€…ä»…éœ€è¦å°‘é‡ä¿®æ”¹å°±å¯ä»¥æ”¯æŒï¼Œæ— é¡»æ•´ä¸ªç³»ç»Ÿé‡æ„æˆ–è€…é‡å»ºã€‚</p>
<p>è¡¡é‡æ‰©å±•æ€§çš„æ ‡å‡†å°±æ˜¯å¢åŠ æ–°çš„ä¸šåŠ¡äº§å“æ—¶ï¼Œæ˜¯å¦å¯ä»¥å®ç°å¯¹ç°æœ‰äº§å“é€æ˜æ— å½±å“ï¼Œä¸éœ€è¦ä»»ä½•æ”¹åŠ¨æˆ–å¾ˆå°‘æ”¹åŠ¨ï¼Œæ—¢æœ‰åŠŸèƒ½å°±å¯ä»¥ä¸Šçº¿æ–°äº§å“ã€‚</p>
<p>è½¯ä»¶å‘å±•çš„ä¸€ä¸ªé‡è¦ç›®æ ‡å’Œé©±åŠ¨åŠ›æ˜¯é™ä½è½¯ä»¶è€¦åˆæ€§ã€‚äº‹ç‰©ä¹‹é—´ç›´æ¥å…³ç³»è¶Šå°‘ï¼Œå½¼æ­¤å½±å“å°±è¶Šå°ï¼Œä¹Ÿå°±æ›´å®¹æ˜“ç‹¬ç«‹å‘å±•ï¼Œå³æ‰©å±•æ€§å¥½ã€‚</p>
</blockquote>
<p>ä¸»è¦æ‰‹æ®µæœ‰ï¼š</p>
<ul>
<li><p><strong>åˆ†å±‚</strong> - åˆ†å±‚æ˜¯æ‰©å±•æ€§è®¾è®¡çš„æœ€åŸºæœ¬æ‰‹æ®µã€‚é€šè¿‡åˆ†å±‚ï¼Œå¯ä»¥å°†ä¸€ä¸ªçš„è½¯ä»¶ç³»ç»Ÿåˆ‡åˆ†ä¸ºä¸åŒçš„éƒ¨åˆ†ï¼Œä¾¿äºåˆ†å·¥åˆä½œå¼€å‘å’Œç»´æŠ¤ï¼›å„å±‚é—´å…·æœ‰ä¸€å®šçš„ç‹¬ç«‹æ€§ã€‚</p>
<ul>
<li>åˆ†å±‚æ¶æ„çš„çº¦æŸï¼š<strong>ç¦æ­¢è·¨å±‚æ¬¡çš„è°ƒç”¨åŠé€†å‘è°ƒç”¨</strong>ã€‚</li>
<li>å³ä½¿ç³»ç»Ÿè§„æ¨¡å¾ˆå°ï¼Œä¹Ÿåº”è¯¥è€ƒè™‘é‡‡ç”¨åˆ†å±‚çš„æ¶æ„ï¼Œè¿™æ ·ä¾¿äºä»¥åæ‰©å±•ã€‚</li>
</ul>
</li>
<li><p><strong>åˆ†å‰²</strong> - å°†ä¸åŒçš„åŠŸèƒ½å’ŒæœåŠ¡åˆ†å‰²å¼€æ¥ï¼ŒåŒ…è£…æˆé«˜å†…èšã€ä½è€¦åˆçš„æ¨¡å—å•å…ƒã€‚è¿™æœ‰åŠ©äºè½¯ä»¶çš„å¼€å‘å’Œç»´æŠ¤ï¼Œä¾¿äºä¸åŒæ¨¡å—çš„åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œæé«˜ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›å’ŒåŠŸèƒ½æ‰©å±•èƒ½åŠ›ã€‚</p>
</li>
<li><p><strong>å¼‚æ­¥</strong> - ä¸šåŠ¡é—´çš„æ¶ˆæ¯ä¼ é€’ä¸æ˜¯åŒæ­¥è°ƒç”¨ï¼Œè€Œæ˜¯å°†ä¸€ä¸ªä¸šåŠ¡æ“ä½œæ‹†åˆ†æˆå¤šé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µé—´é€šè¿‡å…±äº«æ•°æ®çš„æ–¹å¼å¼‚æ­¥æ‰§è¡Œè¿›è¡Œåä½œã€‚</p>
<ul>
<li><strong>åœ¨å•ä¸€æœåŠ¡å™¨å†…éƒ¨å¯é€šè¿‡å¤šçº¿ç¨‹å…±äº«å†…å­˜é˜Ÿåˆ—çš„æ–¹å¼å®ç°å¼‚æ­¥</strong>ï¼Œå¤„åœ¨ä¸šåŠ¡æ“ä½œå‰é¢çš„çº¿ç¨‹å°†æ“ä½œè¾“å‡ºåˆ°é˜Ÿåˆ—ï¼Œåé¢çš„çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è¯»å–æ•°æ®è¿›è¡Œå¤„ç†ï¼›</li>
<li>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ<strong>å¤šä¸ªæœåŠ¡å™¨é›†ç¾¤é€šè¿‡åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—å®ç°å¼‚æ­¥</strong>ã€‚</li>
</ul>
</li>
<li><p><strong>åˆ†å¸ƒå¼</strong> - å°†ä¸šåŠ¡å’Œå¯å¤ç”¨æœåŠ¡åˆ†ç¦»ï¼Œé€šè¿‡åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶è°ƒç”¨ã€‚åˆ†å¸ƒå¼æ˜¯æŒ‡å¤šå°æœåŠ¡å™¨éƒ¨ç½²ç›¸åŒåº”ç”¨æ„æˆä¸€ä¸ªé›†ç¾¤ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è®¾å¤‡å…±åŒå¯¹å¤–æä¾›æœåŠ¡ã€‚ç€æ„å‘³ç€æœåŠ¡å¯ä»¥ç”¨æ›´å¤šçš„æœºå™¨å·¥ä½œï¼Œå³æ‰©å±• CPUã€å†…å­˜ã€IO ç­‰èµ„æºï¼Œä»è€Œæé«˜ç³»ç»Ÿæ•´ä½“çš„ååé‡å’Œå¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</p>
<ul>
<li>å¸¸ç”¨çš„åˆ†å¸ƒå¼æ–¹æ¡ˆï¼š<ul>
<li>åˆ†å¸ƒå¼åº”ç”¨å’ŒæœåŠ¡</li>
<li>åˆ†å¸ƒå¼é™æ€èµ„æº</li>
<li>åˆ†å¸ƒå¼æ•°æ®å’Œå­˜å‚¨</li>
<li>åˆ†å¸ƒå¼è®¡ç®—</li>
</ul>
</li>
<li>åˆ†å¸ƒå¼ä¹Ÿå¼•å…¥äº†ä¸€äº›é—®é¢˜ï¼š<ul>
<li>æœåŠ¡è°ƒç”¨å¿…é¡»é€šè¿‡ç½‘ç»œï¼Œç½‘ç»œå»¶è¿Ÿä¼šå½±å“æ€§èƒ½ã€‚</li>
<li>æœåŠ¡å™¨è¶Šå¤šï¼Œå®•æœºæ¦‚ç‡ä¹Ÿè¶Šå¤§ï¼Œå¯¼è‡´å¯ç”¨æ€§é™ä½ã€‚</li>
<li>æ•°æ®ä¸€è‡´æ€§éå¸¸å›°éš¾ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ä¹Ÿéš¾ä»¥ä¿è¯ã€‚</li>
<li>ç½‘ç«™ä¾èµ–é”™ç»¼å¤æ‚ï¼Œå¼€å‘ç®¡ç†ç»´æŠ¤å›°éš¾ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ä¼¸ç¼©æ€§"><a href="#ä¼¸ç¼©æ€§" class="headerlink" title="ä¼¸ç¼©æ€§"></a>ä¼¸ç¼©æ€§</h3><blockquote>
<p>è¡¡é‡ä¼¸ç¼©çš„æ ‡å‡†å°±æ˜¯æ˜¯å¦å¯ä»¥ç”¨å¤šå°æœåŠ¡å™¨æ„å»ºé›†ç¾¤ï¼Œæ˜¯å¦å®¹æ˜“å‘é›†ç¾¤ä¸­å¢åˆ æœåŠ¡å™¨èŠ‚ç‚¹ã€‚å¢åˆ æœåŠ¡å™¨èŠ‚ç‚¹åæ˜¯å¦å¯ä»¥æä¾›å’Œä¹‹å‰æ— å·®åˆ«çš„æœåŠ¡ã€‚é›†ç¾¤ä¸­å¯å®¹çº³çš„æ€»æœåŠ¡å™¨æ•°æ˜¯å¦æœ‰é™åˆ¶ã€‚</p>
</blockquote>
<p>ä¼¸ç¼©æ€§æ˜¯æŒ‡<strong>é€šè¿‡å¢&#x2F;å‡æœåŠ¡å™¨èŠ‚ç‚¹æ•°ï¼Œæ¥çµæ´»çš„æé«˜&#x2F;é™ä½ç³»ç»Ÿå¤„ç†èƒ½åŠ›</strong>ã€‚</p>
<p>ä¸»è¦æ‰‹æ®µæœ‰:</p>
<ul>
<li><strong>åº”ç”¨æœåŠ¡å™¨é›†ç¾¤</strong> - åªè¦æœåŠ¡å™¨ä¸Šä¿å­˜æ•°æ®ï¼Œåˆ™æ‰€æœ‰æœåŠ¡å™¨éƒ½æ˜¯å¯¹ç­‰çš„ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è®¾å¤‡å‘é›†ç¾¤ä¸­ä¸æ–­åŠ å…¥æœåŠ¡å™¨å³å¯</li>
<li><strong>ç¼“å­˜æœåŠ¡å™¨é›†ç¾¤</strong> - åŠ å…¥æ–°çš„æœåŠ¡å™¨å¯èƒ½ä¼šå¯¼è‡´ç¼“å­˜è·¯ç”±å¤±æ•ˆï¼Œè¿›è€Œå¯¼è‡´é›†ç¾¤ä¸­çš„å¤§éƒ¨åˆ†ç¼“å­˜æ•°æ®éƒ½æ— æ³•è®¿é—®ã€‚è™½ç„¶ç¼“å­˜æ•°æ®å¯ä»¥é€šè¿‡æ•°æ®åº“é‡æ–°åŠ è½½ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä¸¥é‡ä¾èµ–ç¼“å­˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç½‘ç«™å´©æºƒã€‚éœ€è¦æ”¹è¿›ç¼“å­˜è·¯ç”±ç®—æ³•ä¿è¯ç¼“å­˜æ•°æ®çš„å¯è®¿é—®æ€§ã€‚</li>
<li><strong>å…³ç³»å‹æ•°æ®åº“é›†ç¾¤</strong> - å…³ç³»å‹æ•°æ®åº“è™½ç„¶æ”¯æŒæ•°æ®å¤åˆ¶ï¼Œä¸»ä»çƒ­å¤‡ç­‰æœºåˆ¶ï¼Œä½†æ˜¯å¾ˆéš¾åšåˆ°å¤§è§„æ¨¡é›†ç¾¤çš„å¯ä¼¸ç¼©æ€§ï¼Œå› æ­¤å…³ç³»å‹æ•°æ®åº“çš„é›†ç¾¤ä¼¸ç¼©æ€§æ–¹æ¡ˆå¿…é¡»åœ¨æ•°æ®åº“ä¹‹å¤–å®ç°ï¼Œé€šè¿‡è·¯ç”±åˆ†åŒºç­‰æ‰‹æ®µå°†éƒ¨ç½²æœ‰å¤šä¸ªæ•°æ®åº“çš„æœåŠ¡å™¨ç»„æˆä¸€ä¸ªé›†ç¾¤ã€‚</li>
<li><strong>Nosql æ•°æ®åº“é›†ç¾¤</strong> - ç”±äºå…ˆå¤©å°±æ˜¯ä¸ºäº†åº”å¯¹æµ·é‡æ•°æ®è€Œäº§ç”Ÿï¼Œå› æ­¤å¯¹ä¼¸ç¼©æ€§çš„æ”¯æŒé€šå¸¸éƒ½éå¸¸å¥½ã€‚</li>
</ul>
<h3 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h3><p>å®‰å…¨æ˜¯æŒ‡ç³»ç»Ÿåº”è¯¥å¯¹æ¶æ„æ”»å‡»æœ‰ä¸€å®šçš„æŠµæŠ—èƒ½åŠ›ï¼Œä¿æŠ¤é‡è¦æ•°æ®ä¸è¢«çªƒå–ã€‚</p>
<ul>
<li><strong>å¯†ç </strong> å’Œ <strong>æ‰‹æœºæ ¡éªŒç </strong> è¿›è¡Œèº«ä»½è®¤è¯</li>
<li>ç™»å½•ã€äº¤æ˜“ç­‰é‡è¦æ“ä½œéœ€è¦å¯¹ç½‘ç»œé€šä¿¡è¿›è¡Œ <strong>åŠ å¯†</strong>ï¼Œå­˜å‚¨çš„æ•æ„Ÿæ•°æ®å¦‚ç”¨æˆ·ä¿¡æ¯ç­‰ä¹Ÿè¿›è¡ŒåŠ å¯†å¤„ç†</li>
<li>é˜²æ­¢æœºå™¨äººç¨‹åºæ”»å‡»ç½‘ç«™ï¼Œä½¿ç”¨ <strong>éªŒè¯ç </strong> è¿›è¡Œè¯†åˆ«</li>
<li>å¯¹å¸¸è§ç”¨äº <strong>æ”»å‡»</strong> ç½‘ç«™çš„ XSS æ”»å‡»ã€SQL æ³¨å…¥ã€è¿›è¡Œç¼–ç è½¬æ¢ç­‰ç›¸åº”å¤„ç†</li>
<li>å¯¹åƒåœ¾ä¿¡æ¯ã€æ•æ„Ÿä¿¡æ¯è¿›è¡Œ <strong>è¿‡æ»¤</strong></li>
<li>å¯¹äº¤æ˜“è½¬è´¦ç­‰é‡è¦æ“ä½œæ ¹æ®äº¤æ˜“æ¨¡å¼å’Œäº¤æ˜“ä¿¡æ¯è¿›è¡Œ <strong>é£é™©æ§åˆ¶</strong></li>
</ul>
<h2 id="å¸¸è§æ¶æ„æ¨¡å‹"><a href="#å¸¸è§æ¶æ„æ¨¡å‹" class="headerlink" title="å¸¸è§æ¶æ„æ¨¡å‹"></a>å¸¸è§æ¶æ„æ¨¡å‹</h2><h3 id="åˆ†å±‚æ¶æ„"><a href="#åˆ†å±‚æ¶æ„" class="headerlink" title="åˆ†å±‚æ¶æ„"></a>åˆ†å±‚æ¶æ„</h3><p>åˆ†å±‚æ¶æ„ï¼ˆlayered architectureï¼‰æ˜¯æœ€å¸¸è§çš„è½¯ä»¶æ¶æ„ï¼Œä¹Ÿæ˜¯äº‹å®ä¸Šçš„æ ‡å‡†æ¶æ„ã€‚</p>
<p>è¿™ç§æ¶æ„å°†è½¯ä»¶åˆ†æˆè‹¥å¹²ä¸ªæ°´å¹³å±‚ï¼Œæ¯ä¸€å±‚éƒ½æœ‰æ¸…æ™°çš„è§’è‰²å’Œåˆ†å·¥ï¼Œä¸éœ€è¦çŸ¥é“å…¶ä»–å±‚çš„ç»†èŠ‚ã€‚å±‚ä¸å±‚ä¹‹é—´é€šè¿‡æ¥å£é€šä¿¡ã€‚</p>
<p>å››å±‚çš„ç»“æ„æœ€å¸¸è§ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/layered-architecture.png" width="500"/>
</div>

<ul>
<li>è¡¨ç°å±‚ï¼ˆpresentationï¼‰ï¼šç”¨æˆ·ç•Œé¢ï¼Œè´Ÿè´£è§†è§‰å’Œç”¨æˆ·äº’åŠ¨</li>
<li>ä¸šåŠ¡å±‚ï¼ˆbusinessï¼‰ï¼šå®ç°ä¸šåŠ¡é€»è¾‘</li>
<li>æŒä¹…å±‚ï¼ˆpersistenceï¼‰ï¼šæä¾›æ•°æ®ï¼ŒSQL è¯­å¥å°±æ”¾åœ¨è¿™ä¸€å±‚</li>
<li>æ•°æ®åº“ï¼ˆdatabaseï¼‰ ï¼šä¿å­˜æ•°æ®</li>
</ul>
<p>ä¼˜ç‚¹</p>
<ul>
<li>ç»“æ„ç®€å•ï¼Œå®¹æ˜“ç†è§£å’Œå¼€å‘</li>
<li>ä¸åŒæŠ€èƒ½çš„ç¨‹åºå‘˜å¯ä»¥åˆ†å·¥ï¼Œè´Ÿè´£ä¸åŒçš„å±‚ï¼Œå¤©ç„¶é€‚åˆå¤§å¤šæ•°è½¯ä»¶å…¬å¸çš„ç»„ç»‡æ¶æ„</li>
<li>æ¯ä¸€å±‚éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•ï¼Œå…¶ä»–å±‚çš„æ¥å£é€šè¿‡æ¨¡æ‹Ÿè§£å†³</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>ä¸€æ—¦ç¯å¢ƒå˜åŒ–ï¼Œéœ€è¦ä»£ç è°ƒæ•´æˆ–å¢åŠ åŠŸèƒ½æ—¶ï¼Œé€šå¸¸æ¯”è¾ƒéº»çƒ¦å’Œè´¹æ—¶</li>
<li>éƒ¨ç½²æ¯”è¾ƒéº»çƒ¦ï¼Œå³ä½¿åªä¿®æ”¹ä¸€ä¸ªå°åœ°æ–¹ï¼Œå¾€å¾€éœ€è¦æ•´ä¸ªè½¯ä»¶é‡æ–°éƒ¨ç½²ï¼Œä¸å®¹æ˜“åšæŒç»­å‘å¸ƒ</li>
<li>è½¯ä»¶å‡çº§æ—¶ï¼Œå¯èƒ½éœ€è¦æ•´ä¸ªæœåŠ¡æš‚åœ</li>
<li>æ‰©å±•æ€§å·®ã€‚ç”¨æˆ·è¯·æ±‚å¤§é‡å¢åŠ æ—¶ï¼Œå¿…é¡»ä¾æ¬¡æ‰©å±•æ¯ä¸€å±‚ï¼Œç”±äºæ¯ä¸€å±‚å†…éƒ¨æ˜¯è€¦åˆçš„ï¼Œæ‰©å±•ä¼šå¾ˆå›°éš¾</li>
</ul>
<h3 id="äº‹ä»¶é©±åŠ¨æ¶æ„"><a href="#äº‹ä»¶é©±åŠ¨æ¶æ„" class="headerlink" title="äº‹ä»¶é©±åŠ¨æ¶æ„"></a>äº‹ä»¶é©±åŠ¨æ¶æ„</h3><p>äº‹ä»¶ï¼ˆeventï¼‰æ˜¯çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè½¯ä»¶å‘å‡ºçš„é€šçŸ¥ã€‚</p>
<p>äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆevent-driven architectureï¼‰å°±æ˜¯é€šè¿‡äº‹ä»¶è¿›è¡Œé€šä¿¡çš„è½¯ä»¶æ¶æ„ã€‚å®ƒåˆ†æˆå››ä¸ªéƒ¨åˆ†ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/event-driven-architecture.png" width="500"/>
</div>

<ul>
<li>äº‹ä»¶é˜Ÿåˆ—ï¼ˆevent queueï¼‰ï¼šæ¥æ”¶äº‹ä»¶çš„å…¥å£</li>
<li>åˆ†å‘å™¨ï¼ˆevent mediatorï¼‰ï¼šå°†ä¸åŒçš„äº‹ä»¶åˆ†å‘åˆ°ä¸åŒçš„ä¸šåŠ¡é€»è¾‘å•å…ƒ</li>
<li>äº‹ä»¶é€šé“ï¼ˆevent channelï¼‰ï¼šåˆ†å‘å™¨ä¸å¤„ç†å™¨ä¹‹é—´çš„è”ç³»æ¸ é“</li>
<li>äº‹ä»¶å¤„ç†å™¨ï¼ˆevent processorï¼‰ï¼šå®ç°ä¸šåŠ¡é€»è¾‘ï¼Œå¤„ç†å®Œæˆåä¼šå‘å‡ºäº‹ä»¶ï¼Œè§¦å‘ä¸‹ä¸€æ­¥æ“ä½œ</li>
</ul>
<p>å¯¹äºç®€å•çš„é¡¹ç›®ï¼Œäº‹ä»¶é˜Ÿåˆ—ã€åˆ†å‘å™¨å’Œäº‹ä»¶é€šé“ï¼Œå¯ä»¥åˆä¸ºä¸€ä½“ï¼Œæ•´ä¸ªè½¯ä»¶å°±åˆ†æˆäº‹ä»¶ä»£ç†å’Œäº‹ä»¶å¤„ç†å™¨ä¸¤éƒ¨åˆ†ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/simple-event-driven-architecture.png" width="500"/>
</div>

<p>ä¼˜ç‚¹</p>
<ul>
<li>åˆ†å¸ƒå¼çš„å¼‚æ­¥æ¶æ„ï¼Œäº‹ä»¶å¤„ç†å™¨ä¹‹é—´é«˜åº¦è§£è€¦ï¼Œè½¯ä»¶çš„æ‰©å±•æ€§å¥½</li>
<li>é€‚ç”¨æ€§å¹¿ï¼Œå„ç§ç±»å‹çš„é¡¹ç›®éƒ½å¯ä»¥ç”¨</li>
<li>æ€§èƒ½è¾ƒå¥½ï¼Œå› ä¸ºäº‹ä»¶çš„å¼‚æ­¥æœ¬è´¨ï¼Œè½¯ä»¶ä¸æ˜“äº§ç”Ÿå µå¡</li>
<li>äº‹ä»¶å¤„ç†å™¨å¯ä»¥ç‹¬ç«‹åœ°åŠ è½½å’Œå¸è½½ï¼Œå®¹æ˜“éƒ¨ç½²</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>æ¶‰åŠå¼‚æ­¥ç¼–ç¨‹ï¼ˆè¦è€ƒè™‘è¿œç¨‹é€šä¿¡ã€å¤±å»å“åº”ç­‰æƒ…å†µï¼‰ï¼Œå¼€å‘ç›¸å¯¹å¤æ‚</li>
<li>éš¾ä»¥æ”¯æŒåŸå­æ€§æ“ä½œï¼Œå› ä¸ºäº‹ä»¶é€šè¿‡ä¼šæ¶‰åŠå¤šä¸ªå¤„ç†å™¨ï¼Œå¾ˆéš¾å›æ»š</li>
<li>åˆ†å¸ƒå¼å’Œå¼‚æ­¥ç‰¹æ€§å¯¼è‡´è¿™ä¸ªæ¶æ„è¾ƒéš¾æµ‹è¯•</li>
</ul>
<h3 id="å¾®æ ¸æ¶æ„"><a href="#å¾®æ ¸æ¶æ„" class="headerlink" title="å¾®æ ¸æ¶æ„"></a>å¾®æ ¸æ¶æ„</h3><p>å¾®æ ¸æ¶æ„ï¼ˆmicrokernel architectureï¼‰åˆç§°ä¸ºâ€æ’ä»¶æ¶æ„â€ï¼ˆplug-in architectureï¼‰ï¼ŒæŒ‡çš„æ˜¯è½¯ä»¶çš„å†…æ ¸ç›¸å¯¹è¾ƒå°ï¼Œä¸»è¦åŠŸèƒ½å’Œä¸šåŠ¡é€»è¾‘éƒ½é€šè¿‡æ’ä»¶å®ç°ã€‚</p>
<p>å†…æ ¸ï¼ˆcoreï¼‰é€šå¸¸åªåŒ…å«ç³»ç»Ÿè¿è¡Œçš„æœ€å°åŠŸèƒ½ã€‚æ’ä»¶åˆ™æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œæ’ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œåº”è¯¥å‡å°‘åˆ°æœ€ä½ï¼Œé¿å…å‡ºç°äº’ç›¸ä¾èµ–çš„é—®é¢˜ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/plug-in-architecture.png" width="500"/>
</div>

<p>ä¼˜ç‚¹</p>
<ul>
<li>è‰¯å¥½çš„åŠŸèƒ½å»¶ä¼¸æ€§ï¼ˆextensibilityï¼‰ï¼Œéœ€è¦ä»€ä¹ˆåŠŸèƒ½ï¼Œå¼€å‘ä¸€ä¸ªæ’ä»¶å³å¯</li>
<li>åŠŸèƒ½ä¹‹é—´æ˜¯éš”ç¦»çš„ï¼Œæ’ä»¶å¯ä»¥ç‹¬ç«‹çš„åŠ è½½å’Œå¸è½½ï¼Œä½¿å¾—å®ƒæ¯”è¾ƒå®¹æ˜“éƒ¨ç½²ï¼Œ</li>
<li>å¯å®šåˆ¶æ€§é«˜ï¼Œé€‚åº”ä¸åŒçš„å¼€å‘éœ€è¦</li>
<li>å¯ä»¥æ¸è¿›å¼åœ°å¼€å‘ï¼Œé€æ­¥å¢åŠ åŠŸèƒ½</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>æ‰©å±•æ€§ï¼ˆscalabilityï¼‰å·®ï¼Œå†…æ ¸é€šå¸¸æ˜¯ä¸€ä¸ªç‹¬ç«‹å•å…ƒï¼Œä¸å®¹æ˜“åšæˆåˆ†å¸ƒå¼</li>
<li>å¼€å‘éš¾åº¦ç›¸å¯¹è¾ƒé«˜ï¼Œå› ä¸ºæ¶‰åŠåˆ°æ’ä»¶ä¸å†…æ ¸çš„é€šä¿¡ï¼Œä»¥åŠå†…éƒ¨çš„æ’ä»¶ç™»è®°æœºåˆ¶</li>
</ul>
<h3 id="å¾®æœåŠ¡æ¶æ„"><a href="#å¾®æœåŠ¡æ¶æ„" class="headerlink" title="å¾®æœåŠ¡æ¶æ„"></a>å¾®æœåŠ¡æ¶æ„</h3><p>å¾®æœåŠ¡æ¶æ„ï¼ˆmicroservices architectureï¼‰æ˜¯æœåŠ¡å¯¼å‘æ¶æ„ï¼ˆservice-oriented architectureï¼Œç¼©å†™ SOAï¼‰çš„å‡çº§ã€‚</p>
<p>æ¯ä¸€ä¸ªæœåŠ¡å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„éƒ¨ç½²å•å…ƒï¼ˆseparately deployed unitï¼‰ã€‚è¿™äº›å•å…ƒéƒ½æ˜¯åˆ†å¸ƒå¼çš„ï¼Œäº’ç›¸è§£è€¦ï¼Œé€šè¿‡è¿œç¨‹é€šä¿¡åè®®ï¼ˆæ¯”å¦‚ RESTã€SOAPï¼‰è”ç³»ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/microservices-architecture.png" width="500"/>
</div>

<p>å¾®æœåŠ¡æ¶æ„åˆ†æˆä¸‰ç§å®ç°æ¨¡å¼ã€‚</p>
<ul>
<li>RESTful API æ¨¡å¼ï¼šæœåŠ¡é€šè¿‡ API æä¾›ï¼Œäº‘æœåŠ¡å°±å±äºè¿™ä¸€ç±»</li>
<li>RESTful åº”ç”¨æ¨¡å¼ï¼šæœåŠ¡é€šè¿‡ä¼ ç»Ÿçš„ç½‘ç»œåè®®æˆ–è€…åº”ç”¨åè®®æä¾›ï¼ŒèƒŒåé€šå¸¸æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„åº”ç”¨ç¨‹åºï¼Œå¸¸è§äºä¼ä¸šå†…éƒ¨</li>
<li>é›†ä¸­æ¶ˆæ¯æ¨¡å¼ï¼šé‡‡ç”¨æ¶ˆæ¯ä»£ç†ï¼ˆmessage brokerï¼‰ï¼Œå¯ä»¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—ã€è´Ÿè½½å‡è¡¡ã€ç»Ÿä¸€æ—¥å¿—å’Œå¼‚å¸¸å¤„ç†ï¼Œç¼ºç‚¹æ˜¯ä¼šå‡ºç°å•ç‚¹å¤±è´¥ï¼Œæ¶ˆæ¯ä»£ç†å¯èƒ½è¦åšæˆé›†ç¾¤</li>
</ul>
<p>ä¼˜ç‚¹</p>
<ul>
<li>æ‰©å±•æ€§å¥½ï¼Œå„ä¸ªæœåŠ¡ä¹‹é—´ä½è€¦åˆ</li>
<li>å®¹æ˜“éƒ¨ç½²ï¼Œè½¯ä»¶ä»å•ä¸€å¯éƒ¨ç½²å•å…ƒï¼Œè¢«æ‹†æˆäº†å¤šä¸ªæœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æ˜¯å¯éƒ¨ç½²å•å…ƒ</li>
<li>å®¹æ˜“å¼€å‘ï¼Œæ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥è¿›è¡ŒæŒç»­é›†æˆå¼çš„å¼€å‘ï¼Œå¯ä»¥åšåˆ°å®æ—¶éƒ¨ç½²ï¼Œä¸é—´æ–­åœ°å‡çº§</li>
<li>æ˜“äºæµ‹è¯•ï¼Œå¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸€ä¸ªæœåŠ¡</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>ç”±äºå¼ºè°ƒäº’ç›¸ç‹¬ç«‹å’Œä½è€¦åˆï¼ŒæœåŠ¡å¯èƒ½ä¼šæ‹†åˆ†å¾—å¾ˆç»†ã€‚è¿™å¯¼è‡´ç³»ç»Ÿä¾èµ–å¤§é‡çš„å¾®æœåŠ¡ï¼Œå˜å¾—å¾ˆå‡Œä¹±å’Œç¬¨é‡ï¼Œæ€§èƒ½ä¹Ÿä¼šä¸ä½³ã€‚</li>
<li>ä¸€æ—¦æœåŠ¡ä¹‹é—´éœ€è¦é€šä¿¡ï¼ˆå³ä¸€ä¸ªæœåŠ¡è¦ç”¨åˆ°å¦ä¸€ä¸ªæœåŠ¡ï¼‰ï¼Œæ•´ä¸ªæ¶æ„å°±ä¼šå˜å¾—å¤æ‚ã€‚å…¸å‹çš„ä¾‹å­å°±æ˜¯ä¸€äº›é€šç”¨çš„ Utility ç±»ï¼Œä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯æŠŠå®ƒä»¬æ‹·è´åˆ°æ¯ä¸€ä¸ªæœåŠ¡ä¸­å»ï¼Œç”¨å†—ä½™æ¢å–æ¶æ„çš„ç®€å•æ€§ã€‚</li>
<li>åˆ†å¸ƒå¼çš„æœ¬è´¨ä½¿å¾—è¿™ç§æ¶æ„å¾ˆéš¾å®ç°åŸå­æ€§æ“ä½œï¼Œäº¤æ˜“å›æ»šä¼šæ¯”è¾ƒå›°éš¾ã€‚</li>
</ul>
<h3 id="äº‘æ¶æ„"><a href="#äº‘æ¶æ„" class="headerlink" title="äº‘æ¶æ„"></a>äº‘æ¶æ„</h3><p>äº‘ç»“æ„ï¼ˆcloud architectureï¼‰ä¸»è¦è§£å†³æ‰©å±•æ€§å’Œå¹¶å‘çš„é—®é¢˜ï¼Œæ˜¯æœ€å®¹æ˜“æ‰©å±•çš„æ¶æ„ã€‚</p>
<p>å®ƒçš„é«˜æ‰©å±•æ€§ï¼Œä¸»è¦åŸå› æ˜¯æ²¡ä½¿ç”¨ä¸­å¤®æ•°æ®åº“ï¼Œè€Œæ˜¯æŠŠæ•°æ®éƒ½å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œå˜æˆå¯å¤åˆ¶çš„å†…å­˜æ•°æ®å•å…ƒã€‚ç„¶åï¼Œä¸šåŠ¡å¤„ç†èƒ½åŠ›å°è£…æˆä¸€ä¸ªä¸ªå¤„ç†å•å…ƒï¼ˆprcessing unitï¼‰ã€‚è®¿é—®é‡å¢åŠ ï¼Œå°±æ–°å»ºå¤„ç†å•å…ƒï¼›è®¿é—®é‡å‡å°‘ï¼Œå°±å…³é—­å¤„ç†å•å…ƒã€‚ç”±äºæ²¡æœ‰ä¸­å¤®æ•°æ®åº“ï¼Œæ‰€ä»¥æ‰©å±•æ€§çš„æœ€å¤§ç“¶é¢ˆæ¶ˆå¤±äº†ã€‚ç”±äºæ¯ä¸ªå¤„ç†å•å…ƒçš„æ•°æ®éƒ½åœ¨å†…å­˜é‡Œï¼Œæœ€å¥½è¦è¿›è¡Œæ•°æ®æŒä¹…åŒ–ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/cloud-architecture.png" width="500"/>
</div>

<p>è¿™ä¸ªæ¨¡å¼ä¸»è¦åˆ†æˆä¸¤éƒ¨åˆ†ï¼šå¤„ç†å•å…ƒï¼ˆprocessing unitï¼‰å’Œè™šæ‹Ÿä¸­é—´ä»¶ï¼ˆvirtualized middlewareï¼‰ã€‚</p>
<ul>
<li>å¤„ç†å•å…ƒï¼šå®ç°ä¸šåŠ¡é€»è¾‘</li>
<li>è™šæ‹Ÿä¸­é—´ä»¶ï¼šè´Ÿè´£é€šä¿¡ã€ä¿æŒ sessionsã€æ•°æ®å¤åˆ¶ã€åˆ†å¸ƒå¼å¤„ç†ã€å¤„ç†å•å…ƒçš„éƒ¨ç½²ã€‚</li>
</ul>
<p>è™šæ‹Ÿä¸­é—´ä»¶åˆåŒ…å«å››ä¸ªç»„ä»¶ã€‚</p>
<blockquote>
<ul>
<li><strong>æ¶ˆæ¯ä¸­é—´ä»¶</strong>ï¼ˆMessaging Gridï¼‰ï¼šç®¡ç†ç”¨æˆ·è¯·æ±‚å’Œ sessionï¼Œå½“ä¸€ä¸ªè¯·æ±‚è¿›æ¥ä»¥åï¼Œå†³å®šåˆ†é…ç»™å“ªä¸€ä¸ªå¤„ç†å•å…ƒã€‚</li>
<li><strong>æ•°æ®ä¸­é—´ä»¶</strong>ï¼ˆData Gridï¼‰ï¼šå°†æ•°æ®å¤åˆ¶åˆ°æ¯ä¸€ä¸ªå¤„ç†å•å…ƒï¼Œå³æ•°æ®åŒæ­¥ã€‚ä¿è¯æŸä¸ªå¤„ç†å•å…ƒéƒ½å¾—åˆ°åŒæ ·çš„æ•°æ®ã€‚</li>
<li><strong>å¤„ç†ä¸­é—´ä»¶</strong>ï¼ˆProcessing Gridï¼‰ï¼šå¯é€‰ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚æ¶‰åŠä¸åŒç±»å‹çš„å¤„ç†å•å…ƒï¼Œè¯¥ä¸­é—´ä»¶è´Ÿè´£åè°ƒå¤„ç†å•å…ƒ</li>
<li><strong>éƒ¨ç½²ä¸­é—´ä»¶</strong>ï¼ˆDeployment Managerï¼‰ï¼šè´Ÿè´£å¤„ç†å•å…ƒçš„å¯åŠ¨å’Œå…³é—­ï¼Œç›‘æ§è´Ÿè½½å’Œå“åº”æ—¶é—´ï¼Œå½“è´Ÿè½½å¢åŠ ï¼Œå°±æ–°å¯åŠ¨å¤„ç†å•å…ƒï¼Œè´Ÿè½½å‡å°‘ï¼Œå°±å…³é—­å¤„ç†å•å…ƒã€‚</li>
</ul>
</blockquote>
<p>ä¼˜ç‚¹</p>
<ul>
<li>é«˜è´Ÿè½½ï¼Œé«˜æ‰©å±•æ€§</li>
<li>åŠ¨æ€éƒ¨ç½²</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>å®ç°å¤æ‚ï¼Œæˆæœ¬è¾ƒé«˜</li>
<li>ä¸»è¦é€‚åˆç½‘ç«™ç±»åº”ç”¨ï¼Œä¸åˆé€‚å¤§é‡æ•°æ®ååçš„å¤§å‹æ•°æ®åº“åº”ç”¨</li>
<li>è¾ƒéš¾æµ‹è¯•</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/11322972.html">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
<li>ã€Šä» 0 å¼€å§‹å­¦æ¶æ„ã€‹</li>
<li><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/09/software-architecture.html">è½¯ä»¶æ¶æ„å…¥é—¨- é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/a49605/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/a49605/" class="post-title-link" itemprop="url">ç³»ç»Ÿé«˜æ€§èƒ½æ¶æ„</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-05 15:11:00" itemprop="dateCreated datePublished" datetime="2018-07-05T15:11:00+08:00">2018-07-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">è®¾è®¡</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">æ¶æ„</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>6.9k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>6 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ç³»ç»Ÿé«˜æ€§èƒ½æ¶æ„"><a href="#ç³»ç»Ÿé«˜æ€§èƒ½æ¶æ„" class="headerlink" title="ç³»ç»Ÿé«˜æ€§èƒ½æ¶æ„"></a>ç³»ç»Ÿé«˜æ€§èƒ½æ¶æ„</h1><h2 id="æ€§èƒ½ç®€ä»‹"><a href="#æ€§èƒ½ç®€ä»‹" class="headerlink" title="æ€§èƒ½ç®€ä»‹"></a>æ€§èƒ½ç®€ä»‹</h2><p>è¦è®¾è®¡é«˜æ€§èƒ½çš„ç³»ç»Ÿæ¶æ„ï¼Œåº”è¯¥æœ‰ä»¥ä¸‹çš„æ€ç»´æ­¥éª¤ï¼š</p>
<p>é¦–å…ˆï¼Œè¦æ˜ç¡®å½±å“æ€§èƒ½çš„å› ç´ æœ‰å“ªäº›ï¼Ÿæ€§èƒ½çš„æŒ‡æ ‡æœ‰å“ªäº›ï¼Ÿâ€”â€”åšåˆ°æœ‰çš„æ”¾çŸ¢ã€‚</p>
<p>å…¶æ¬¡ï¼Œè¦äº†è§£å¦‚ä½•æµ‹è¯•æ€§èƒ½æŒ‡æ ‡ï¼Ÿæ€§èƒ½ä¼˜åŒ–ï¼Œå¿…é¡»è¦æœ‰å‰åçš„æ•ˆæœå¯¹æ¯”ï¼Œæ‰èƒ½è¯æ˜æ€§èƒ½ç¡®å®æœ‰æ”¹å–„ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå­¦ä¹ é’ˆå¯¹ä¸åŒåœºæ™¯ä¸‹ï¼Œä¸åŒæ€§æŒ‡æ ‡çš„ä¼˜åŒ–ç­–ç•¥ä»¥åŠå…·ä½“å®æ–½æ–¹æ¡ˆã€‚â€”â€”è§æ‹›æ‹†æ‹›ã€‚</p>
<h3 id="è®¡ç®—æœºèµ„æº"><a href="#è®¡ç®—æœºèµ„æº" class="headerlink" title="è®¡ç®—æœºèµ„æº"></a>è®¡ç®—æœºèµ„æº</h3><p>äº†è§£æ€§èƒ½æŒ‡æ ‡å‰ï¼Œéœ€è¦å…ˆçŸ¥é“å“ªäº›è®¡ç®—æœºèµ„æºä¼šå½±å“æ€§èƒ½ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå½±å“æ€§èƒ½çš„è®¡ç®—æœºèµ„æºåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>CPU</strong></li>
<li><strong>å†…å­˜</strong></li>
<li><strong>ç£ç›˜ I&#x2F;O</strong></li>
<li><strong>ç½‘ç»œ I&#x2F;O</strong></li>
<li><strong>æ•°æ®åº“</strong></li>
<li><strong>é”ç«äº‰</strong></li>
</ul>
<h3 id="æ€§èƒ½æŒ‡æ ‡"><a href="#æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡"></a>æ€§èƒ½æŒ‡æ ‡</h3><p>æ€§èƒ½æµ‹è¯•çš„ä¸»è¦æŒ‡æ ‡æœ‰ï¼š</p>
<ul>
<li><strong>å“åº”æ—¶é—´</strong></li>
<li><strong>å¹¶å‘æ•°</strong></li>
<li><strong>ååé‡</strong><ul>
<li>QPS</li>
<li>TPS</li>
</ul>
</li>
<li><strong>èµ„æºåˆ†é…ä½¿ç”¨ç‡</strong></li>
</ul>
<h4 id="å“åº”æ—¶é—´"><a href="#å“åº”æ—¶é—´" class="headerlink" title="å“åº”æ—¶é—´"></a>å“åº”æ—¶é—´</h4><p>å“åº”æ—¶é—´(RT)æ˜¯æŒ‡ä»å®¢æˆ·ç«¯å‘ä¸€ä¸ªè¯·æ±‚å¼€å§‹è®¡æ—¶ï¼Œåˆ°å®¢æˆ·ç«¯æ¥æ”¶åˆ°ä»æœåŠ¡å™¨ç«¯è¿”å›çš„å“åº”ç»“æœç»“æŸæ‰€ç»å†çš„æ—¶é—´ï¼Œå“åº”æ—¶é—´ç”±è¯·æ±‚å‘é€æ—¶é—´ã€ç½‘ç»œä¼ è¾“æ—¶é—´å’ŒæœåŠ¡å™¨å¤„ç†æ—¶é—´ä¸‰éƒ¨åˆ†ç»„æˆã€‚</p>
<p><strong>å“åº”æ—¶é—´è¶ŠçŸ­ï¼Œæ€§èƒ½è¶Šå¥½</strong>ï¼Œä¸€èˆ¬ä¸€ä¸ªæ¥å£çš„å“åº”æ—¶é—´æ˜¯åœ¨æ¯«ç§’çº§ã€‚</p>
<p>å“åº”æ—¶é—´å¯ä»¥è¿›ä¸€æ­¥ç»†åˆ†ï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯å“åº”æ—¶é—´</li>
<li>ç½‘ç»œå“åº”æ—¶é—´</li>
<li>æœåŠ¡ç«¯å“åº”æ—¶é—´</li>
<li>æ•°æ®åº“å“åº”æ—¶é—´</li>
</ul>
<h4 id="å¹¶å‘æ•°"><a href="#å¹¶å‘æ•°" class="headerlink" title="å¹¶å‘æ•°"></a>å¹¶å‘æ•°</h4><p><strong>å¹¶å‘æ•°æ˜¯æŒ‡ç³»ç»Ÿèƒ½åŒæ—¶å¤„ç†çš„è¯·æ±‚ã€äº‹åŠ¡æ•°</strong>ã€‚</p>
<p>ç³»ç»Ÿè‡ªèº«çš„ CPU å¤„ç†èƒ½åŠ›ã€å†…å­˜ã€ä»¥åŠç³»ç»Ÿè‡ªèº«çš„çº¿ç¨‹å¤ç”¨ã€é”ç«äº‰ç­‰éƒ½ä¼šå½±å“å¹¶å‘æ•°ã€‚</p>
<h4 id="ååé‡"><a href="#ååé‡" class="headerlink" title="ååé‡"></a>ååé‡</h4><p>ååé‡è®¡ç®—å…¬å¼ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ååé‡ <span class="operator">=</span> å¹¶å‘æ•° / å¹³å‡å“åº”æ—¶é—´</span><br></pre></td></tr></table></figure>

<p><strong>ååé‡è¶Šå¤§ï¼Œæ€§èƒ½è¶Šå¥½</strong>ã€‚</p>
<p>ä¸€èˆ¬ï¼Œç³»ç»Ÿå‘ˆç°ç»™å¤–éƒ¨çš„æœ€å¸¸è§çš„ååé‡æŒ‡æ ‡ï¼Œå°±æ˜¯ï¼š</p>
<ul>
<li><strong><code>QPS(æ¯ç§’æŸ¥è¯¢æ•°)</code></strong> - å³ç³»ç»Ÿæ¯ç§’å¯ä»¥å¤„ç†çš„è¯»è¯·æ±‚ã€‚</li>
<li><strong><code>TPS(æ¯ç§’äº‹åŠ¡æ•°)</code></strong> - å³ç³»ç»Ÿæ¯ç§’å¯ä»¥å¤„ç†çš„å†™è¯·æ±‚ã€‚</li>
</ul>
<p>è€Œåœ¨ç³»ç»Ÿå†…éƒ¨ï¼Œå­˜åœ¨ä»¥ä¸‹ååé‡ï¼š</p>
<ul>
<li>ç£ç›˜ååé‡ - ä½“ç°äº†ç£ç›˜éšæœºè¯»å†™çš„æ€§èƒ½ã€‚</li>
<li>ç½‘ç»œååé‡ - é™¤äº†å—é™äºç½‘ç»œå¸¦å®½ï¼ŒCPU çš„å¤„ç†èƒ½åŠ›ã€ç½‘å¡ã€é˜²ç«å¢™ã€å¤–éƒ¨æ¥å£ä»¥åŠ I&#x2F;Oã€ç³»ç»Ÿ IO ç®—æ³•éƒ½ä¼šå½±å“åˆ°ç½‘ç»œååé‡ã€‚</li>
</ul>
<h4 id="èµ„æºåˆ†é…ä½¿ç”¨ç‡"><a href="#èµ„æºåˆ†é…ä½¿ç”¨ç‡" class="headerlink" title="èµ„æºåˆ†é…ä½¿ç”¨ç‡"></a>èµ„æºåˆ†é…ä½¿ç”¨ç‡</h4><p>é€šå¸¸ç”± CPU å ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ã€ç£ç›˜ I&#x2F;Oã€ç½‘ç»œ I&#x2F;O ã€å¯¹è±¡ä¸çº¿ç¨‹æ•°æ¥è¡¨ç¤ºèµ„æºä½¿ç”¨ç‡ã€‚è¿™äº›æŒ‡æ ‡ä¹Ÿæ˜¯ç³»ç»Ÿç›‘æ§çš„é‡è¦å‚æ•°ã€‚</p>
<h3 id="æ€§èƒ½æµ‹è¯•"><a href="#æ€§èƒ½æµ‹è¯•" class="headerlink" title="æ€§èƒ½æµ‹è¯•"></a>æ€§èƒ½æµ‹è¯•</h3><p>æ€§èƒ½æµ‹è¯•æ‰‹æ®µï¼š</p>
<ul>
<li>æ€§èƒ½æµ‹è¯•</li>
<li>è´Ÿè½½æµ‹è¯•</li>
<li>å‹åŠ›æµ‹è¯•</li>
<li>ç¨³å®šæ€§æµ‹è¯•</li>
</ul>
<p>å¯¹äº Java åº”ç”¨è€Œè¨€ï¼Œæœ€ç®€å•çš„ï¼Œå¯ä»¥ä½¿ç”¨ Jmeter è¿›è¡Œæ€§èƒ½æµ‹è¯•ã€‚</p>
<p>æ€§èƒ½æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹ï¼š</p>
<div align="center">
<img src="https://upload-images.jianshu.io/upload_images/3101171-3d533a36f42608a1.png" />
</div>
#### æ€§èƒ½æµ‹è¯•çš„é—®é¢˜

<p>æ€§èƒ½æµ‹è¯•æ—¶ï¼Œéœ€è¦æ³¨æ„ä¸€äº›é—®é¢˜ï¼š</p>
<ul>
<li><strong>çƒ­èº«é—®é¢˜</strong> - ç³»ç»Ÿåˆšå¼€å§‹è¿è¡Œæ—¶ï¼Œè‡ªèº«å¯èƒ½åŠ è½½ç¼“å­˜ï¼ŒJVM å¯èƒ½ä¼šä¼˜åŒ–çƒ­ç‚¹ä»£ç ç­‰ï¼Œè¿™äº›è¡Œä¸ºéƒ½å¯èƒ½ä½¿å¾—å‰åæœ‰è¾ƒå¤§çš„æ€§èƒ½å·®å¼‚ã€‚æ‰€ä»¥ï¼Œæ€§èƒ½æµ‹è¯•æ—¶ï¼Œåº”è¯¥å…ˆè·³è¿‡ä¸€æ®µçƒ­èº«æ—¶é—´ï¼Œç­‰è¶‹äºç¨³å®šåï¼Œå†å¼€å§‹æ€§èƒ½æµ‹è¯•ã€‚</li>
<li><strong>æµ‹è¯•ç»“æœä¸ç¨³å®š</strong> - æ€§èƒ½æµ‹è¯•ä¸­ï¼Œæœ‰å¾ˆå¤šä¸ç¨³å®šçš„å› ç´ ï¼Œå¦‚ç¯å¢ƒã€ç½‘ç»œç­‰ï¼Œå‡ ä¹ä¸å¯èƒ½æ¯æ¬¡éƒ½æ˜¯ä¸€æ ·çš„ç»“æœã€‚æ‰€ä»¥åº”è¯¥å¤šæ¬¡æµ‹è¯•ï¼Œæ±‚å¹³å‡å€¼ã€‚</li>
<li><strong>å¤š JVM æƒ…å†µä¸‹çš„å½±å“</strong> - åº”å°½é‡é¿å…ä¸€å°æœºå™¨éƒ¨ç½²å¤šä¸ª JVM çš„æƒ…å†µã€‚å› ä¸ºä»»æ„ä¸€ä¸ª JVM éƒ½æ‹¥æœ‰æ•´ä¸ªç³»ç»Ÿçš„èµ„æºä½¿ç”¨æƒï¼Œæ‰€ä»¥åœ¨æ€§èƒ½æµ‹è¯•æ—¶ï¼Œå¯èƒ½ä¼šå½¼æ­¤å¹²æ‰°ã€‚</li>
</ul>
<h3 id="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"><a href="#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"></a>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h3><ol>
<li><strong>æ€§èƒ½åˆ†æ</strong> - å¦‚æœè¯·æ±‚å“åº”æ…¢ï¼Œå­˜åœ¨æ€§èƒ½é—®é¢˜ã€‚éœ€è¦å¯¹è¯·æ±‚ç»å†çš„å„ä¸ªç¯èŠ‚é€ä¸€åˆ†æï¼Œæ’æŸ¥å¯èƒ½å‡ºç°æ€§èƒ½ç“¶é¢ˆçš„åœ°æ–¹ï¼Œå®šä½é—®é¢˜ã€‚æ£€æŸ¥ç›‘æ§æ•°æ®ï¼Œåˆ†æå½±å“æ€§èƒ½çš„ä¸»è¦å› ç´ ï¼šå†…å­˜ã€ç£ç›˜ã€ç½‘ç»œã€CPUï¼Œå¯èƒ½æ˜¯ä»£ç æˆ–æ¶æ„è®¾è®¡ä¸åˆç†ï¼Œåˆæˆ–è€…æ˜¯ç³»ç»Ÿèµ„æºç¡®å®ä¸è¶³ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong> - æ€§èƒ½ä¼˜åŒ–æ ¹æ®ç½‘ç«™åˆ†å±‚æ¶æ„ï¼Œå¤§è‡´å¯åˆ†ä¸ºå‰ç«¯æ€§èƒ½ä¼˜åŒ–ã€åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–ã€å­˜å‚¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–ã€‚</li>
</ol>
<h2 id="åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–"><a href="#åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–"></a>åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–</h2><h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h3><p>ç½‘ç«™æ€§èƒ½ä¼˜åŒ–ç¬¬ä¸€å®šå¾‹ï¼š<strong>ç¬¬ä¸€ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ç¼“å­˜æå‡æ€§èƒ½</strong>ã€‚</p>
<p>ç¼“å­˜æ˜¯ç”¨äºå­˜å‚¨æ•°æ®çš„ç¡¬ä»¶æˆ–è½¯ä»¶çš„ç»„æˆéƒ¨åˆ†ï¼Œä»¥ä½¿å¾—åç»­æ›´å¿«è®¿é—®ç›¸åº”çš„æ•°æ®ã€‚ç¼“å­˜ä¸­çš„æ•°æ®å¯èƒ½æ˜¯æå‰è®¡ç®—å¥½çš„ç»“æœã€æ•°æ®çš„å‰¯æœ¬ç­‰ã€‚</p>
<ul>
<li>å•ç‚¹åº”ç”¨å¯ä»¥ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜ï¼ˆå¦‚ï¼šConcurrentHashMapã€Caffeineï¼‰ï¼›</li>
<li>åˆ†å¸ƒå¼åº”ç”¨å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¦‚ï¼šRedisã€Memcachedï¼‰ï¼Œæˆ–è¿›ç¨‹ç¼“å­˜+åˆ†å¸ƒå¼ç¼“å­˜çš„å¤šçº§ç¼“å­˜æ–¹æ¡ˆã€‚</li>
</ul>
<blockquote>
<p>ç¼“å­˜è§£å†³æ–¹æ¡ˆè¯·å‚è€ƒï¼š<a href="https://dunwu.github.io/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98.html">ç¼“å­˜åŸºæœ¬åŸç†</a></p>
</blockquote>
<h3 id="å¹¶å‘æ¨¡å‹"><a href="#å¹¶å‘æ¨¡å‹" class="headerlink" title="å¹¶å‘æ¨¡å‹"></a>å¹¶å‘æ¨¡å‹</h3><p>é«˜å¹¶å‘éœ€è¦æ ¹æ®ä¸¤ä¸ªæ¡ä»¶åˆ’åˆ†ï¼šè¿æ¥æ•°é‡ï¼Œè¯·æ±‚æ•°é‡ã€‚</p>
<ul>
<li>æµ·é‡è¿æ¥ï¼ˆæˆåƒä¸Šä¸‡ï¼‰æµ·é‡è¯·æ±‚ï¼šä¾‹å¦‚æŠ¢è´­ï¼ŒåŒåä¸€ç­‰</li>
<li>å¸¸é‡è¿æ¥ï¼ˆå‡ åä¸Šç™¾ï¼‰æµ·é‡è¯·æ±‚ï¼šä¾‹å¦‚ä¸­é—´ä»¶</li>
<li>æµ·é‡è¿æ¥å¸¸é‡è¯·æ±‚ï¼šä¾‹å¦‚é—¨æˆ·ç½‘ç«™</li>
<li>å¸¸é‡è¿æ¥å¸¸é‡è¯·æ±‚ï¼šä¾‹å¦‚å†…éƒ¨è¿è¥ç³»ç»Ÿï¼Œç®¡ç†ç³»ç»Ÿ</li>
</ul>
<p>å•æœåŠ¡å™¨é«˜æ€§èƒ½çš„å…³é”®ä¹‹ä¸€å°±æ˜¯<strong>æœåŠ¡å™¨é‡‡å–çš„å¹¶å‘æ¨¡å‹</strong></p>
<ul>
<li>æœåŠ¡å™¨å¦‚ä½•ç®¡ç†è¿æ¥ã€‚</li>
<li>æœåŠ¡å™¨å¦‚ä½•å¤„ç†è¯·æ±‚ã€‚</li>
</ul>
<p>ä»¥ä¸Šä¸¤ä¸ªè®¾è®¡ç‚¹æœ€ç»ˆéƒ½å’Œæ“ä½œç³»ç»Ÿçš„ I&#x2F;O æ¨¡å‹åŠè¿›ç¨‹æ¨¡å‹ç›¸å…³ã€‚</p>
<ul>
<li>I&#x2F;O æ¨¡å‹ï¼šé˜»å¡ã€éé˜»å¡ã€åŒæ­¥ã€å¼‚æ­¥ã€‚</li>
<li>è¿›ç¨‹æ¨¡å‹ï¼šå•è¿›ç¨‹ã€å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹ã€‚</li>
</ul>
<h4 id="PPC"><a href="#PPC" class="headerlink" title="PPC"></a>PPC</h4><p>PPC æ˜¯ Process Per Connection çš„ç¼©å†™ï¼Œå…¶å«ä¹‰æ˜¯æŒ‡æ¯æ¬¡æœ‰æ–°çš„è¿æ¥å°±æ–°å»ºä¸€ä¸ªè¿›ç¨‹å»ä¸“é—¨å¤„ç†è¿™ä¸ªè¿æ¥çš„è¯·æ±‚ï¼Œè¿™æ˜¯ä¼ ç»Ÿçš„ UNIX ç½‘ç»œæœåŠ¡å™¨æ‰€é‡‡ç”¨çš„æ¨¡å‹ã€‚åŸºæœ¬çš„æµç¨‹å›¾æ˜¯ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200608103701.png" alt="img"></p>
<ul>
<li>çˆ¶è¿›ç¨‹æ¥å—è¿æ¥ï¼ˆå›¾ä¸­ acceptï¼‰ã€‚</li>
<li>çˆ¶è¿›ç¨‹â€œforkâ€å­è¿›ç¨‹ï¼ˆå›¾ä¸­ forkï¼‰ã€‚</li>
<li>å­è¿›ç¨‹å¤„ç†è¿æ¥çš„è¯»å†™è¯·æ±‚ï¼ˆå›¾ä¸­å­è¿›ç¨‹ readã€ä¸šåŠ¡å¤„ç†ã€writeï¼‰ã€‚</li>
<li>å­è¿›ç¨‹å…³é—­è¿æ¥ï¼ˆå›¾ä¸­å­è¿›ç¨‹ä¸­çš„ closeï¼‰ã€‚</li>
</ul>
<p>è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>fork ä»£ä»·é«˜</li>
<li>çˆ¶å­è¿›ç¨‹é€šä¿¡å¤æ‚</li>
<li>æ”¯æŒçš„å¹¶å‘è¿æ¥æ•°é‡æœ‰é™</li>
</ul>
<h4 id="prefork"><a href="#prefork" class="headerlink" title="prefork"></a>prefork</h4><p>PPC æ¨¡å¼ä¸­ï¼Œå½“è¿æ¥è¿›æ¥æ—¶æ‰ fork æ–°è¿›ç¨‹æ¥å¤„ç†è¿æ¥è¯·æ±‚ï¼Œç”±äº fork è¿›ç¨‹ä»£ä»·é«˜ï¼Œç”¨æˆ·è®¿é—®æ—¶å¯èƒ½æ„Ÿè§‰æ¯”è¾ƒæ…¢ï¼Œprefork æ¨¡å¼çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>é¡¾åæ€ä¹‰ï¼Œprefork å°±æ˜¯æå‰åˆ›å»ºè¿›ç¨‹ï¼ˆpre-forkï¼‰ã€‚ç³»ç»Ÿåœ¨å¯åŠ¨çš„æ—¶å€™å°±é¢„å…ˆåˆ›å»ºå¥½è¿›ç¨‹ï¼Œç„¶åæ‰å¼€å§‹æ¥å—ç”¨æˆ·çš„è¯·æ±‚ï¼Œå½“æœ‰æ–°çš„è¿æ¥è¿›æ¥çš„æ—¶å€™ï¼Œå°±å¯ä»¥çœå» fork è¿›ç¨‹çš„æ“ä½œï¼Œè®©ç”¨æˆ·è®¿é—®æ›´å¿«ã€ä½“éªŒæ›´å¥½ã€‚prefork çš„åŸºæœ¬ç¤ºæ„å›¾æ˜¯ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200608104151.png" alt="img"></p>
<p>prefork çš„å®ç°å…³é”®å°±æ˜¯å¤šä¸ªå­è¿›ç¨‹éƒ½ accept åŒä¸€ä¸ª socketï¼Œå½“æœ‰æ–°çš„è¿æ¥è¿›å…¥æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¿è¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹èƒ½æœ€å accept æˆåŠŸã€‚ä½†è¿™é‡Œä¹Ÿå­˜åœ¨ä¸€ä¸ªå°å°çš„é—®é¢˜ï¼šâ€œæƒŠç¾¤â€ç°è±¡ï¼Œå°±æ˜¯æŒ‡è™½ç„¶åªæœ‰ä¸€ä¸ªå­è¿›ç¨‹èƒ½ accept æˆåŠŸï¼Œä½†æ‰€æœ‰é˜»å¡åœ¨ accept ä¸Šçš„å­è¿›ç¨‹éƒ½ä¼šè¢«å”¤é†’ï¼Œè¿™æ ·å°±å¯¼è‡´äº†ä¸å¿…è¦çš„è¿›ç¨‹è°ƒåº¦å’Œä¸Šä¸‹æ–‡åˆ‡æ¢äº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¾‹å¦‚ Linux 2.6 ç‰ˆæœ¬åå†…æ ¸å·²ç»è§£å†³äº† accept æƒŠç¾¤é—®é¢˜ã€‚</p>
<p>prefork æ¨¡å¼å’Œ PPC ä¸€æ ·ï¼Œè¿˜æ˜¯å­˜åœ¨çˆ¶å­è¿›ç¨‹é€šä¿¡å¤æ‚ã€æ”¯æŒçš„å¹¶å‘è¿æ¥æ•°é‡æœ‰é™çš„é—®é¢˜ï¼Œå› æ­¤ç›®å‰å®é™…åº”ç”¨ä¹Ÿä¸å¤šã€‚Apache æœåŠ¡å™¨æä¾›äº† MPM prefork æ¨¡å¼ï¼Œæ¨èåœ¨éœ€è¦å¯é æ€§æˆ–è€…ä¸æ—§è½¯ä»¶å…¼å®¹çš„ç«™ç‚¹æ—¶é‡‡ç”¨è¿™ç§æ¨¡å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹æœ€å¤§æ”¯æŒ 256 ä¸ªå¹¶å‘è¿æ¥ã€‚</p>
<h4 id="TPC"><a href="#TPC" class="headerlink" title="TPC"></a>TPC</h4><p>TPC æ˜¯ Thread Per Connection çš„ç¼©å†™ï¼Œå…¶å«ä¹‰æ˜¯æŒ‡æ¯æ¬¡æœ‰æ–°çš„è¿æ¥å°±æ–°å»ºä¸€ä¸ªçº¿ç¨‹å»ä¸“é—¨å¤„ç†è¿™ä¸ªè¿æ¥çš„è¯·æ±‚ã€‚ä¸è¿›ç¨‹ç›¸æ¯”ï¼Œçº¿ç¨‹æ›´è½»é‡çº§ï¼Œåˆ›å»ºçº¿ç¨‹çš„æ¶ˆè€—æ¯”è¿›ç¨‹è¦å°‘å¾—å¤šï¼›åŒæ—¶å¤šçº¿ç¨‹æ˜¯å…±äº«è¿›ç¨‹å†…å­˜ç©ºé—´çš„ï¼Œçº¿ç¨‹é€šä¿¡ç›¸æ¯”è¿›ç¨‹é€šä¿¡æ›´ç®€å•ã€‚å› æ­¤ï¼ŒTPC å®é™…ä¸Šæ˜¯è§£å†³æˆ–è€…å¼±åŒ–äº† PPC fork ä»£ä»·é«˜çš„é—®é¢˜å’Œçˆ¶å­è¿›ç¨‹é€šä¿¡å¤æ‚çš„é—®é¢˜ã€‚</p>
<p>TPC çš„åŸºæœ¬æµç¨‹æ˜¯ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200608104311.png" alt="img"></p>
<ul>
<li>çˆ¶è¿›ç¨‹æ¥å—è¿æ¥ï¼ˆå›¾ä¸­ acceptï¼‰ã€‚</li>
<li>çˆ¶è¿›ç¨‹åˆ›å»ºå­çº¿ç¨‹ï¼ˆå›¾ä¸­ pthreadï¼‰ã€‚</li>
<li>å­çº¿ç¨‹å¤„ç†è¿æ¥çš„è¯»å†™è¯·æ±‚ï¼ˆå›¾ä¸­å­çº¿ç¨‹ readã€ä¸šåŠ¡å¤„ç†ã€writeï¼‰ã€‚</li>
<li>å­çº¿ç¨‹å…³é—­è¿æ¥ï¼ˆå›¾ä¸­å­çº¿ç¨‹ä¸­çš„ closeï¼‰ã€‚</li>
</ul>
<p>æ³¨æ„ï¼Œå’Œ PPC ç›¸æ¯”ï¼Œä¸»è¿›ç¨‹ä¸ç”¨â€œcloseâ€è¿æ¥äº†ã€‚åŸå› æ˜¯åœ¨äºå­çº¿ç¨‹æ˜¯å…±äº«ä¸»è¿›ç¨‹çš„è¿›ç¨‹ç©ºé—´çš„ï¼Œè¿æ¥çš„æ–‡ä»¶æè¿°ç¬¦å¹¶æ²¡æœ‰è¢«å¤åˆ¶ï¼Œå› æ­¤åªéœ€è¦ä¸€æ¬¡ close å³å¯ã€‚</p>
<p>TPC è™½ç„¶è§£å†³äº† fork ä»£ä»·é«˜å’Œè¿›ç¨‹é€šä¿¡å¤æ‚çš„é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿå¼•å…¥äº†æ–°çš„é—®é¢˜ï¼Œå…·ä½“è¡¨ç°åœ¨ï¼š</p>
<ul>
<li>åˆ›å»ºçº¿ç¨‹è™½ç„¶æ¯”åˆ›å»ºè¿›ç¨‹ä»£ä»·ä½ï¼Œä½†å¹¶ä¸æ˜¯æ²¡æœ‰ä»£ä»·ï¼Œé«˜å¹¶å‘æ—¶ï¼ˆä¾‹å¦‚æ¯ç§’ä¸Šä¸‡è¿æ¥ï¼‰è¿˜æ˜¯æœ‰æ€§èƒ½é—®é¢˜ã€‚</li>
<li>æ— é¡»è¿›ç¨‹é—´é€šä¿¡ï¼Œä½†æ˜¯çº¿ç¨‹é—´çš„äº’æ–¥å’Œå…±äº«åˆå¼•å…¥äº†å¤æ‚åº¦ï¼Œå¯èƒ½ä¸€ä¸å°å¿ƒå°±å¯¼è‡´äº†æ­»é”é—®é¢˜ã€‚</li>
<li>å¤šçº¿ç¨‹ä¼šå‡ºç°äº’ç›¸å½±å“çš„æƒ…å†µï¼ŒæŸä¸ªçº¿ç¨‹å‡ºç°å¼‚å¸¸æ—¶ï¼Œå¯èƒ½å¯¼è‡´æ•´ä¸ªè¿›ç¨‹é€€å‡ºï¼ˆä¾‹å¦‚å†…å­˜è¶Šç•Œï¼‰ã€‚</li>
</ul>
<p>é™¤äº†å¼•å…¥äº†æ–°çš„é—®é¢˜ï¼ŒTPC è¿˜æ˜¯å­˜åœ¨ CPU çº¿ç¨‹è°ƒåº¦å’Œåˆ‡æ¢ä»£ä»·çš„é—®é¢˜ã€‚å› æ­¤ï¼ŒTPC æ–¹æ¡ˆæœ¬è´¨ä¸Šå’Œ PPC æ–¹æ¡ˆåŸºæœ¬ç±»ä¼¼ï¼Œåœ¨å¹¶å‘å‡ ç™¾è¿æ¥çš„åœºæ™¯ä¸‹ï¼Œåè€Œæ›´å¤šåœ°æ˜¯é‡‡ç”¨ PPC çš„æ–¹æ¡ˆï¼Œå› ä¸º PPC æ–¹æ¡ˆä¸ä¼šæœ‰æ­»é”çš„é£é™©ï¼Œä¹Ÿä¸ä¼šå¤šè¿›ç¨‹äº’ç›¸å½±å“ï¼Œç¨³å®šæ€§æ›´é«˜ã€‚</p>
<h4 id="prethread"><a href="#prethread" class="headerlink" title="prethread"></a>prethread</h4><p>TPC æ¨¡å¼ä¸­ï¼Œå½“è¿æ¥è¿›æ¥æ—¶æ‰åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†è¿æ¥è¯·æ±‚ï¼Œè™½ç„¶åˆ›å»ºçº¿ç¨‹æ¯”åˆ›å»ºè¿›ç¨‹è¦æ›´åŠ è½»é‡çº§ï¼Œä½†è¿˜æ˜¯æœ‰ä¸€å®šçš„ä»£ä»·ï¼Œè€Œ prethread æ¨¡å¼å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å’Œ prefork ç±»ä¼¼ï¼Œprethread æ¨¡å¼ä¼šé¢„å…ˆåˆ›å»ºçº¿ç¨‹ï¼Œç„¶åæ‰å¼€å§‹æ¥å—ç”¨æˆ·çš„è¯·æ±‚ï¼Œå½“æœ‰æ–°çš„è¿æ¥è¿›æ¥çš„æ—¶å€™ï¼Œå°±å¯ä»¥çœå»åˆ›å»ºçº¿ç¨‹çš„æ“ä½œï¼Œè®©ç”¨æˆ·æ„Ÿè§‰æ›´å¿«ã€ä½“éªŒæ›´å¥½ã€‚</p>
<p>ç”±äºå¤šçº¿ç¨‹ä¹‹é—´æ•°æ®å…±äº«å’Œé€šä¿¡æ¯”è¾ƒæ–¹ä¾¿ï¼Œå› æ­¤å®é™…ä¸Š prethread çš„å®ç°æ–¹å¼ç›¸æ¯” prefork è¦çµæ´»ä¸€äº›ï¼Œå¸¸è§çš„å®ç°æ–¹å¼æœ‰ä¸‹é¢å‡ ç§ï¼š</p>
<ul>
<li>ä¸»è¿›ç¨‹ acceptï¼Œç„¶åå°†è¿æ¥äº¤ç»™æŸä¸ªçº¿ç¨‹å¤„ç†ã€‚</li>
<li>å­çº¿ç¨‹éƒ½å°è¯•å» acceptï¼Œæœ€ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹ accept æˆåŠŸï¼Œæ–¹æ¡ˆçš„åŸºæœ¬ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200608104922.png" alt="img"></p>
<p>Apache æœåŠ¡å™¨çš„ MPM worker æ¨¡å¼æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§ prethread æ–¹æ¡ˆï¼Œä½†ç¨å¾®åšäº†æ”¹è¿›ã€‚Apache æœåŠ¡å™¨ä¼šé¦–å…ˆåˆ›å»ºå¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹é‡Œé¢å†åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œè¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†è€ƒè™‘ç¨³å®šæ€§ï¼Œå³ï¼šå³ä½¿æŸä¸ªå­è¿›ç¨‹é‡Œé¢çš„æŸä¸ªçº¿ç¨‹å¼‚å¸¸å¯¼è‡´æ•´ä¸ªå­è¿›ç¨‹é€€å‡ºï¼Œè¿˜ä¼šæœ‰å…¶ä»–å­è¿›ç¨‹ç»§ç»­æä¾›æœåŠ¡ï¼Œä¸ä¼šå¯¼è‡´æ•´ä¸ªæœåŠ¡å™¨å…¨éƒ¨æŒ‚æ‰ã€‚</p>
<p>prethread ç†è®ºä¸Šå¯ä»¥æ¯” prefork æ”¯æŒæ›´å¤šçš„å¹¶å‘è¿æ¥ï¼ŒApache æœåŠ¡å™¨ MPM worker æ¨¡å¼é»˜è®¤æ”¯æŒ 16 Ã— 25 &#x3D; 400 ä¸ªå¹¶å‘å¤„ç†çº¿ç¨‹ã€‚</p>
<h4 id="Reactor"><a href="#Reactor" class="headerlink" title="Reactor"></a>Reactor</h4><p>I&#x2F;O å¤šè·¯å¤ç”¨æŠ€æœ¯å½’çº³èµ·æ¥æœ‰ä¸¤ä¸ªå…³é”®å®ç°ç‚¹ï¼š</p>
<ul>
<li>å½“å¤šæ¡è¿æ¥å…±ç”¨ä¸€ä¸ªé˜»å¡å¯¹è±¡åï¼Œè¿›ç¨‹åªéœ€è¦åœ¨ä¸€ä¸ªé˜»å¡å¯¹è±¡ä¸Šç­‰å¾…ï¼Œè€Œæ— é¡»å†è½®è¯¢æ‰€æœ‰è¿æ¥ï¼Œå¸¸è§çš„å®ç°æ–¹å¼æœ‰ <code>select</code>ã€<code>epoll</code>ã€<code>kqueue</code> ç­‰ã€‚</li>
<li>å½“æŸæ¡è¿æ¥æœ‰æ–°çš„æ•°æ®å¯ä»¥å¤„ç†æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šé€šçŸ¥è¿›ç¨‹ï¼Œè¿›ç¨‹ä»é˜»å¡çŠ¶æ€è¿”å›ï¼Œå¼€å§‹è¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚</li>
</ul>
<p>I&#x2F;O å¤šè·¯å¤ç”¨ç»“åˆçº¿ç¨‹æ± ï¼Œå®Œç¾åœ°è§£å†³äº† PPC å’Œ TPC çš„é—®é¢˜</p>
<p>Reactor æ¨¡å¼çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†åŒ…æ‹¬ Reactor å’Œå¤„ç†èµ„æºæ± ï¼ˆè¿›ç¨‹æ± æˆ–çº¿ç¨‹æ± ï¼‰ï¼Œå…¶ä¸­ Reactor è´Ÿè´£ç›‘å¬å’Œåˆ†é…äº‹ä»¶ï¼Œå¤„ç†èµ„æºæ± è´Ÿè´£å¤„ç†äº‹ä»¶ã€‚åˆçœ‹ Reactor çš„å®ç°æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä½†å®é™…ä¸Šç»“åˆä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼ŒReactor æ¨¡å¼çš„å…·ä½“å®ç°æ–¹æ¡ˆçµæ´»å¤šå˜ï¼Œä¸»è¦ä½“ç°åœ¨ï¼š</p>
<ul>
<li>Reactor çš„æ•°é‡å¯ä»¥å˜åŒ–ï¼šå¯ä»¥æ˜¯ä¸€ä¸ª Reactorï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª Reactorã€‚</li>
<li>èµ„æºæ± çš„æ•°é‡å¯ä»¥å˜åŒ–ï¼šä»¥è¿›ç¨‹ä¸ºä¾‹ï¼Œå¯ä»¥æ˜¯å•ä¸ªè¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªè¿›ç¨‹ï¼ˆçº¿ç¨‹ç±»ä¼¼ï¼‰ã€‚</li>
</ul>
<p>æœ€ç»ˆ Reactor æ¨¡å¼æœ‰è¿™ä¸‰ç§å…¸å‹çš„å®ç°æ–¹æ¡ˆï¼š</p>
<ul>
<li>å• Reactor å•è¿›ç¨‹ &#x2F; çº¿ç¨‹ã€‚</li>
<li>å• Reactor å¤šçº¿ç¨‹ã€‚</li>
<li>å¤š Reactor å¤šè¿›ç¨‹ &#x2F; çº¿ç¨‹ã€‚</li>
</ul>
<h3 id="å¼‚æ­¥æ“ä½œ"><a href="#å¼‚æ­¥æ“ä½œ" class="headerlink" title="å¼‚æ­¥æ“ä½œ"></a>å¼‚æ­¥æ“ä½œ</h3><p>å¼‚æ­¥å¤„ç†ä¸ä»…å¯ä»¥å‡å°‘ç³»ç»ŸæœåŠ¡é—´çš„è€¦åˆåº¦ï¼Œæé«˜æ‰©å±•æ€§ï¼Œäº‹å®ä¸Šï¼Œå®ƒè¿˜å¯ä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚å¼‚æ­¥å¤„ç†å¯ä»¥æœ‰æ•ˆå‡å°‘å“åº”ç­‰å¾…æ—¶é—´ï¼Œä»è€Œæé«˜å“åº”é€Ÿåº¦ã€‚</p>
<p>å¼‚æ­¥å¤„ç†ä¸€èˆ¬æ˜¯é€šè¿‡åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼ã€‚</p>
<p>å¼‚æ­¥å¤„ç†å¯ä»¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>å¼‚æ­¥å“åº”</li>
<li>åº”ç”¨è§£è€¦</li>
<li>æµé‡å‰Šé”‹</li>
<li>æ—¥å¿—å¤„ç†</li>
<li>æ¶ˆæ¯é€šè®¯</li>
</ul>
<h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œä½¿ç”¨è´Ÿè½½å‡è¡¡æŠ€æœ¯ä¸ºä¸€ä¸ªåº”ç”¨æ„å»ºä¸€ä¸ªç”±å¤šå°æœåŠ¡å™¨ç»„æˆçš„æœåŠ¡å™¨é›†ç¾¤ï¼Œå°†å¹¶å‘è®¿é—®è¯·æ±‚åˆ†å‘åˆ°å¤šå°æœåŠ¡å™¨ä¸Šå¤„ç†ï¼Œé¿å…å•ä¸€æœåŠ¡å™¨å› è´Ÿè½½å‹åŠ›è¿‡å¤§è€Œå“åº”ç¼“æ…¢ï¼Œä½¿ç”¨æˆ·è¯·æ±‚å…·æœ‰æ›´å¥½çš„å“åº”å»¶è¿Ÿç‰¹æ€§ã€‚</p>
<p><strong>é«˜æ€§èƒ½é›†ç¾¤çš„å¤æ‚æ€§ä¸»è¦ä½“ç°åœ¨éœ€è¦å¢åŠ ä¸€ä¸ªä»»åŠ¡åˆ†é…å™¨ï¼Œä»¥åŠä¸ºä»»åŠ¡é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ä»»åŠ¡åˆ†é…ç®—æ³•</strong>ã€‚</p>
<blockquote>
<p>ç¼“å­˜è§£å†³æ–¹æ¡ˆè¯·å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/load-balance.md">è´Ÿè½½å‡è¡¡</a></p>
</blockquote>
<h3 id="ä»£ç ä¼˜åŒ–"><a href="#ä»£ç ä¼˜åŒ–" class="headerlink" title="ä»£ç ä¼˜åŒ–"></a>ä»£ç ä¼˜åŒ–</h3><h4 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h4><p>ä»èµ„æºåˆ©ç”¨çš„è§’åº¦çœ‹ï¼Œä½¿ç”¨å¤šçº¿ç¨‹çš„åŸå› ä¸»è¦æœ‰ä¸¤ä¸ªï¼šIO é˜»å¡å’Œå¤š CPUã€‚</p>
<p>çº¿ç¨‹æ•°å¹¶éè¶Šå¤šè¶Šå¥½ï¼Œé‚£ä¹ˆå¯åŠ¨å¤šå°‘çº¿ç¨‹åˆé€‚å‘¢ï¼Ÿ</p>
<p>æœ‰ä¸ªå‚è€ƒå…¬å¼ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯åŠ¨çº¿ç¨‹æ•° <span class="operator">=</span> (ä»»åŠ¡æ‰§è¡Œæ—¶é—´ / (ä»»åŠ¡æ‰§è¡Œæ—¶é—´ - IO ç­‰å¾…æ—¶é—´)) * CPU å†…æ ¸æ•°</span><br></pre></td></tr></table></figure>

<p>æœ€ä½³å¯åŠ¨çº¿ç¨‹æ•°å’Œ CPU å†…æ ¸æ•°æˆæ­£æ¯”ï¼Œå’Œ IO é˜»å¡æ—¶é—´æˆåæ¯”ã€‚</p>
<ul>
<li>å¦‚æœä»»åŠ¡éƒ½æ˜¯ CPU è®¡ç®—å‹ä»»åŠ¡ï¼Œé‚£ä¹ˆçº¿ç¨‹æ•°æœ€å¤šä¸è¦è¶…è¿‡ CPU å†…æ ¸æ•°ï¼Œå› ä¸ºå¯åŠ¨å†å¤šçº¿ç¨‹ï¼ŒCPU ä¹Ÿæ¥ä¸åŠè°ƒåº¦ï¼›</li>
<li>ç›¸åï¼Œå¦‚æœæ˜¯ä»»åŠ¡éœ€è¦ç­‰å¾…ç£ç›˜æ“ä½œï¼Œç½‘ç»œå“åº”ï¼Œé‚£ä¹ˆå¤šå¯åŠ¨çº¿ç¨‹æœ‰åŠ©äºä»»åŠ¡å¹¶å‘ï¼Œæé«˜ç³»ç»Ÿååé‡ã€‚</li>
</ul>
<h5 id="çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>çº¿ç¨‹å®‰å…¨é—®é¢˜</h5><p>çº¿ç¨‹å®‰å…¨é—®é¢˜æ—¶æŒ‡å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸ªèµ„æºï¼Œå¯¼è‡´æ•°æ®æ··ä¹±ã€‚</p>
<p>è§£å†³æ‰‹æ®µæœ‰ï¼š</p>
<ul>
<li><strong>å°†å¯¹è±¡è®¾è®¡ä¸ºæ— çŠ¶æ€å¯¹è±¡</strong> - å…¸å‹åº”ç”¨ï¼šServlet å°±æ˜¯æ— çŠ¶æ€å¯¹è±¡ï¼Œå¯ä»¥è¢«æœåŠ¡å™¨å¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨å¤„ç†ç”¨æˆ·è¯·æ±‚ã€‚</li>
<li><strong>ä½¿ç”¨å±€éƒ¨å¯¹è±¡</strong></li>
<li><strong>å¹¶å‘è®¿é—®èµ„æºæ—¶ä½¿ç”¨é”</strong> - ä½†æ˜¯å¼•å…¥é”ä¼šäº§ç”Ÿæ€§èƒ½å¼€é”€ï¼Œåº”å°½é‡ä½¿ç”¨è½»é‡çº§çš„é”ã€‚</li>
</ul>
<h4 id="èµ„æºå¤ç”¨"><a href="#èµ„æºå¤ç”¨" class="headerlink" title="èµ„æºå¤ç”¨"></a>èµ„æºå¤ç”¨</h4><p>åº”è¯¥å°½é‡å‡å°‘é‚£äº›å¼€é”€å¾ˆå¤§çš„ç³»ç»Ÿèµ„æºçš„åˆ›å»ºå’Œé”€æ¯ï¼Œå¦‚æ•°æ®åº“è¿æ¥ã€ç½‘ç»œé€šä¿¡è¿æ¥ã€çº¿ç¨‹ã€å¤æ‚å¯¹è±¡ç­‰ã€‚ä»ç¼–ç¨‹è§’åº¦ï¼Œèµ„æºå¤ç”¨ä¸»è¦æœ‰ä¸¤ç§æ¨¡å¼ï¼šå•ä¾‹æ¨¡å¼å’Œå¯¹è±¡æ± ã€‚</p>
<h4 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><p>æ ¹æ®å…·ä½“åœºæ™¯ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ã€‚</p>
<h4 id="åƒåœ¾å›æ”¶"><a href="#åƒåœ¾å›æ”¶" class="headerlink" title="åƒåœ¾å›æ”¶"></a>åƒåœ¾å›æ”¶</h4><p>å¦‚æœ Web åº”ç”¨è¿è¡Œåœ¨ JVM ç­‰å…·æœ‰åƒåœ¾å›æ”¶åŠŸèƒ½çš„ç¯å¢ƒä¸­ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶å¯èƒ½ä¼šå¯¹ç³»ç»Ÿçš„æ€§èƒ½ç‰¹æ€§äº§ç”Ÿå·¨å¤§å½±å“ã€‚ç«‹å³åƒåœ¾å›æ”¶æœºåˆ¶æœ‰åŠ©äºç¨‹åºä¼˜åŒ–å’Œå‚æ•°è°ƒä¼˜ï¼Œä»¥åŠç¼–å†™å†…å­˜å®‰å…¨çš„ä»£ç ã€‚</p>
<h2 id="å­˜å‚¨æ€§èƒ½ä¼˜åŒ–"><a href="#å­˜å‚¨æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="å­˜å‚¨æ€§èƒ½ä¼˜åŒ–"></a>å­˜å‚¨æ€§èƒ½ä¼˜åŒ–</h2><h3 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h3><h4 id="æ•°æ®åº“è¯»å†™åˆ†ç¦»"><a href="#æ•°æ®åº“è¯»å†™åˆ†ç¦»" class="headerlink" title="æ•°æ®åº“è¯»å†™åˆ†ç¦»"></a>æ•°æ®åº“è¯»å†™åˆ†ç¦»</h4><p><strong>è¯»å†™åˆ†ç¦»çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®åº“è¯»å†™æ“ä½œåˆ†æ•£åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Š</strong></p>
<blockquote>
<p>è¯¦ç»†è§£å†³æ–¹æ¡ˆå‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/distributed-storage.md">åˆ†å¸ƒå¼å­˜å‚¨</a></p>
</blockquote>
<h4 id="æ•°æ®åº“åˆ†åº“åˆ†è¡¨"><a href="#æ•°æ®åº“åˆ†åº“åˆ†è¡¨" class="headerlink" title="æ•°æ®åº“åˆ†åº“åˆ†è¡¨"></a>æ•°æ®åº“åˆ†åº“åˆ†è¡¨</h4><p><strong>æ•°æ®åˆ†ç‰‡æŒ‡æŒ‰ç…§æŸä¸ªç»´åº¦å°†å­˜æ”¾åœ¨å•ä¸€æ•°æ®åº“ä¸­çš„æ•°æ®åˆ†æ•£åœ°å­˜æ”¾è‡³å¤šä¸ªæ•°æ®åº“æˆ–è¡¨ä¸­ä»¥è¾¾åˆ°æå‡æ€§èƒ½ç“¶é¢ˆä»¥åŠå¯ç”¨æ€§çš„æ•ˆæœ</strong>ã€‚</p>
<blockquote>
<p>è¯¦ç»†è§£å†³æ–¹æ¡ˆå‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/distributed-storage.md">åˆ†å¸ƒå¼å­˜å‚¨</a></p>
</blockquote>
<h4 id="Nosql"><a href="#Nosql" class="headerlink" title="Nosql"></a>Nosql</h4><p>å…³ç³»å‹æ•°æ®åº“çš„ä¼˜åŠ¿åœ¨äºï¼šå­˜å‚¨ç»“æ„åŒ–æ•°æ®ï¼Œæœ‰åˆ©äºè¿›è¡Œå„ç§å¤æ‚æŸ¥è¯¢ã€‚</p>
<p>ä½†æ˜¯ï¼Œå®ƒä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼š</p>
<ul>
<li>å…³ç³»æ•°æ®åº“å­˜å‚¨çš„æ˜¯è¡Œè®°å½•ï¼Œæ— æ³•å­˜å‚¨æ•°æ®ç»“æ„</li>
<li>å…³ç³»æ•°æ®åº“çš„ schema æ‰©å±•å¾ˆä¸æ–¹ä¾¿</li>
<li>å…³ç³»æ•°æ®åº“åœ¨å¤§æ•°æ®åœºæ™¯ä¸‹ I&#x2F;O è¾ƒé«˜</li>
<li>å…³ç³»æ•°æ®åº“çš„å…¨æ–‡æœç´¢åŠŸèƒ½æ¯”è¾ƒå¼±</li>
</ul>
<p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œåˆ†åˆ«è¯ç”Ÿäº†è§£å†³ä¸åŒé—®é¢˜çš„ Nosql æ•°æ®åº“ã€‚</p>
<p>å¸¸è§çš„ NoSQL æ•°æ®åº“å¯ä»¥åˆ†ä¸ºå››ç±»ï¼š</p>
<ul>
<li><strong>K-V æ•°æ®åº“</strong>ï¼šKV å­˜å‚¨éå¸¸é€‚åˆå­˜å‚¨<strong>ä¸æ¶‰åŠè¿‡å¤šæ•°æ®å…³ç³»ä¸šåŠ¡å…³ç³»çš„æ•°æ®</strong>ï¼ŒåŒæ—¶èƒ½æœ‰æ•ˆå‡å°‘è¯»å†™ç£ç›˜çš„æ¬¡æ•°ï¼Œæ¯” SQL æ•°æ®åº“å­˜å‚¨æ‹¥æœ‰æ›´å¥½çš„è¯»å†™æ€§èƒ½ï¼Œèƒ½å¤Ÿ<strong>è§£å†³å…³ç³»å‹æ•°æ®åº“æ— æ³•å­˜å‚¨æ•°æ®ç»“æ„çš„é—®é¢˜</strong>ã€‚ä»¥ Redis ä¸ºä»£è¡¨ã€‚</li>
<li><strong>åˆ—å¼æ•°æ®åº“</strong>ï¼š<strong>é€‚åˆäºæ‰¹é‡æ•°æ®å¤„ç†å’Œå³æ—¶æŸ¥è¯¢ï¼Œè§£å†³å…³ç³»æ•°æ®åº“å¤§æ•°æ®åœºæ™¯ä¸‹çš„ I&#x2F;O é—®é¢˜</strong>ã€‚ä»¥ HBase ä¸ºä»£è¡¨ã€‚</li>
<li><strong>æ–‡æ¡£æ•°æ®åº“</strong>ï¼šæ–‡æ¡£æ•°æ®åº“ï¼ˆä¹Ÿç§°ä¸ºæ–‡æ¡£å‹æ•°æ®åº“ï¼‰æ˜¯<strong>æ—¨åœ¨å°†åŠç»“æ„åŒ–æ•°æ®å­˜å‚¨ä¸ºæ–‡æ¡£çš„ä¸€ç§æ•°æ®åº“ï¼Œå®ƒå¯ä»¥è§£å†³å…³ç³»å‹æ•°æ®åº“è¡¨ç»“æ„ schema æ‰©å±•ä¸æ–¹ä¾¿çš„é—®é¢˜</strong>ã€‚æ–‡æ¡£æ•°æ®åº“<strong>é€šå¸¸ä»¥ JSON æˆ– XML æ ¼å¼å­˜å‚¨æ•°æ®</strong>ã€‚ä»¥ MongoDB ä¸ºä»£è¡¨ã€‚</li>
<li><strong>å…¨æ–‡æœç´¢å¼•æ“</strong>ï¼š<strong>è§£å†³å…³ç³»å‹æ•°æ®åº“å…¨æ–‡æœç´¢åŠŸèƒ½è¾ƒå¼±çš„é—®é¢˜</strong>ã€‚ä»¥ Elasticsearch ä¸ºä»£è¡¨ã€‚</li>
</ul>
<blockquote>
<p>è¯¦æƒ…å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/db-tutorial/blob/master/docs/nosql/nosql-selection.md">Nosql æŠ€æœ¯é€‰å‹</a></p>
</blockquote>
<h3 id="æ–‡ä»¶å­˜å‚¨"><a href="#æ–‡ä»¶å­˜å‚¨" class="headerlink" title="æ–‡ä»¶å­˜å‚¨"></a>æ–‡ä»¶å­˜å‚¨</h3><h4 id="æœºæ¢°é”®ç›˜å’Œå›ºæ€ç¡¬ç›˜"><a href="#æœºæ¢°é”®ç›˜å’Œå›ºæ€ç¡¬ç›˜" class="headerlink" title="æœºæ¢°é”®ç›˜å’Œå›ºæ€ç¡¬ç›˜"></a>æœºæ¢°é”®ç›˜å’Œå›ºæ€ç¡¬ç›˜</h4><p>è€ƒè™‘ä½¿ç”¨å›ºæ€ç¡¬ç›˜æ›¿ä»£æœºæ¢°é”®ç›˜ï¼Œå› ä¸ºå®ƒçš„è¯»å†™é€Ÿåº¦æ›´å¿«ã€‚</p>
<h4 id="B-æ•°å’Œ-LSM-æ ‘"><a href="#B-æ•°å’Œ-LSM-æ ‘" class="headerlink" title="B+æ•°å’Œ LSM æ ‘"></a>B+æ•°å’Œ LSM æ ‘</h4><p>ä¼ ç»Ÿå…³ç³»æ•°æ®åº“çš„æ•°æ®åº“ç´¢å¼•ä¸€èˆ¬éƒ½ä½¿ç”¨ä¸¤çº§ç´¢å¼•çš„ <strong>B+ æ ‘</strong> ç»“æ„ï¼Œæ ‘çš„å±‚æ¬¡æœ€å¤šä¸‰å±‚ã€‚å› æ­¤å¯èƒ½éœ€è¦ 5 æ¬¡ç£ç›˜è®¿é—®æ‰èƒ½æ›´æ–°ä¸€æ¡è®°å½•ï¼ˆä¸‰æ¬¡ç£ç›˜è®¿é—®è·å¾—æ•°æ®ç´¢å¼•åŠè¡Œ IDï¼Œç„¶åå†è¿›è¡Œä¸€æ¬¡æ•°æ®æ–‡ä»¶è¯»æ“ä½œåŠä¸€æ¬¡æ•°æ®æ–‡ä»¶å†™æ“ä½œï¼‰ã€‚</p>
<p>ç”±äºç£ç›˜è®¿é—®æ˜¯éšæœºçš„ï¼Œä¼ ç»Ÿæœºæ¢°é”®ç›˜åœ¨æ•°æ®éšæœºè®¿é—®æ—¶æ€§èƒ½è¾ƒå·®ï¼Œæ¯æ¬¡æ•°æ®è®¿é—®éƒ½éœ€è¦å¤šæ¬¡è®¿é—®ç£ç›˜å½±å“æ•°æ®è®¿é—®æ€§èƒ½ã€‚</p>
<p>è®¸å¤š Nosql æ•°æ®åº“ä¸­çš„ç´¢å¼•é‡‡ç”¨ <strong>LSM æ ‘</strong> ä½œä¸ºä¸»è¦æ•°æ®ç»“æ„ã€‚LSM æ ‘å¯è§†ä¸ºä¸€ä¸ª N é˜¶åˆå¹¶æ ‘ã€‚æ•°æ®å†™æ“ä½œéƒ½åœ¨å†…å­˜ä¸­è¿›è¡Œã€‚åœ¨ <strong>LSM æ ‘ä¸Šè¿›è¡Œä¸€æ¬¡æ•°æ®æ›´æ–°ä¸éœ€è¦ç£ç›˜è®¿é—®ï¼Œé€Ÿåº¦è¿œå¿«äº B+ æ ‘</strong>ã€‚</p>
<h4 id="RAID-å’Œ-HDFS"><a href="#RAID-å’Œ-HDFS" class="headerlink" title="RAID å’Œ HDFS"></a>RAID å’Œ HDFS</h4><p>RAID æ˜¯ Redundant Array of Independent Disks çš„ç¼©å†™ï¼Œä¸­æ–‡ç®€ç§°ä¸ºç‹¬ç«‹å†—ä½™ç£ç›˜é˜µåˆ—ã€‚</p>
<p>RAID æ˜¯ä¸€ç§æŠŠå¤šå—ç‹¬ç«‹çš„ç¡¬ç›˜ï¼ˆç‰©ç†ç¡¬ç›˜ï¼‰æŒ‰ä¸åŒçš„æ–¹å¼ç»„åˆèµ·æ¥å½¢æˆä¸€ä¸ªç¡¬ç›˜ç»„ï¼ˆé€»è¾‘ç¡¬ç›˜ï¼‰ï¼Œä»è€Œæä¾›æ¯”å•ä¸ªç¡¬ç›˜æ›´é«˜çš„å­˜å‚¨æ€§èƒ½å’Œæä¾›æ•°æ®å¤‡ä»½æŠ€æœ¯ã€‚</p>
<p>HDFS(åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ) æ›´è¢«å¤§å‹ç½‘ç«™æ‰€é’çã€‚å®ƒå¯ä»¥é…åˆ <code>MapReduce</code> å¹¶å‘è®¡ç®—ä»»åŠ¡æ¡†æ¶è¿›è¡Œå¤§æ•°æ®å¤„ç†ï¼Œå¯ä»¥åœ¨æ•´ä¸ªé›†ç¾¤ä¸Šå¹¶å‘è®¿é—®æ‰€æœ‰ç£ç›˜ï¼Œæ— éœ€ RAID æ”¯æŒã€‚</p>
<p>HDFS å¯¹æ•°æ®å­˜å‚¨ç©ºé—´çš„ç®¡ç†ä»¥æ•°æ®å—ï¼ˆBlockï¼‰ä¸ºå•ä½ï¼Œé»˜è®¤ä¸º 64 MBã€‚æ‰€ä»¥ï¼ŒHDFS æ›´é€‚åˆå­˜å‚¨è¾ƒå¤§çš„æ–‡ä»¶ã€‚</p>
<h2 id="å‰ç«¯æ€§èƒ½ä¼˜åŒ–"><a href="#å‰ç«¯æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="å‰ç«¯æ€§èƒ½ä¼˜åŒ–"></a>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</h2><h3 id="æµè§ˆå™¨è®¿é—®ä¼˜åŒ–"><a href="#æµè§ˆå™¨è®¿é—®ä¼˜åŒ–" class="headerlink" title="æµè§ˆå™¨è®¿é—®ä¼˜åŒ–"></a>æµè§ˆå™¨è®¿é—®ä¼˜åŒ–</h3><ol>
<li><strong>å‡å°‘ HTTP è¯·æ±‚</strong> - HTTP è¯·æ±‚éœ€è¦å»ºç«‹é€šä¿¡é“¾è·¯ï¼Œè¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œå¼€é”€é«˜æ˜‚ï¼Œæ‰€ä»¥å‡å°‘ HTTP è¯·æ±‚æ•°å¯ä»¥æœ‰æ•ˆæé«˜è®¿é—®æ€§èƒ½ã€‚å‡å°‘ HTTP çš„ä¸»è¦æ‰‹æ®µæ˜¯åˆå¹¶ Cssã€JavaScriptã€å›¾ç‰‡ã€‚</li>
<li><strong>ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜</strong> - å› ä¸ºé™æ€èµ„æºæ–‡ä»¶æ›´æ–°é¢‘ç‡ä½ï¼Œå¯ä»¥ç¼“å­˜æµè§ˆå™¨ä¸­ä»¥æé«˜æ€§èƒ½ã€‚è®¾ç½® HTTP å¤´ä¸­çš„ <code>Cache-Control</code> å’Œ <code>Expires</code> å±æ€§ï¼Œå¯è®¾å®šæµè§ˆå™¨ç¼“å­˜ã€‚</li>
<li><strong>å¯ç”¨å‹ç¼©</strong> - åœ¨æœåŠ¡å™¨ç«¯å‹ç¼©é™æ€èµ„æºæ–‡ä»¶ï¼Œåœ¨æµè§ˆå™¨ç«¯è§£å‹ç¼©ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ä¼ è¾“çš„æ•°æ®é‡ã€‚ç”±äºæ–‡æœ¬æ–‡ä»¶å‹ç¼©ç‡å¯è¾¾ 80% ä»¥ä¸Šï¼Œæ‰€ä»¥å¯ä»¥å¯¹é™æ€èµ„æºï¼Œå¦‚ Htmlã€Cssã€JavaScrip è¿›è¡Œå‹ç¼©ã€‚</li>
<li><strong>CSS æ”¾åœ¨é¡µé¢æœ€ä¸Šé¢ï¼ŒJavaScript æ”¾åœ¨é¡µé¢æœ€ä¸‹é¢</strong> - æµè§ˆå™¨ä¼šåœ¨ä¸‹è½½å®Œå…¨éƒ¨çš„ Css åæ‰å¯¹æ•´ä¸ªé¡µé¢è¿›è¡Œæ¸²æŸ“ï¼Œæ‰€ä»¥æœ€å¥½çš„åšæ³•æ˜¯å°† Css æ”¾åœ¨é¡µé¢æœ€ä¸Šé¢ï¼Œè®©æµè§ˆå™¨å°½å¿«ä¸‹è½½ Cssï¼›JavaScript åˆ™ç›¸åï¼Œæµè§ˆå™¨åŠ è½½ JavaScript åç«‹å³æ‰§è¡Œï¼Œå¯èƒ½ä¼šé˜»å¡æ•´ä¸ªé¡µé¢ï¼Œé€ æˆé¡µé¢æ˜¾ç¤ºç¼“æ…¢ï¼Œå› æ­¤ JavaScript æœ€å¥½æ”¾åœ¨é¡µé¢æœ€ä¸‹é¢ã€‚</li>
<li><strong>å‡å°‘ Cookie ä¼ è¾“</strong> - Cookie åŒ…å«åœ¨ HTTP æ¯æ¬¡çš„è¯·æ±‚å’Œå“åº”ä¸­ï¼Œå¤ªå¤§çš„ Cookie ä¼šä¸¥é‡å½±å“æ•°æ®ä¼ è¾“ã€‚</li>
</ol>
<h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><p>CDN ä¸€èˆ¬ç¼“å­˜çš„æ˜¯é™æ€èµ„æºã€‚</p>
<p>CDN çš„æœ¬è´¨ä»ç„¶æ˜¯ä¸€ä¸ªç¼“å­˜ï¼Œè€Œä¸”å°†æ•°æ®ç¼“å­˜åœ¨ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°æ–¹ï¼Œä½¿ç”¨æˆ·å·²æœ€å¿«é€Ÿåº¦è·å–æ•°æ®ï¼Œå³æ‰€è°“ç½‘ç»œè®¿é—®ç¬¬ä¸€è·³ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/cdn.png" width="640" />
</div>

<h3 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h3><p>ä¼ ç»Ÿä»£ç†æœåŠ¡å™¨ä½äºæµè§ˆå™¨ä¸€ä¾§ï¼Œä»£ç†æµè§ˆå™¨å°† HTTP è¯·æ±‚å‘é€åˆ°äº’è”ç½‘ä¸Šï¼Œè€Œåå‘ä»£ç†æœåŠ¡å™¨ä½äºç½‘ç«™æœºæˆ¿ä¸€ä¾§ï¼Œä»£ç†ç½‘ç«™æœåŠ¡å™¨æ¥æ”¶ HTTP è¯·æ±‚ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/reverse-proxy.jpg" width="640" />
</div>

<p>åå‘ä»£ç†æœåŠ¡å™¨å¯ä»¥é…ç½®ç¼“å­˜åŠŸèƒ½åŠ é€Ÿ Web è¯·æ±‚ï¼Œå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®é™æ€å†…å®¹æ—¶ï¼Œé™æ€å†…å®¹å°±ä¼šè¢«ç¼“å­˜åœ¨åå‘ä»£ç†æœåŠ¡å™¨ä¸Šã€‚</p>
<p>åå‘ä»£ç†è¿˜å¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æ„å»ºçš„é›†ç¾¤å¯ä»¥æé«˜ç³»ç»Ÿæ€»ä½“å¤„ç†èƒ½åŠ›ã€‚</p>
<p>å› ä¸ºæ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»å…ˆç»è¿‡åå‘ä»£ç†æœåŠ¡å™¨ï¼Œæ‰€ä»¥å¯ä»¥å±è”½ä¸€äº›æ”»å‡» IPï¼Œè¾¾åˆ°ä¿æŠ¤ç½‘ç«™å®‰å…¨çš„ä½œç”¨ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/11322972.html">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://time.geekbang.org/column/intro/100028001">Java æ€§èƒ½è°ƒä¼˜å®æˆ˜</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/9a462f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/9a462f/" class="post-title-link" itemprop="url">ç³»ç»Ÿé«˜å¯ç”¨æ¶æ„</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-05 15:11:00" itemprop="dateCreated datePublished" datetime="2018-07-05T15:11:00+08:00">2018-07-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">è®¾è®¡</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">æ¶æ„</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>6.9k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>6 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ç³»ç»Ÿé«˜å¯ç”¨æ¶æ„"><a href="#ç³»ç»Ÿé«˜å¯ç”¨æ¶æ„" class="headerlink" title="ç³»ç»Ÿé«˜å¯ç”¨æ¶æ„"></a>ç³»ç»Ÿé«˜å¯ç”¨æ¶æ„</h1><h2 id="é«˜å¯ç”¨æ¶æ„ç®€ä»‹"><a href="#é«˜å¯ç”¨æ¶æ„ç®€ä»‹" class="headerlink" title="é«˜å¯ç”¨æ¶æ„ç®€ä»‹"></a>é«˜å¯ç”¨æ¶æ„ç®€ä»‹</h2><h3 id="ç³»ç»Ÿå¯ç”¨æ€§çš„åº¦é‡"><a href="#ç³»ç»Ÿå¯ç”¨æ€§çš„åº¦é‡" class="headerlink" title="ç³»ç»Ÿå¯ç”¨æ€§çš„åº¦é‡"></a>ç³»ç»Ÿå¯ç”¨æ€§çš„åº¦é‡</h3><p>ç³»ç»Ÿä¸å¯ç”¨ä¹Ÿè¢«ç§°ä½œç³»ç»Ÿæ•…éšœï¼Œ<strong>ä¸šç•Œé€šå¸¸ç”¨å¤šä¸ª 9 æ¥è¡¡é‡ç³»ç»Ÿçš„å¯ç”¨æ€§</strong>ã€‚å¦‚ QQ çš„å¯ç”¨æ€§ä¸º 4 ä¸ª 9ï¼Œå³ 99.99% å¯ç”¨ã€‚</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç½‘ç«™ä¸å¯ç”¨æ—¶é—´ <span class="operator">=</span> æ•…éšœä¿®å¤æ—¶é—´ç‚¹ - æ•…éšœå‘ç°æ—¶é—´ç‚¹</span><br><span class="line">ç½‘ç«™å¹´åº¦å¯ç”¨æ€§æŒ‡æ ‡ <span class="operator">=</span> (<span class="number">1</span> - ç½‘ç«™ä¸å¯ç”¨æ—¶é—´/å¹´åº¦æ€»æ—¶é—´) * <span class="number">100</span>%</span><br></pre></td></tr></table></figure>

<p>å¯ç”¨æ€§è®¡é‡è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th align="center">å¯ç”¨æ€§çº§åˆ«</th>
<th align="center">ç³»ç»Ÿå¯ç”¨æ€§%</th>
<th align="center">å®•æœºæ—¶é—´&#x2F;å¹´</th>
<th align="center">å®•æœºæ—¶é—´&#x2F;æœˆ</th>
<th align="center">å®•æœºæ—¶é—´&#x2F;å‘¨</th>
<th align="center">å®•æœºæ—¶é—´&#x2F;å¤©</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ä¸å¯ç”¨</td>
<td align="center">90%</td>
<td align="center">36.5 å¤©</td>
<td align="center">73 å°æ—¶</td>
<td align="center">16.8 å°æ—¶</td>
<td align="center">144 åˆ†é’Ÿ</td>
</tr>
<tr>
<td align="center">åŸºæœ¬å¯ç”¨</td>
<td align="center">99%</td>
<td align="center">87.6 å°æ—¶</td>
<td align="center">7.3 å°æ—¶</td>
<td align="center">1.68 å°æ—¶</td>
<td align="center">14.4 åˆ†é’Ÿ</td>
</tr>
<tr>
<td align="center">è¾ƒé«˜å¯ç”¨</td>
<td align="center">99.9%</td>
<td align="center">8.76 å°æ—¶</td>
<td align="center">43.8 åˆ†é’Ÿ</td>
<td align="center">10.1 åˆ†é’Ÿ</td>
<td align="center">1.44 åˆ†é’Ÿ</td>
</tr>
<tr>
<td align="center">é«˜å¯ç”¨</td>
<td align="center">99.99%</td>
<td align="center">52.56 åˆ†é’Ÿ</td>
<td align="center">4.38 åˆ†é’Ÿ</td>
<td align="center">1.01 ç§’</td>
<td align="center">8.64 ç§’</td>
</tr>
<tr>
<td align="center">æé«˜å¯ç”¨</td>
<td align="center">99.999%</td>
<td align="center">5.26 åˆ†é’Ÿ</td>
<td align="center">26.28 ç§’</td>
<td align="center">6.06 ç§’</td>
<td align="center">0.86 ç§’</td>
</tr>
</tbody></table>
<h3 id="æ•…éšœåŸå› "><a href="#æ•…éšœåŸå› " class="headerlink" title="æ•…éšœåŸå› "></a>æ•…éšœåŸå› </h3><p>ç³»ç»Ÿå®•æœºåŸå› ä¸»è¦æœ‰ä»¥ä¸‹ï¼š</p>
<p><strong>æ— è®¡åˆ’çš„</strong></p>
<ul>
<li>ç³»ç»Ÿçº§æ•…éšœï¼ŒåŒ…æ‹¬ä¸»æœºã€æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€æ•°æ®åº“ã€ç½‘ç»œã€ç”µæºä»¥åŠå¤–å›´è®¾å¤‡ã€‚</li>
<li>æ•°æ®å’Œä¸­ä»‹çš„æ•…éšœï¼ŒåŒ…æ‹¬äººå‘˜è¯¯æ“ä½œã€ç¡¬ç›˜æ•…éšœã€æ•°æ®ä¹±äº†ã€‚</li>
<li>è¿˜æœ‰è‡ªç„¶ç¾å®³ã€äººä¸ºç ´åï¼Œä»¥åŠä¾›ç”µé—®é¢˜ç­‰ã€‚</li>
</ul>
<p><strong>æœ‰è®¡åˆ’çš„</strong></p>
<ul>
<li>æ—¥å¸¸ä»»åŠ¡ï¼šå¤‡ä»½ï¼Œå®¹é‡è§„åˆ’ï¼Œç”¨æˆ·å’Œå®‰å…¨ç®¡ç†ï¼Œåå°æ‰¹å¤„ç†åº”ç”¨ã€‚</li>
<li>è¿ç»´ç›¸å…³ï¼šæ•°æ®åº“ç»´æŠ¤ã€åº”ç”¨ç»´æŠ¤ã€ä¸­é—´ä»¶ç»´æŠ¤ã€æ“ä½œç³»ç»Ÿç»´æŠ¤ã€ç½‘ç»œç»´æŠ¤ã€‚</li>
<li>å‡çº§ç›¸å…³ï¼šæ•°æ®åº“ã€åº”ç”¨ã€ä¸­é—´ä»¶ã€æ“ä½œç³»ç»Ÿã€ç½‘ç»œï¼ŒåŒ…æ‹¬ç¡¬ä»¶å‡çº§ã€‚</li>
</ul>
<p>æˆ‘ä»¬å†ç»™å®ƒä»¬å½’ä¸ªç±»ã€‚</p>
<ol>
<li><strong>ç½‘ç»œé—®é¢˜</strong>ã€‚ç½‘ç»œé“¾æ¥å‡ºç°é—®é¢˜ï¼Œç½‘ç»œå¸¦å®½å‡ºç°æ‹¥å¡â€¦â€¦</li>
<li><strong>æ€§èƒ½é—®é¢˜</strong>ã€‚æ•°æ®åº“æ…¢ SQLã€Java Full GCã€ç¡¬ç›˜ IO è¿‡å¤§ã€CPU é£™é«˜ã€å†…å­˜ä¸è¶³â€¦â€¦</li>
<li><strong>å®‰å…¨é—®é¢˜</strong>ã€‚è¢«ç½‘ç»œæ”»å‡»ï¼Œå¦‚ DDoS ç­‰ã€‚</li>
<li><strong>è¿ç»´é—®é¢˜</strong>ã€‚ç³»ç»Ÿæ€»æ˜¯åœ¨è¢«æ›´æ–°å’Œä¿®æ”¹ï¼Œæ¶æ„ä¹Ÿåœ¨ä¸æ–­åœ°è¢«è°ƒæ•´ï¼Œç›‘æ§é—®é¢˜â€¦â€¦</li>
<li><strong>ç®¡ç†é—®é¢˜</strong>ã€‚æ²¡æœ‰æ¢³ç†å‡ºå…³é”®æœåŠ¡ä»¥åŠæœåŠ¡çš„ä¾èµ–å…³ç³»ï¼Œè¿è¡Œä¿¡æ¯æ²¡æœ‰å’Œæ§åˆ¶ç³»ç»ŸåŒæ­¥â€¦â€¦</li>
<li><strong>ç¡¬ä»¶é—®é¢˜</strong>ã€‚ç¡¬ç›˜æŸåã€ç½‘å¡å‡ºé—®é¢˜ã€äº¤æ¢æœºå‡ºé—®é¢˜ã€æœºæˆ¿æ‰ç”µã€æŒ–æ˜æœºé—®é¢˜â€¦â€¦</li>
</ol>
<h3 id="ä»€ä¹ˆæ˜¯é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„"><a href="#ä»€ä¹ˆæ˜¯é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„" class="headerlink" title="ä»€ä¹ˆæ˜¯é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„"></a>ä»€ä¹ˆæ˜¯é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„</h3><p>é€šå¸¸ï¼Œä¼ä¸šçº§åº”ç”¨ç³»ç»Ÿä¸ºæé«˜ç³»ç»Ÿå¯ç”¨æ€§ï¼Œä¼šé‡‡ç”¨è¾ƒæ˜‚è´µçš„è½¯ç¡¬ä»¶è®¾å¤‡ï¼Œå½“ç„¶è¿™æ ·çš„è®¾å¤‡ä¹Ÿæ¯”è¾ƒç¨³å®šã€‚</p>
<p>äº’è”ç½‘å…¬å¸æˆ–ä¸€äº›åˆåˆ›å‹å…¬å¸åŸºäºæˆæœ¬è€ƒè™‘ï¼Œæ›´å¤šé‡‡ç”¨ PC çº§è½¯ç¡¬ä»¶è®¾å¤‡ï¼ŒèŠ‚çº¦æˆæœ¬æ‰€ä»˜å‡ºçš„ä»£ä»·å°±æ˜¯è®¾å¤‡è¾ƒä¸ºä¸ç¨³å®šã€‚æœåŠ¡å™¨ä¸€å¹´ä¸­å‡ºç°å‡ æ¬¡å®•æœºï¼Œé«˜å¼ºåº¦è¯»å†™ç£ç›˜å¯¼è‡´ç£ç›˜æŸåç­‰äº‹ä»¶å®å±æ­£å¸¸ã€‚</p>
<p>ç»¼ä¸Šï¼Œç¡¬ä»¶å‡ºç°æ•…éšœåº”è§†ä¸ºå¿…ç„¶çš„ï¼Œè€Œ<strong>é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„è®¾è®¡ç›®æ ‡å°±æ˜¯è¦ä¿è¯å½“å‡ºç°ç¡¬ä»¶æ•…éšœæ—¶ï¼ŒæœåŠ¡ä¾ç„¶å¯ç”¨ï¼Œæ•°æ®ä¾ç„¶èƒ½å¤Ÿä¿å­˜å¹¶è¢«è®¿é—®</strong>ã€‚<strong>å®ç°é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„çš„ä¸»è¦æ‰‹æ®µæ˜¯æ•°æ®å’ŒæœåŠ¡çš„å†—ä½™å¤‡ä»½åŠå¤±æ•ˆè½¬ç§»</strong>ï¼Œä¸€æ—¦æŸäº›æœåŠ¡å™¨å®•æœºï¼Œå°±å°†æœåŠ¡åˆ‡æ¢åˆ°å…¶ä»–å¯ç”¨çš„æœåŠ¡å™¨ä¸Šï¼›å¦‚æœç£ç›˜æŸåï¼Œåˆ™ä»å¤‡ä»½çš„ç£ç›˜è¯»å–æ•°æ®ã€‚</p>
<p><strong>å¤§å‹ç³»ç»Ÿçš„åˆ†å±‚æ¶æ„åŠç‰©ç†æœåŠ¡å™¨çš„åˆ†å¸ƒå¼éƒ¨ç½²ä½¿å¾—ä½äºä¸åŒå±‚æ¬¡çš„æœåŠ¡å™¨å…·æœ‰ä¸åŒçš„å¯ç”¨æ€§ç‰¹ç‚¹ã€‚å…³é—­æœåŠ¡æˆ–æœåŠ¡å™¨å®•æœºæ—¶äº§ç”Ÿçš„å½±å“ä¹Ÿä¸ç›¸åŒï¼Œé«˜å¯ç”¨çš„è§£å†³æ–¹æ¡ˆä¹Ÿå·®å¼‚ç”šå¤§</strong>ã€‚å¤§è‡´å¯ä»¥åˆ†ä¸ºï¼š</p>
<ul>
<li>é«˜å¯ç”¨çš„åº”ç”¨ - ä¸»è¦æ‰‹æ®µæ˜¯ï¼šè´Ÿè½½å‡è¡¡</li>
<li>é«˜å¯ç”¨çš„æœåŠ¡ - ä¸»è¦æ‰‹æ®µæ˜¯ï¼šåˆ†çº§ç®¡ç†ã€è¶…æ—¶é‡è¯•ã€å¼‚æ­¥è°ƒç”¨ã€é™æµã€é™è§£ã€æ–­è·¯ã€å¹‚ç­‰æ€§è®¾è®¡</li>
<li>é«˜å¯ç”¨çš„æ•°æ® - ä¸»è¦æ‰‹æ®µæ˜¯ï¼šæ•°æ®å¤‡ä»½å’Œå¤±æ•ˆè½¬ç§»</li>
</ul>
<h2 id="é«˜å¯ç”¨æ¶æ„ç†è®º"><a href="#é«˜å¯ç”¨æ¶æ„ç†è®º" class="headerlink" title="é«˜å¯ç”¨æ¶æ„ç†è®º"></a>é«˜å¯ç”¨æ¶æ„ç†è®º</h2><p>å­¦ä¹ é«˜å¯ç”¨æ¶æ„ï¼Œé¦–å…ˆéœ€è¦äº†è§£åˆ†å¸ƒå¼åŸºç¡€ç†è®ºï¼šCAP å’Œ BASEã€‚</p>
<p>ç„¶åï¼Œå¾ˆå¤šè‘—åçš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œéƒ½åˆ©ç”¨é€‰ä¸¾æœºåˆ¶ï¼Œæ¥ä¿è¯ä¸»èŠ‚ç‚¹å®•æœºæ—¶çš„æ•…éšœæ¢å¤ã€‚å¦‚æœè¦æ·±å…¥ç†è§£é€‰ä¸¾æœºåˆ¶ï¼Œæœ‰å¿…è¦äº†è§£ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/paxos.md">Paxos ç®—æ³•</a> å’Œ <a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/raft.md">Raft ç®—æ³•</a>ã€‚Paxos å’Œ Raft æ˜¯ä¸ºäº†å®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é«˜å¯ç”¨æ¶æ„è€Œæå‡ºçš„å…±è¯†æ€§ç®—æ³•ï¼Œå·²ç»æˆä¸ºä¸šç•Œæ ‡å‡†ã€‚</p>
<p>CAP å®šç†åˆç§°ä¸º CAP åŸåˆ™ï¼ŒæŒ‡çš„æ˜¯ï¼š<strong>åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ <code>ä¸€è‡´æ€§ï¼ˆCï¼šConsistencyï¼‰</code>ã€<code>å¯ç”¨æ€§ï¼ˆAï¼šAvailabilityï¼‰</code> å’Œ <code>åˆ†åŒºå®¹å¿æ€§ï¼ˆPï¼šPartition Toleranceï¼‰</code>ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­ä¸¤é¡¹</strong>ã€‚</p>
<p>BASE æ˜¯ <strong><code>åŸºæœ¬å¯ç”¨ï¼ˆBasically Availableï¼‰</code><strong>ã€</strong><code>è½¯çŠ¶æ€ï¼ˆSoft Stateï¼‰</code></strong> å’Œ <strong><code>æœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventually Consistentï¼‰</code></strong> ä¸‰ä¸ªçŸ­è¯­çš„ç¼©å†™ã€‚BASE ç†è®ºæ˜¯å¯¹ CAP ä¸­ä¸€è‡´æ€§å’Œå¯ç”¨æ€§æƒè¡¡çš„ç»“æœï¼Œå®ƒçš„ç†è®ºçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå³ä½¿æ— æ³•åšåˆ°å¼ºä¸€è‡´æ€§ï¼Œä½†æ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹ç‚¹ï¼Œé‡‡ç”¨é€‚å½“çš„æ–¹å¼æ¥ä½¿ç³»ç»Ÿè¾¾åˆ°æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<blockquote>
<p>CAP å’Œ BASE ç†è®ºçš„è¯¦ç»†è¯´æ˜è¯·å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/distributed-base-theory.md">åˆ†å¸ƒå¼ç†è®º</a></p>
<p>Paxos å’Œ Raft çš„è¯¦ç»†è¯´æ˜è¯·å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/paxos.md">Paxos ç®—æ³•</a> å’Œ <a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/raft.md">Raft ç®—æ³•</a></p>
</blockquote>
<h2 id="æ¶æ„æ¨¡å¼"><a href="#æ¶æ„æ¨¡å¼" class="headerlink" title="æ¶æ„æ¨¡å¼"></a>æ¶æ„æ¨¡å¼</h2><h3 id="ä¸»å¤‡å¤åˆ¶"><a href="#ä¸»å¤‡å¤åˆ¶" class="headerlink" title="ä¸»å¤‡å¤åˆ¶"></a>ä¸»å¤‡å¤åˆ¶</h3><p>ä¸»å¤‡å¤åˆ¶æ˜¯æœ€å¸¸è§ä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€ç§å­˜å‚¨é«˜å¯ç”¨æ–¹æ¡ˆï¼Œå‡ ä¹æ‰€æœ‰çš„å­˜å‚¨ç³»ç»Ÿéƒ½æä¾›äº†ä¸»å¤‡å¤åˆ¶çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ MySQLã€Redisã€MongoDB ç­‰ã€‚</p>
<p>ä¸»å¤‡å¤åˆ¶è¦ç‚¹ï¼š</p>
<ul>
<li>å­˜åœ¨<strong>ä¸€ä¸»å¤šå¤‡</strong>ã€‚</li>
<li>ä¸»æœºè´Ÿè´£è¯»&amp;å†™ï¼Œå¹¶å®šæœŸå¤åˆ¶æ•°æ®ç»™å¤‡æœºã€‚</li>
<li>ä¸€æ—¦ä¸»æœºå®•æœºï¼Œå¯ä»¥é€šè¿‡äººå·¥æ‰‹æ®µï¼Œå°†å…¶ä¸­ä¸€ä¸ªå¤‡èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200614173351.png" alt="img"></p>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>ä¸»å¤‡å¤åˆ¶æ¶æ„ä¸­ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸æ„ŸçŸ¥å¤‡æœºçš„å­˜åœ¨ã€‚å³ä½¿ç¾éš¾æ¢å¤åï¼ŒåŸæ¥çš„å¤‡æœºè¢«äººå·¥ä¿®æ”¹ä¸ºä¸»æœºåï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œåªæ˜¯è®¤ä¸ºä¸»æœºçš„åœ°å€æ¢äº†è€Œå·²ï¼Œæ— é¡»çŸ¥é“æ˜¯åŸæ¥çš„å¤‡æœºå‡çº§ä¸ºä¸»æœºã€‚</li>
<li>ä¸»å¤‡å¤åˆ¶æ¶æ„ä¸­ï¼Œä¸»æœºå’Œå¤‡æœºä¹‹é—´ï¼Œåªéœ€è¦è¿›è¡Œæ•°æ®å¤åˆ¶å³å¯ï¼Œæ— é¡»è¿›è¡ŒçŠ¶æ€åˆ¤æ–­å’Œä¸»å¤‡åˆ‡æ¢è¿™ç±»å¤æ‚çš„æ“ä½œã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>ä¸»å¤‡å¤åˆ¶æ¶æ„ä¸­ï¼Œæ•…éšœåéœ€è¦äººå·¥å¹²é¢„ï¼Œæ— æ³•è‡ªåŠ¨æ¢å¤ã€‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<p>ç»¼åˆä¸»å¤‡å¤åˆ¶æ¶æ„çš„ä¼˜ç¼ºç‚¹ï¼Œå†…éƒ¨çš„åå°ç®¡ç†ç³»ç»Ÿä½¿ç”¨ä¸»å¤‡å¤åˆ¶æ¶æ„çš„æƒ…å†µä¼šæ¯”è¾ƒå¤šï¼Œä¾‹å¦‚å­¦ç”Ÿç®¡ç†ç³»ç»Ÿã€å‘˜å·¥ç®¡ç†ç³»ç»Ÿã€å‡æœŸç®¡ç†ç³»ç»Ÿç­‰ï¼Œå› ä¸ºè¿™ç±»ç³»ç»Ÿçš„æ•°æ®å˜æ›´é¢‘ç‡ä½ï¼Œå³ä½¿åœ¨æŸäº›åœºæ™¯ä¸‹ä¸¢å¤±æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡äººå·¥çš„æ–¹å¼è¡¥å…¨ã€‚</p>
<h3 id="ä¸»ä»å¤åˆ¶"><a href="#ä¸»ä»å¤åˆ¶" class="headerlink" title="ä¸»ä»å¤åˆ¶"></a>ä¸»ä»å¤åˆ¶</h3><p>ä¸»ä»å¤åˆ¶å’Œä¸»å¤‡å¤åˆ¶åªæœ‰ä¸€å­—ä¹‹å·®ï¼ŒåŒºåˆ«åœ¨äºï¼š<strong>ä¸»ä»å¤åˆ¶æ¨¡å¼ä¸­ï¼Œä»æœºè¦æ‰¿æ‹…è¯»æ“ä½œ</strong>ã€‚</p>
<p>ä¸»ä»å¤åˆ¶è¦ç‚¹ï¼š</p>
<ul>
<li>å­˜åœ¨<strong>ä¸€ä¸»å¤šä»</strong>ã€‚</li>
<li>ä¸»æœºè´Ÿè´£è¯»&amp;å†™ï¼Œå¹¶å®šæœŸå¤åˆ¶æ•°æ®ç»™ä»æœºã€‚</li>
<li>ä»æœºåªè´Ÿè´£è¯»ã€‚</li>
<li>ä¸€æ—¦ä¸»æœºå®•æœºï¼Œå¯ä»¥é€šè¿‡äººå·¥æ‰‹æ®µï¼Œå°†å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200614173527.png" alt="img"></p>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>ä¸»ä»å¤åˆ¶æ¶æ„ä¸­ï¼Œä¸»æœºæ•…éšœæ—¶ï¼Œè¯»æ“ä½œç›¸å…³çš„ä¸šåŠ¡å¯ä»¥ç»§ç»­è¿è¡Œã€‚</li>
<li>ä¸»ä»å¤åˆ¶æ¶æ„ä¸­ï¼Œä»æœºæä¾›è¯»æ“ä½œï¼Œå‘æŒ¥äº†ç¡¬ä»¶çš„æ€§èƒ½ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>ä¸»ä»å¤åˆ¶æ¶æ„ä¸­ï¼Œå®¢æˆ·ç«¯éœ€è¦æ„ŸçŸ¥ä¸»ä»å…³ç³»ï¼Œå¹¶å°†ä¸åŒçš„æ“ä½œå‘ç»™ä¸åŒçš„æœºå™¨è¿›è¡Œå¤„ç†ï¼Œå¤æ‚åº¦æ¯”ä¸»å¤‡å¤åˆ¶è¦é«˜ã€‚</li>
<li>ä¸»ä»å¤åˆ¶æ¶æ„ä¸­ï¼Œä»æœºæä¾›è¯»ä¸šåŠ¡ï¼Œå¦‚æœä¸»ä»å¤åˆ¶å»¶è¿Ÿæ¯”è¾ƒå¤§ï¼Œä¸šåŠ¡ä¼šå› ä¸ºæ•°æ®ä¸ä¸€è‡´å‡ºç°é—®é¢˜ã€‚</li>
<li>ä¸»ä»å¤åˆ¶æ¶æ„ä¸­ï¼Œæ•…éšœæ—¶éœ€è¦äººå·¥å¹²é¢„ã€‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<p>ç»¼åˆä¸»ä»å¤åˆ¶çš„ä¼˜ç¼ºç‚¹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå†™å°‘è¯»å¤šçš„ä¸šåŠ¡ä½¿ç”¨ä¸»ä»å¤åˆ¶çš„å­˜å‚¨æ¶æ„æ¯”è¾ƒå¤šã€‚ä¾‹å¦‚ï¼Œè®ºå›ã€BBSã€æ–°é—»ç½‘ç«™è¿™ç±»ä¸šåŠ¡ï¼Œæ­¤ç±»ä¸šåŠ¡çš„è¯»æ“ä½œæ•°é‡æ˜¯å†™æ“ä½œæ•°é‡çš„ 10 å€ç”šè‡³ 100 å€ä»¥ä¸Šã€‚</p>
<h3 id="é›†ç¾¤-åˆ†åŒº"><a href="#é›†ç¾¤-åˆ†åŒº" class="headerlink" title="é›†ç¾¤+åˆ†åŒº"></a>é›†ç¾¤+åˆ†åŒº</h3><p>åœ¨ä¸»å¤‡å¤åˆ¶å’Œä¸»ä»å¤åˆ¶æ¨¡å¼ä¸­ï¼Œéƒ½ç”±ä¸€ä¸ªå…±æ€§é—®é¢˜ï¼š</p>
<p>æ¯ä¸ªæœºå™¨ä¸Šå­˜å‚¨çš„éƒ½æ˜¯å…¨é‡æ•°æ®ã€‚ä½†æ˜¯ï¼Œå•æœºçš„æ•°æ®å­˜å‚¨é‡æ€»æ˜¯æœ‰ä¸Šé™çš„ï¼Œå½“æ•°æ®é‡ä¸Šå‡ä¸º TB çº§ç”šè‡³ PB çº§æ•°æ®ï¼Œå•æœºç»ˆç©¶æœ‰æ— æ³•æ”¯æ’‘çš„æ—¶å€™ã€‚è¿™æ—¶ï¼Œå°±éœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼ˆshardingï¼‰ã€‚</p>
<p>åˆ†ç‰‡åçš„èŠ‚ç‚¹å¯ä»¥è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å­é›†ï¼Œé’ˆå¯¹å­é›†ï¼Œä»»ç„¶éœ€è¦ä¿è¯é«˜å¯ç”¨ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200614184921.png" alt="img"></p>
<h2 id="é«˜å¯ç”¨çš„åº”ç”¨"><a href="#é«˜å¯ç”¨çš„åº”ç”¨" class="headerlink" title="é«˜å¯ç”¨çš„åº”ç”¨"></a>é«˜å¯ç”¨çš„åº”ç”¨</h2><p>åº”ç”¨å±‚ä¸»è¦å¤„ç†ç½‘ç«™åº”ç”¨çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¸€ä¸ªæ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯åº”ç”¨çš„ <strong>æ— çŠ¶æ€</strong> æ€§ã€‚</p>
<p>æ‰€è°“çš„ <strong>æ— çŠ¶æ€</strong> çš„åº”ç”¨æ˜¯æŒ‡åº”ç”¨æœåŠ¡å™¨ä¸ä¿å­˜ä¸šåŠ¡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè€Œä»…æ ¹æ®æ¯æ¬¡è¯·æ±‚æäº¤çš„æ•°æ®è¿›è¡Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œå¤šä¸ªæœåŠ¡å®ä¾‹ä¹‹é—´å®Œå…¨å¯¹ç­‰ï¼Œè¯·æ±‚æäº¤åˆ°ä»»æ„æœåŠ¡å™¨ï¼Œå¤„ç†ç»“æœéƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p>
<p>ç”±äºæ— çŠ¶æ€åº”ç”¨ï¼Œå„å®ä¾‹ä¹‹é—´ä¸ç”¨è€ƒè™‘æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œæ‰€ä»¥å…¶é«˜å¯ç”¨æ–¹æ¡ˆç›¸å¯¹ç®€å•ã€‚ä¸»è¦æ‰‹æ®µæ˜¯ï¼š</p>
<ul>
<li>è´Ÿè½½å‡è¡¡</li>
<li>åˆ†å¸ƒå¼ Session</li>
</ul>
<h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><p>è´Ÿè½½å‡è¡¡ï¼Œé¡¾åæ€ä¹‰ï¼Œä¸»è¦ä½¿ç”¨åœ¨ä¸šåŠ¡é‡å’Œæ•°æ®é‡è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œå½“å•å°æœåŠ¡å™¨ä¸è¶³ä»¥æ‰¿æ‹…æ‰€æœ‰çš„è´Ÿè½½å‹åŠ›æ—¶ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æ‰‹æ®µï¼Œå°†æµé‡å’Œæ•°æ®åˆ†æ‘Šåˆ°ä¸€ä¸ªé›†ç¾¤ç»„æˆçš„å¤šå°æœåŠ¡å™¨ä¸Šï¼Œä»¥æé«˜æ•´ä½“çš„è´Ÿè½½å¤„ç†èƒ½åŠ›ã€‚</p>
<p><strong>æ— çŠ¶æ€åº”ç”¨çš„å¤±æ•ˆè½¬ç§»å¯ä»¥åˆ©ç”¨è´Ÿè½½å‡è¡¡æ¥å®ç°</strong>ã€‚</p>
<p>æ— çŠ¶æ€çš„åº”ç”¨å®ç°é«˜å¯ç”¨æ¶æ„ååˆ†ç®€å•ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜è¯·æ±‚çŠ¶æ€ï¼Œé‚£ä¹ˆæ‰€æœ‰æœåŠ¡å™¨å®Œå…¨å¯¹ç­‰ï¼Œåœ¨ä»»æ„èŠ‚ç‚¹æ‰§è¡ŒåŒæ ·çš„è¯·æ±‚ï¼Œç»“æœæ€»æ˜¯ä¸€è‡´çš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€ç®€å•çš„é«˜å¯ç”¨æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨è´Ÿè½½å‡è¡¡ã€‚</p>
<blockquote>
<p>è´Ÿè½½å‡è¡¡åŸç†å¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/load-balance.md">è´Ÿè½½å‡è¡¡åŸºæœ¬åŸç†</a></p>
</blockquote>
<h3 id="åˆ†å¸ƒå¼-Session"><a href="#åˆ†å¸ƒå¼-Session" class="headerlink" title="åˆ†å¸ƒå¼ Session"></a>åˆ†å¸ƒå¼ Session</h3><p>åº”ç”¨æœåŠ¡å™¨çš„é«˜å¯ç”¨æ¶æ„è®¾è®¡ä¸»è¦åŸºäºæœåŠ¡æ— çŠ¶æ€è¿™ä¸€ç‰¹æ€§ã€‚äº‹å®ä¸Šï¼Œä¸šåŠ¡æ€»æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå¦‚è´­ç‰©è½¦è®°å½•ç”¨æˆ·çš„è´­ä¹°ä¿¡æ¯ï¼›ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼›æœ€æ–°å‘å¸ƒçš„æ¶ˆæ¯ç­‰ç­‰ã€‚</p>
<p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªç”¨æˆ·çš„ Session å¦‚æœåªå­˜å‚¨åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆå½“è´Ÿè½½å‡è¡¡å™¨æŠŠç”¨æˆ·çš„ä¸‹ä¸€ä¸ªè¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¯¥æœåŠ¡å™¨æ²¡æœ‰ç”¨æˆ·çš„ Sessionï¼Œå°±å¯èƒ½å¯¼è‡´ç”¨æˆ·éœ€è¦é‡æ–°è¿›è¡Œç™»å½•ç­‰æ“ä½œã€‚</p>
<p>ä¸ºäº†è§£å†³åˆ†å¸ƒå¼ Session é—®é¢˜ï¼Œå¸¸è§çš„è§£å†³æ–¹æ¡ˆæœ‰ï¼š</p>
<ul>
<li>ç²˜æ€§ session</li>
<li>åº”ç”¨æœåŠ¡å™¨é—´çš„ session å¤åˆ¶å…±äº«</li>
<li>åŸºäºç¼“å­˜çš„ session å…±äº« âœ…</li>
</ul>
<blockquote>
<p>åˆ†å¸ƒå¼ä¼šè¯åŸç†å¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/blog/blob/master/source/_posts/theory/distributed-session.md">åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†</a></p>
</blockquote>
<h2 id="é«˜å¯ç”¨çš„æœåŠ¡"><a href="#é«˜å¯ç”¨çš„æœåŠ¡" class="headerlink" title="é«˜å¯ç”¨çš„æœåŠ¡"></a>é«˜å¯ç”¨çš„æœåŠ¡</h2><p><strong>å¯å¤ç”¨çš„æœåŠ¡</strong>ä¸ºä¸šåŠ¡äº§å“æä¾›åŸºç¡€å…¬å…±æœåŠ¡ï¼Œå¤§å‹ç³»ç»Ÿä¸­è¿™äº›æœåŠ¡é€šå¸¸éƒ½ç‹¬ç«‹åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œè¢«å…·ä½“åº”ç”¨è¿œç¨‹è°ƒç”¨ã€‚å¯å¤ç”¨çš„æœåŠ¡å’Œåº”ç”¨ä¸€æ ·ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯æ— çŠ¶æ€çš„æœåŠ¡ï¼Œå› æ­¤ï¼Œ<strong>åŒæ ·å¯ä»¥ä½¿ç”¨è´Ÿè½½å‡è¡¡çš„å¤±æ•ˆè½¬ç§»ç­–ç•¥æ¥å®ç°é«˜å¯ç”¨</strong>ã€‚</p>
<p>é™¤æ­¤ä»¥å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹æ‰‹æ®µæ¥ä¿è¯æœåŠ¡çš„é«˜å¯ç”¨ï¼š</p>
<ul>
<li>åˆ†çº§ç®¡ç†</li>
<li>è¶…æ—¶é‡è¯•</li>
<li>å¼‚æ­¥è°ƒç”¨</li>
<li>è¿‡è½½ä¿æŠ¤<ul>
<li>é™æµ</li>
<li>é™çº§</li>
<li>æ–­è·¯</li>
</ul>
</li>
<li>å¹‚ç­‰æ€§è®¾è®¡</li>
</ul>
<h3 id="åˆ†çº§ç®¡ç†"><a href="#åˆ†çº§ç®¡ç†" class="headerlink" title="åˆ†çº§ç®¡ç†"></a>åˆ†çº§ç®¡ç†</h3><p>å°†æœåŠ¡æ ¹æ®ä¸šåŠ¡é‡è¦æ€§è¿›è¡Œåˆ†çº§ç®¡ç†ï¼Œæ ¸å¿ƒåº”ç”¨å’ŒæœåŠ¡ä¼˜å…ˆä½¿ç”¨æ›´å¥½çš„ç¡¬ä»¶ï¼Œåœ¨è¿ç»´å“åº”é€Ÿåº¦ä¸Šä¹Ÿæ ¼å¤–è¿…é€Ÿã€‚</p>
<p>åœ¨æœåŠ¡éƒ¨ç½²ä¸Šè¿›è¡Œå¿…è¦çš„éš”ç¦»ï¼Œé¿å…æ•…éšœçš„è¿é”ååº”ã€‚ä½ä¼˜å…ˆçº§çš„æœåŠ¡é€šè¿‡å¯åŠ¨ä¸åŒçš„çº¿ç¨‹æˆ–éƒ¨ç½²åœ¨ä¸åŒçš„è™šæ‹Ÿæœºä¸Šè¿›è¡Œéš”ç¦»ï¼Œè€Œé«˜ä¼˜å…ˆçº§çš„æœåŠ¡åˆ™éœ€è¦éƒ¨ç½²åœ¨ä¸åŒçš„ç‰©ç†æœºä¸Šï¼Œæ ¸å¿ƒæœåŠ¡å’Œæ•°æ®ç”šè‡³è¦éƒ¨ç½²åœ¨ä¸åŒåœ°åŸŸçš„æ•°æ®ä¸­å¿ƒã€‚</p>
<h3 id="è¶…æ—¶é‡è¯•"><a href="#è¶…æ—¶é‡è¯•" class="headerlink" title="è¶…æ—¶é‡è¯•"></a>è¶…æ—¶é‡è¯•</h3><p>ç”±äºæœåŠ¡å™¨å®•æœºã€çº¿ç¨‹æ­»é”ç­‰åŸå› ï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºå¯¹æœåŠ¡ç«¯çš„è°ƒç”¨å¤±å»å“åº”ã€‚æ‰€ä»¥æœ‰å¿…è¦å¼•å…¥<strong>è¶…æ—¶æœºåˆ¶</strong>ï¼Œä¸€æ—¦è°ƒç”¨è¶…æ—¶ï¼ŒæœåŠ¡åŒ–æ¡†æ¶æŠ›å‡ºå¼‚å¸¸ï¼Œåº”ç”¨ç¨‹åºæ ¹æ®æœåŠ¡è°ƒåº¦ç­–ç•¥ï¼Œé€‰æ‹©é‡è¯•æˆ–è¯·æ±‚è½¬ç§»åˆ°å…¶ä»–æœºå™¨ä¸Šã€‚</p>
<h3 id="å¼‚æ­¥è°ƒç”¨"><a href="#å¼‚æ­¥è°ƒç”¨" class="headerlink" title="å¼‚æ­¥è°ƒç”¨"></a>å¼‚æ­¥è°ƒç”¨</h3><p>å¯¹äºéœ€è¦å³æ—¶å“åº”çš„ä¸šåŠ¡ï¼Œåº”ç”¨åœ¨è°ƒç”¨æœåŠ¡æ—¶å¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ç­‰å¼‚æ­¥æ–¹å¼å®Œæˆï¼Œé¿å…ä¸€ä¸ªæœåŠ¡å¤±è´¥å¯¼è‡´æ•´ä¸ªåº”ç”¨è¯·æ±‚å¤±è´¥çš„æƒ…å†µã€‚å½“ç„¶ä¸æ˜¯æ‰€æœ‰æœåŠ¡è°ƒç”¨éƒ½å¯ä»¥å¼‚æ­¥è°ƒç”¨ï¼Œå¯¹äºè·å–ç”¨æˆ·ä¿¡æ¯è¿™ç±»è°ƒç”¨ï¼Œé‡‡ç”¨å¼‚æ­¥æ–¹å¼ä¼šå»¶é•¿å“åº”æ—¶é—´ï¼Œå¾—ä¸å¿å¤±ï¼›æ­¤å¤–ï¼Œå¯¹äºé‚£äº›å¿…é¡»ç¡®è®¤æœåŠ¡è°ƒç”¨æ‰èƒ½ç»§ç»­ä¸‹ä¸€æ­¥æ“ä½œçš„åº”ç”¨ä¹Ÿä¸é€‚å®œé£Ÿç”¨å¼‚æ­¥è°ƒç”¨ã€‚</p>
<h3 id="è¿‡è½½ä¿æŠ¤"><a href="#è¿‡è½½ä¿æŠ¤" class="headerlink" title="è¿‡è½½ä¿æŠ¤"></a>è¿‡è½½ä¿æŠ¤</h3><p>è¿‡è½½ä¿æŠ¤çš„æ‰‹æ®µï¼Œä¸€èˆ¬æœ‰ï¼šé™æµã€é™çº§ã€ç†”æ–­ã€‚</p>
<h4 id="é™æµ"><a href="#é™æµ" class="headerlink" title="é™æµ"></a>é™æµ</h4><p>é™çº§æ˜¯ä»ç³»ç»ŸåŠŸèƒ½ä¼˜å…ˆçº§çš„è§’åº¦è€ƒè™‘å¦‚ä½•åº”å¯¹æ•…éšœï¼Œè€Œé™æµåˆ™æ˜¯ä»ç”¨æˆ·è®¿é—®å‹åŠ›çš„è§’åº¦æ¥è€ƒè™‘å¦‚ä½•åº”å¯¹æ•…éšœã€‚é™æµæŒ‡åªå…è®¸ç³»ç»Ÿèƒ½å¤Ÿæ‰¿å—çš„è®¿é—®é‡è¿›æ¥ï¼Œè¶…å‡ºç³»ç»Ÿè®¿é—®èƒ½åŠ›çš„è¯·æ±‚å°†è¢«ä¸¢å¼ƒã€‚</p>
<p>å¸¸è§çš„é™æµæ–¹å¼å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šåŸºäºè¯·æ±‚é™æµå’ŒåŸºäºèµ„æºé™æµã€‚</p>
<h5 id="åŸºäºè¯·æ±‚é™æµ"><a href="#åŸºäºè¯·æ±‚é™æµ" class="headerlink" title="åŸºäºè¯·æ±‚é™æµ"></a>åŸºäºè¯·æ±‚é™æµ</h5><p>åŸºäºè¯·æ±‚é™æµæŒ‡ä»å¤–éƒ¨è®¿é—®çš„è¯·æ±‚è§’åº¦è€ƒè™‘é™æµï¼Œå¸¸è§çš„æ–¹å¼æœ‰ï¼šé™åˆ¶æ€»é‡ã€é™åˆ¶æ—¶é—´é‡ã€‚</p>
<p>é™åˆ¶æ€»é‡çš„æ–¹å¼æ˜¯é™åˆ¶<strong>æŸä¸ªæŒ‡æ ‡çš„ç´¯ç§¯ä¸Šé™</strong>ï¼Œå¸¸è§çš„æ˜¯é™åˆ¶å½“å‰ç³»ç»ŸæœåŠ¡çš„ç”¨æˆ·æ€»é‡ï¼Œä¾‹å¦‚æŸä¸ªç›´æ’­é—´é™åˆ¶æ€»ç”¨æˆ·æ•°ä¸Šé™ä¸º 100 ä¸‡ï¼Œè¶…è¿‡ 100 ä¸‡åæ–°çš„ç”¨æˆ·æ— æ³•è¿›å…¥ï¼›æŸä¸ªæŠ¢è´­æ´»åŠ¨å•†å“æ•°é‡åªæœ‰ 100 ä¸ªï¼Œé™åˆ¶å‚ä¸æŠ¢è´­çš„ç”¨æˆ·ä¸Šé™ä¸º 1 ä¸‡ä¸ªï¼Œ1 ä¸‡ä»¥åçš„ç”¨æˆ·ç›´æ¥æ‹’ç»ã€‚é™åˆ¶æ—¶é—´é‡æŒ‡é™åˆ¶<strong>ä¸€æ®µæ—¶é—´å†…æŸä¸ªæŒ‡æ ‡çš„ä¸Šé™</strong>ï¼Œä¾‹å¦‚ï¼Œ1 åˆ†é’Ÿå†…åªå…è®¸ 10000 ä¸ªç”¨æˆ·è®¿é—®ï¼Œæ¯ç§’è¯·æ±‚å³°å€¼æœ€é«˜ä¸º 10 ä¸‡ã€‚</p>
<p>æ— è®ºæ˜¯é™åˆ¶æ€»é‡è¿˜æ˜¯é™åˆ¶æ—¶é—´é‡ï¼Œå…±åŒçš„ç‰¹ç‚¹éƒ½æ˜¯å®ç°ç®€å•ï¼Œä½†åœ¨å®è·µä¸­é¢ä¸´çš„ä¸»è¦é—®é¢˜æ˜¯æ¯”è¾ƒéš¾ä»¥æ‰¾åˆ°åˆé€‚çš„é˜ˆå€¼ã€‚</p>
<h5 id="åŸºäºèµ„æºé™æµ"><a href="#åŸºäºèµ„æºé™æµ" class="headerlink" title="åŸºäºèµ„æºé™æµ"></a>åŸºäºèµ„æºé™æµ</h5><p>åŸºäºè¯·æ±‚é™æµæ˜¯ä»ç³»ç»Ÿå¤–éƒ¨è€ƒè™‘çš„ï¼Œè€ŒåŸºäºèµ„æºé™æµæ˜¯ä»ç³»ç»Ÿå†…éƒ¨è€ƒè™‘çš„ï¼Œå³ï¼šæ‰¾åˆ°ç³»ç»Ÿå†…éƒ¨å½±å“æ€§èƒ½çš„å…³é”®èµ„æºï¼Œå¯¹å…¶ä½¿ç”¨ä¸Šé™è¿›è¡Œé™åˆ¶ã€‚å¸¸è§çš„å†…éƒ¨èµ„æºæœ‰ï¼šè¿æ¥æ•°ã€æ–‡ä»¶å¥æŸ„ã€çº¿ç¨‹æ•°ã€è¯·æ±‚é˜Ÿåˆ—ç­‰ã€‚</p>
<p>åŸºäºèµ„æºé™æµç›¸æ¯”åŸºäºè¯·æ±‚é™æµèƒ½å¤Ÿæ›´åŠ æœ‰æ•ˆåœ°åæ˜ å½“å‰ç³»ç»Ÿçš„å‹åŠ›ï¼Œä½†å®è·µä¸­è®¾è®¡ä¹Ÿé¢ä¸´ä¸¤ä¸ªä¸»è¦çš„éš¾ç‚¹ï¼šå¦‚ä½•ç¡®å®šå…³é”®èµ„æºï¼Œå¦‚ä½•ç¡®å®šå…³é”®èµ„æºçš„é˜ˆå€¼ã€‚</p>
<h4 id="é™çº§"><a href="#é™çº§" class="headerlink" title="é™çº§"></a>é™çº§</h4><p>é™çº§æŒ‡ç³»ç»Ÿå°†æŸäº›ä¸šåŠ¡æˆ–è€…æ¥å£çš„åŠŸèƒ½é™ä½ï¼Œå¯ä»¥æ˜¯åªæä¾›éƒ¨åˆ†åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥æ˜¯å®Œå…¨åœæ‰æ‰€æœ‰åŠŸèƒ½ã€‚</p>
<p>åœ¨æœåŠ¡è®¿é—®çš„é«˜å³°æœŸï¼ŒæœåŠ¡å¯èƒ½å› ä¸ºå¤§é‡å¹¶å‘è°ƒç”¨è€Œæ€§èƒ½ä¸‹é™ï¼Œä¸¥é‡æ—¶å¯èƒ½ä¼šå¯¼è‡´å®•æœºã€‚ä¸ºäº†ä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„æ­£å¸¸è¿è¡Œï¼Œéœ€è¦å¯¹æœåŠ¡è¿›è¡Œé™çº§ã€‚é™çº§æœ‰ä¸¤ç§æ‰‹æ®µï¼š</p>
<p><strong>æ‹’ç»æœåŠ¡</strong> - æ‹’ç»ä½ä¼˜å…ˆçº§åº”ç”¨çš„è°ƒç”¨ï¼Œå‡å°‘æœåŠ¡è°ƒç”¨å¹¶å‘æ•°ï¼Œç¡®ä¿æ ¸å¿ƒåº”ç”¨æ­£å¸¸ä½¿ç”¨ã€‚æˆ–è€…éšæœºæ‹’ç»éƒ¨åˆ†è°ƒç”¨ï¼ŒèŠ‚çº¦èµ„æºï¼Œé¿å…è¦æ­»å¤§å®¶ä¸€èµ·æ­»çš„æƒ¨å‰§ã€‚</p>
<p><strong>å…³é—­æœåŠ¡</strong> - å…³é—­éƒ¨åˆ†ä¸é‡è¦çš„æœåŠ¡ï¼Œæˆ–è€…æœåŠ¡å†…éƒ¨å…³é—­éƒ¨åˆ†ä¸é‡è¦çš„åŠŸèƒ½ï¼Œä»¥èŠ‚çº¦èµ„æºã€‚</p>
<h4 id="ç†”æ–­"><a href="#ç†”æ–­" class="headerlink" title="ç†”æ–­"></a>ç†”æ–­</h4><p>ç†”æ–­å’Œé™çº§æ˜¯ä¸¤ä¸ªæ¯”è¾ƒå®¹æ˜“æ··æ·†çš„æ¦‚å¿µï¼Œå› ä¸ºå•çº¯ä»åå­—ä¸Šçœ‹å¥½åƒéƒ½æœ‰ç¦æ­¢æŸä¸ªåŠŸèƒ½çš„æ„æ€ï¼Œä½†å…¶å®å†…åœ¨å«ä¹‰æ˜¯ä¸åŒçš„ï¼ŒåŸå› åœ¨äºé™çº§çš„ç›®çš„æ˜¯åº”å¯¹ç³»ç»Ÿè‡ªèº«çš„æ•…éšœï¼Œè€Œç†”æ–­çš„ç›®çš„æ˜¯åº”å¯¹ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿæ•…éšœçš„æƒ…å†µã€‚</p>
<p>ç†”æ–­æœºåˆ¶å®ç°çš„å…³é”®æ˜¯éœ€è¦æœ‰ä¸€ä¸ªç»Ÿä¸€çš„ API è°ƒç”¨å±‚ï¼Œç”± API è°ƒç”¨å±‚æ¥è¿›è¡Œé‡‡æ ·æˆ–è€…ç»Ÿè®¡ï¼Œå¦‚æœæ¥å£è°ƒç”¨æ•£è½åœ¨ä»£ç å„å¤„å°±æ²¡æ³•è¿›è¡Œç»Ÿä¸€å¤„ç†äº†ã€‚</p>
<h3 id="å¹‚ç­‰æ€§è®¾è®¡"><a href="#å¹‚ç­‰æ€§è®¾è®¡" class="headerlink" title="å¹‚ç­‰æ€§è®¾è®¡"></a>å¹‚ç­‰æ€§è®¾è®¡</h3><p>æœåŠ¡è°ƒç”¨å¤±è´¥åï¼Œè°ƒç”¨æ–¹ä¼šå°†è¯·æ±‚è½¬å‘åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šï¼Œä½†æ˜¯è¿™ä¸ªå¤±è´¥å¯èƒ½æ˜¯è™šå‡çš„å¤±è´¥ã€‚æ¯”å¦‚æœåŠ¡å·²ç»å¤„ç†æˆåŠŸï¼Œä½†å› ä¸ºç½‘ç»œæ•…éšœå¯¼è‡´è°ƒç”¨æ–¹æ²¡æœ‰æ”¶åˆ°åº”ç­”ï¼Œæˆ–ç­‰å¾…è¶…æ—¶ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œé‡æ–°å‘èµ·è¯·æ±‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´é‡å¤æ“ä½œï¼Œå¦‚ï¼šå‘æ•°æ®åº“å†™å…¥ä¸¤æ¡è®°å½•ã€‚å¦‚æœè¿™ä¸ªæ“ä½œæ˜¯æ¯”è¾ƒæ•æ„Ÿçš„äº¤æ˜“æ“ä½œï¼Œå°±ä¼šäº§ç”Ÿä¸¥é‡åæœã€‚</p>
<p>æœåŠ¡é‡å¤è°ƒç”¨æ—¶æ— æ³•é¿å…çš„ï¼Œä½†æ˜¯åªè¦èƒ½ä»ä¸šåŠ¡å®ç°ä¸Šä¿è¯ï¼Œé‡å¤è°ƒç”¨å’Œä¸€æ¬¡è°ƒç”¨çš„å¤„ç†ç»“æœä¸€è‡´ï¼Œåˆ™ä¸šåŠ¡å°±æ²¡æœ‰é—®é¢˜ï¼Œè¿™å°±æ˜¯å¹‚ç­‰æ€§è®¾è®¡ã€‚</p>
<p>æœ‰äº›æœåŠ¡çš„ä¸šåŠ¡å¤©ç„¶å…·æœ‰å¹‚ç­‰æ€§ï¼Œæ¯”å¦‚å°†ç”¨æˆ·æ€§åˆ«è®¾ä¸ºç”·æ€§ï¼Œä¸ç®¡æ‰§è¡Œå¤šå°‘æ¬¡ï¼Œç»“æœæ˜¯ä¸€è‡´çš„ã€‚ä½†æœ‰äº›å¤æ‚çš„ä¸šåŠ¡ï¼Œè¦æƒ³ä¿è¯å¹‚ç­‰æ€§ï¼Œå°±éœ€è¦æ ¹æ®å…¨å±€æ€§çš„ ID å»è¿›è¡Œæœ‰æ•ˆæ€§éªŒè¯ï¼ŒéªŒè¯é€šè¿‡æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</p>
<h2 id="é«˜å¯ç”¨çš„å­˜å‚¨"><a href="#é«˜å¯ç”¨çš„å­˜å‚¨" class="headerlink" title="é«˜å¯ç”¨çš„å­˜å‚¨"></a>é«˜å¯ç”¨çš„å­˜å‚¨</h2><p>å¯¹äºç»å¤§éƒ¨åˆ†è½¯ä»¶ç³»ç»Ÿè€Œè¨€ï¼Œæ•°æ®éƒ½æ˜¯æœ€å®è´µçš„è™šæ‹Ÿèµ„äº§ï¼Œä¸€æ—¦ä¸¢å¤±ï¼Œå¯ä»¥è¯´æ˜¯æ¯ç­æ€§çš„æ‰“å‡»ã€‚</p>
<p>ä¿è¯å­˜å‚¨é«˜å¯ç”¨çš„<strong>ä¸»è¦æ‰‹æ®µ</strong>æ˜¯ï¼š<strong>æ•°æ®å¤‡ä»½</strong>å’Œ<strong>å¤±æ•ˆè½¬ç§»</strong>ã€‚</p>
<p>å­˜å‚¨é«˜å¯ç”¨æ¶æ„çš„<strong>å¤æ‚æ€§</strong>ä¸»è¦ä½“ç°åœ¨ï¼š<strong>å¦‚ä½•åº”å¯¹å‰¯æœ¬åŒæ­¥å»¶è¿Ÿå’Œä¸­æ–­å¯¼è‡´çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜</strong>ã€‚</p>
<blockquote>
<p>æç¤ºï¼šå†å¼€å§‹å­¦ä¹ è¿™éƒ¨åˆ†å†…å®¹å‰ï¼Œå»ºè®®å…ˆå­¦ä¹  <strong>äºŒã€é«˜å¯ç”¨æ¶æ„ç†è®º</strong></p>
</blockquote>
<h3 id="æ•°æ®å¤‡ä»½"><a href="#æ•°æ®å¤‡ä»½" class="headerlink" title="æ•°æ®å¤‡ä»½"></a>æ•°æ®å¤‡ä»½</h3><p>æ•°æ®å¤‡ä»½æ˜¯ä¿è¯æ•°æ®æœ‰å¤šä¸ªå‰¯æœ¬ï¼Œä»»æ„å‰¯æœ¬çš„ä¸¢å¤±éƒ½ä¸ä¼šå¯¼è‡´æ•°æ®çš„æ°¸ä¹…ä¸¢å¤±ã€‚</p>
<ul>
<li><strong>å†·å¤‡ä»½</strong> - å®šæœŸå°†æ•°æ®å¤åˆ¶åˆ°æŸç§å­˜å‚¨ä»‹è´¨ã€‚</li>
<li><strong>çƒ­å¤‡ä»½</strong><ul>
<li><strong>å¼‚æ­¥çƒ­å¤‡æ–¹å¼</strong> - å¼‚æ­¥çƒ­å¤‡æ–¹å¼æ˜¯æŒ‡å¤šä»½æ•°æ®å‰¯æœ¬çš„å†™å…¥æ“ä½œå¼‚æ­¥å®Œæˆï¼Œåº”ç”¨ç¨‹åºæ”¶åˆ°æ•°æ®æœåŠ¡ç³»ç»Ÿçš„å†™æ“ä½œæˆåŠŸå“åº”æ—¶ï¼Œåªå†™æˆåŠŸäº†ä¸€ä»½ï¼Œå­˜å‚¨ç³»ç»Ÿå°†ä¼šå¼‚æ­¥åœ°å†™å…¶ä»–å‰¯æœ¬ã€‚</li>
<li><strong>åŒæ­¥çƒ­å¤‡æ–¹å¼</strong> - åŒæ­¥çƒ­å¤‡æ–¹å¼æ˜¯æŒ‡å¤šä»½æ•°æ®å‰¯æœ¬çš„å†™å…¥æ“ä½œåŒæ­¥å®Œæˆï¼Œå³åº”ç”¨ç¨‹åºæ”¶åˆ°æ•°æ®æœåŠ¡ç³»ç»Ÿçš„å†™æˆåŠŸå“åº”æ—¶ï¼Œå¤šä»½æ•°æ®éƒ½å·²ç»å†™æ“ä½œæˆåŠŸã€‚ä½†æ˜¯å½“åº”ç”¨ç¨‹åºæ”¶åˆ°æ•°æ®å†™æ“ä½œå¤±è´¥çš„å“åº”å¼ï¼Œå¯èƒ½æœ‰éƒ¨åˆ†å‰¯æœ¬æˆ–è€…å…¨éƒ¨å‰¯æœ¬éƒ½å·²ç»å†™å…¥æˆåŠŸäº†ï¼ˆå› ä¸ºç½‘ç»œæˆ–è€…ç³»ç»Ÿæ•…éšœï¼Œæ— æ³•è¿”å›æ“ä½œæˆåŠŸçš„å“åº”ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 id="å¤±æ•ˆè½¬ç§»"><a href="#å¤±æ•ˆè½¬ç§»" class="headerlink" title="å¤±æ•ˆè½¬ç§»"></a>å¤±æ•ˆè½¬ç§»</h3><p>å¤±æ•ˆè½¬ç§»æ˜¯ä¿è¯ä»»æ„ä¸€ä¸ªå‰¯æœ¬ä¸å¯è®¿é—®æ—¶ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢è®¿é—®å…¶ä»–å‰¯æœ¬ï¼Œä¿è¯ç³»ç»Ÿæ•´ä½“å¯ç”¨ã€‚</p>
<h4 id="å¤±æ•ˆç¡®è®¤"><a href="#å¤±æ•ˆç¡®è®¤" class="headerlink" title="å¤±æ•ˆç¡®è®¤"></a>å¤±æ•ˆç¡®è®¤</h4><div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/check-fail.png" width="500" />
</div>

<p>åˆ¤æ–­æœåŠ¡å™¨å®•æœºçš„æ‰‹æ®µæœ‰ä¸¤ç§ï¼š<strong>å¿ƒè·³æ£€æµ‹</strong>å’Œ<strong>è®¿é—®å¤±è´¥æŠ¥å‘Š</strong>ã€‚</p>
<p>å¯¹äºåº”ç”¨ç¨‹åºçš„è®¿é—®å¤±è´¥æŠ¥å‘Šï¼Œæ§åˆ¶ä¸­å¿ƒè¿˜éœ€è¦å†ä¸€æ¬¡å‘é€å¿ƒè·³æ£€æµ‹è¿›è¡Œç¡®è®¤ï¼Œä»¥å…é”™è¯¯åˆ¤æ–­æœåŠ¡å™¨å®•æœºã€‚å› ä¸ºä¸€æ—¦è¿›è¡Œæ•°æ®è®¿é—®çš„å¤±æ•ˆè½¬ç§»ï¼Œæ„å‘³ç€æ•°æ®å­˜å‚¨å¤šä»½å‰¯æœ¬ä¸ä¸€è‡´ï¼Œéœ€è¦è¿›è¡Œåç»­ä¸€ç³»åˆ—çš„å¤æ‚åŠ¨ä½œã€‚</p>
<h4 id="è®¿é—®è½¬ç§»"><a href="#è®¿é—®è½¬ç§»" class="headerlink" title="è®¿é—®è½¬ç§»"></a>è®¿é—®è½¬ç§»</h4><p>ç¡®è®¤æŸå°æ•°æ®æœåŠ¡å™¨å®•æœºåï¼Œå°±éœ€è¦å°†æ•°æ®è¯»å†™è®¿é—®é‡æ–°è·¯ç”±åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šã€‚å¯¹äºå®Œå…¨å¯¹ç­‰å­˜å‚¨çš„æœåŠ¡å™¨ï¼Œå½“å…¶ä¸­ä¸€å°å®•æœºåï¼Œåº”ç”¨ç¨‹åºæ ¹æ®é…ç½®ç›´æ¥åˆ‡æ¢åˆ°å¯¹ç­‰æœåŠ¡å™¨ä¸Šã€‚å¦‚æœå­˜å‚¨ä¸å¯¹ç­‰ï¼Œå°±éœ€è¦é‡æ–°è®¡ç®—è·¯ç”±ï¼Œé€‰æ‹©å­˜å‚¨æœåŠ¡å™¨ã€‚</p>
<h4 id="æ•°æ®æ¢å¤"><a href="#æ•°æ®æ¢å¤" class="headerlink" title="æ•°æ®æ¢å¤"></a>æ•°æ®æ¢å¤</h4><p>å› ä¸ºæŸå°æœåŠ¡å™¨å®•æœºï¼Œæ‰€ä»¥æ•°æ®å­˜å‚¨çš„å‰¯æœ¬æ•°ç›®ä¼šå‡å°‘ï¼Œå¿…é¡»å°†å‰¯æœ¬çš„æ•°ç›®æ¢å¤åˆ°ç³»ç»Ÿè®¾å®šçš„å€¼ï¼Œå¦åˆ™ï¼Œå†æœ‰æœåŠ¡å™¨å®•æœºæ—¶ï¼Œå°±å¯èƒ½å‡ºç°æ— æ³•è®¿é—®è½¬ç§»ï¼Œæ•°æ®æ°¸ä¹…ä¸¢å¤±çš„æƒ…å†µã€‚å› æ­¤ç³»ç»Ÿéœ€è¦ä»å¥åº·çš„æœåŠ¡å™¨å¤åˆ¶æ•°æ®ï¼Œå°†æ•°æ®å‰¯æœ¬æ•°ç›®æ¢å¤åˆ°è®¾å®šå€¼ã€‚</p>
<h2 id="è¾…åŠ©æ‰‹æ®µ"><a href="#è¾…åŠ©æ‰‹æ®µ" class="headerlink" title="è¾…åŠ©æ‰‹æ®µ"></a>è¾…åŠ©æ‰‹æ®µ</h2><h3 id="å¼‚åœ°å¤šæ´»"><a href="#å¼‚åœ°å¤šæ´»" class="headerlink" title="å¼‚åœ°å¤šæ´»"></a>å¼‚åœ°å¤šæ´»</h3><p>å¼‚åœ°å¤šæ´»æ¶æ„çš„å…³é”®ç‚¹å°±æ˜¯å¼‚åœ°ã€å¤šæ´»ï¼Œå…¶ä¸­å¼‚åœ°å°±æ˜¯æŒ‡åœ°ç†ä½ç½®ä¸Šä¸åŒçš„åœ°æ–¹ï¼Œç±»ä¼¼äºâ€œä¸è¦æŠŠé¸¡è›‹éƒ½æ”¾åœ¨åŒä¸€ç¯®å­é‡Œâ€ï¼›å¤šæ´»å°±æ˜¯æŒ‡ä¸åŒåœ°ç†ä½ç½®ä¸Šçš„ç³»ç»Ÿéƒ½èƒ½å¤Ÿæä¾›ä¸šåŠ¡æœåŠ¡ï¼Œè¿™é‡Œçš„â€œæ´»â€æ˜¯æ´»åŠ¨ã€æ´»è·ƒçš„æ„æ€ã€‚</p>
<p>å¼‚åœ°å¤šæ´»æ¶æ„å¯ä»¥åˆ†ä¸ºåŒåŸå¼‚åŒºã€è·¨åŸå¼‚åœ°ã€è·¨å›½å¼‚åœ°ã€‚</p>
<p>å¼‚åœ°å¤šæ´»æ¶æ„çš„ä»£ä»·ï¼š</p>
<ul>
<li>ç³»ç»Ÿå¤æ‚åº¦ä¼šå‘ç”Ÿè´¨çš„å˜åŒ–ï¼Œéœ€è¦è®¾è®¡å¤æ‚çš„å¼‚åœ°å¤šæ´»æ¶æ„ã€‚</li>
<li>æˆæœ¬ä¼šä¸Šå‡ï¼Œæ¯•ç«Ÿè¦å¤šåœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæœºæˆ¿æ­å»ºç‹¬ç«‹çš„ä¸€å¥—ä¸šåŠ¡ç³»ç»Ÿã€‚</li>
</ul>
<p>å¼‚åœ°å¤šæ´»çš„è®¾è®¡åŸåˆ™ï¼š</p>
<ul>
<li>ä¿è¯æ ¸å¿ƒä¸šåŠ¡çš„å¼‚åœ°å¤šæ´»</li>
<li>ä¿è¯æ ¸å¿ƒæ•°æ®æœ€ç»ˆä¸€è‡´æ€§</li>
<li>é‡‡ç”¨å¤šç§æ‰‹æ®µåŒæ­¥æ•°æ®</li>
<li>åªä¿è¯ç»å¤§éƒ¨åˆ†ç”¨æˆ·çš„å¼‚åœ°å¤šæ´»</li>
</ul>
<p>å¼‚åœ°å¤šæ´»è®¾è®¡æ­¥éª¤ï¼š</p>
<ul>
<li>ä¸šåŠ¡åˆ†çº§ - å¸¸è§çš„åˆ†çº§æ ‡å‡†æœ‰ï¼š<ul>
<li>æµé‡å¤§çš„ä¸šåŠ¡</li>
<li>æ ¸å¿ƒä¸šåŠ¡</li>
<li>ç›ˆåˆ©ä¸šåŠ¡</li>
</ul>
</li>
<li>æ•°æ®åˆ†ç±» - å¸¸è§çš„æ•°æ®åˆ†æç»´åº¦æœ‰ï¼š<ul>
<li>æ•°æ®é‡</li>
<li>å”¯ä¸€æ€§</li>
<li>å®æ—¶æ€§</li>
<li>å¯ä¸¢å®æ€§</li>
<li>å¯æ¢å¤æ€§</li>
</ul>
</li>
<li>æ•°æ®åŒæ­¥ - å¸¸è§çš„æ•°æ®åŒæ­¥æ–¹æ¡ˆ<ul>
<li>å­˜å‚¨ç³»ç»ŸåŒæ­¥</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—åŒæ­¥</li>
<li>é‡å¤ç”Ÿæˆ</li>
</ul>
</li>
<li>å¼‚å¸¸å¤„ç† - å¸¸è§å¼‚å¸¸å¤„ç†æªæ–½ï¼š<ul>
<li>å¤šé€šé“åŒæ­¥</li>
<li>åŒæ­¥å’Œè®¿é—®ç»“åˆ</li>
<li>æ—¥å¿—è®°å½•</li>
<li>ç”¨æˆ·è¡¥å¿</li>
</ul>
</li>
</ul>
<h3 id="å‘å¸ƒæµç¨‹"><a href="#å‘å¸ƒæµç¨‹" class="headerlink" title="å‘å¸ƒæµç¨‹"></a>å‘å¸ƒæµç¨‹</h3><p>é«˜å¯ç”¨çš„è½¯ä»¶è´¨é‡ä¿è¯çš„æ‰‹æ®µï¼š</p>
<ul>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li>é¢„å‘å¸ƒéªŒè¯</li>
<li>ä»£ç æ§åˆ¶</li>
<li>è‡ªåŠ¨åŒ–å‘å¸ƒ</li>
<li>ç°åº¦å‘å¸ƒ</li>
</ul>
<h3 id="ç³»ç»Ÿç›‘æ§"><a href="#ç³»ç»Ÿç›‘æ§" class="headerlink" title="ç³»ç»Ÿç›‘æ§"></a>ç³»ç»Ÿç›‘æ§</h3><blockquote>
<p>ä¸å…è®¸æ²¡æœ‰ç›‘æ§çš„ç³»ç»Ÿä¸Šçº¿ã€‚</p>
</blockquote>
<ul>
<li><strong>ç›‘æ§æ•°æ®é‡‡é›†</strong><ul>
<li><strong>ç”¨æˆ·è¡Œä¸ºæ—¥å¿—æ”¶é›†</strong><ul>
<li>æœåŠ¡ç«¯æ—¥å¿—æ”¶é›† - Apacheã€Nginx ç­‰å‡ ä¹æ‰€æœ‰ Web æœåŠ¡å™¨éƒ½å…·å¤‡æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œåªè¦å¼€å¯æ—¥å¿—è®°å½•å³å¯ã€‚å¦‚æœæ˜¯æœåŠ¡å™¨æ¯”è¾ƒå¤šï¼Œéœ€è¦é›†ä¸­é‡‡é›†æ—¥å¿—ï¼Œé€šå¸¸ä¼šä½¿ç”¨ Elastic æ¥è¿›è¡Œæ”¶é›†ã€‚</li>
<li>å®¢æˆ·ç«¯æ—¥å¿—æ”¶é›† - åˆ©ç”¨é¡µé¢åµŒå…¥ä¸“é—¨çš„ JavaScript è„šæœ¬å¯ä»¥æ”¶é›†ç”¨æˆ·çœŸå®çš„æ“ä½œè¡Œä¸ºã€‚</li>
<li>æ—¥å¿—åˆ†æ - å¯ä»¥åˆ©ç”¨ ElasticSearch åšè¯­ä¹‰åˆ†æåŠæœç´¢ï¼›åˆ©ç”¨å®æ—¶è®¡ç®—æ¡†æ¶ Stormã€Flink ç­‰å¼€å‘æ—¥å¿—ç»Ÿè®¡ä¸åˆ†æå·¥å…·ã€‚</li>
</ul>
</li>
<li><strong>æœåŠ¡å™¨æ€§èƒ½ç›‘æ§</strong> - æ”¶é›†æœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ç³»ç»Ÿè´Ÿè½½ã€å†…å­˜å ç”¨ã€CPU å ç”¨ã€ç£ç›˜ IOã€ç½‘ç»œ IO ç­‰ã€‚å¸¸ç”¨çš„ç›‘æ§å·¥å…·æœ‰ï¼š<a target="_blank" rel="noopener" href="https://github.com/apache/skywalking">Apache SkyWalking</a> ã€<a target="_blank" rel="noopener" href="https://github.com/naver/pinpoint">Pinpoint</a> ç­‰ã€‚</li>
<li><strong>è¿è¡Œæ•°æ®æŠ¥å‘Š</strong> - åº”è¯¥ç›‘æ§ä¸€äº›ä¸å…·ä½“ä¸šåŠ¡åœºæ™¯ç›¸å…³çš„æŠ€æœ¯å’Œä¸šåŠ¡æŒ‡æ ‡ï¼Œå¦‚ï¼šç¼“å­˜å‘½ä¸­ç‡ã€å¹³å‡å“åº”æ—¶å»¶ã€TPSã€QPS ç­‰ã€‚</li>
</ul>
</li>
<li><strong>ç›‘æ§ç®¡ç†</strong><ul>
<li><strong>ç³»ç»ŸæŠ¥è­¦</strong> - è®¾ç½®é˜ˆå€¼ã€‚å½“è¾¾åˆ°é˜ˆå€¼ï¼ŒåŠæ—¶è§¦å‘å‘Šè­¦ï¼ˆçŸ­ä¿¡ã€é‚®ä»¶ã€é€šä¿¡å·¥å…·å‡å¯ï¼‰ï¼Œé€šè¿‡åŠæ—¶åˆ¤æ–­çŠ¶å†µï¼Œé˜²æ‚£äºæœªç„¶ã€‚</li>
<li><strong>å¤±æ•ˆè½¬ç§»</strong> - ç›‘æ§ç³»ç»Ÿå¯ä»¥åœ¨å‘ç°æ•…éšœçš„æƒ…å†µä¸‹ä¸»åŠ¨é€šçŸ¥åº”ç”¨è¿›è¡Œå¤±æ•ˆè½¬ç§»ã€‚</li>
<li><strong>è‡ªåŠ¨ä¼˜é›…é™çº§</strong><ul>
<li>ä¼˜é›…é™çº§æ˜¯ä¸ºäº†åº”ä»˜çªç„¶çˆ†å‘çš„è®¿é—®é«˜å³°ï¼Œä¸»åŠ¨å…³é—­éƒ¨åˆ†åŠŸèƒ½ï¼Œé‡Šæ”¾éƒ¨åˆ†èµ„æºï¼Œä»¥ä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„ä¼˜å…ˆè®¿é—®ã€‚</li>
<li>ç³»ç»Ÿåœ¨ç›‘æ§ç®¡ç†åŸºç¡€ä¹‹ä¸Šå®ç°è‡ªåŠ¨ä¼˜é›…é™çº§ï¼Œæ˜¯æŸ”æ€§æ¶æ„çš„ç†æƒ³çŠ¶æ€ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/11322972.html">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/12153914.html">ã€Šäº¿çº§æµé‡ç½‘ç«™æ¶æ„æ ¸å¿ƒæŠ€æœ¯ï¼šè·Ÿå¼€æ¶›å­¦æ­å»ºé«˜å¯ç”¨é«˜å¹¶å‘ç³»ç»Ÿã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://time.geekbang.org/column/intro/48">å·¦è€³å¬é£</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/1e5251/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/1e5251/" class="post-title-link" itemprop="url">ç³»ç»Ÿä¼¸ç¼©æ€§æ¶æ„</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-05 15:11:00" itemprop="dateCreated datePublished" datetime="2018-07-05T15:11:00+08:00">2018-07-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">è®¾è®¡</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">æ¶æ„</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>2.4k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>2 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ç³»ç»Ÿä¼¸ç¼©æ€§æ¶æ„"><a href="#ç³»ç»Ÿä¼¸ç¼©æ€§æ¶æ„" class="headerlink" title="ç³»ç»Ÿä¼¸ç¼©æ€§æ¶æ„"></a>ç³»ç»Ÿä¼¸ç¼©æ€§æ¶æ„</h1><blockquote>
<p>ä¼¸ç¼©æ€§æ¶æ„æ˜¯æŒ‡ä¸éœ€è¦æ”¹å˜ç³»ç»Ÿçš„è½¯ç¡¬ä»¶è®¾è®¡ï¼Œä»…é€šè¿‡æ”¹å˜éƒ¨ç½²æœåŠ¡å™¨æ•°é‡å°±å¯ä»¥æ‰©å¤§æˆ–ç¼©å°ç³»ç»Ÿçš„æœåŠ¡å¤„ç†èƒ½åŠ›ã€‚</p>
</blockquote>
<h2 id="ç³»ç»Ÿæ¶æ„çš„ä¼¸ç¼©æ€§è®¾è®¡"><a href="#ç³»ç»Ÿæ¶æ„çš„ä¼¸ç¼©æ€§è®¾è®¡" class="headerlink" title="ç³»ç»Ÿæ¶æ„çš„ä¼¸ç¼©æ€§è®¾è®¡"></a>ç³»ç»Ÿæ¶æ„çš„ä¼¸ç¼©æ€§è®¾è®¡</h2><h3 id="ä¸åŒåŠŸèƒ½è¿›è¡Œç‰©ç†åˆ†ç¦»å®ç°ä¼¸ç¼©"><a href="#ä¸åŒåŠŸèƒ½è¿›è¡Œç‰©ç†åˆ†ç¦»å®ç°ä¼¸ç¼©" class="headerlink" title="ä¸åŒåŠŸèƒ½è¿›è¡Œç‰©ç†åˆ†ç¦»å®ç°ä¼¸ç¼©"></a>ä¸åŒåŠŸèƒ½è¿›è¡Œç‰©ç†åˆ†ç¦»å®ç°ä¼¸ç¼©</h3><ul>
<li><strong>çºµå‘åˆ†ç¦»ï¼ˆåˆ†å±‚ååˆ†ç¦»ï¼‰</strong> - å°†ä¸šåŠ¡å¤„ç†æµç¨‹ä¸Šçš„ä¸åŒéƒ¨åˆ†åˆ†ç¦»éƒ¨ç½²ï¼Œå®ç°ç³»ç»Ÿä¼¸ç¼©æ€§ã€‚</li>
<li><strong>æ¨ªå‘åˆ†ç¦»ï¼ˆä¸šåŠ¡åˆ†å‰²ååˆ†ç¦»ï¼‰</strong> - å°†ä¸åŒçš„ä¸šåŠ¡æ¨¡å—åˆ†ç¦»éƒ¨ç½²ï¼Œå®ç°ç³»ç»Ÿä¼¸ç¼©æ€§ã€‚</li>
</ul>
<h3 id="å•ä¸€åŠŸèƒ½é€šè¿‡é›†ç¾¤è§„æ¨¡å®ç°ä¼¸ç¼©"><a href="#å•ä¸€åŠŸèƒ½é€šè¿‡é›†ç¾¤è§„æ¨¡å®ç°ä¼¸ç¼©" class="headerlink" title="å•ä¸€åŠŸèƒ½é€šè¿‡é›†ç¾¤è§„æ¨¡å®ç°ä¼¸ç¼©"></a>å•ä¸€åŠŸèƒ½é€šè¿‡é›†ç¾¤è§„æ¨¡å®ç°ä¼¸ç¼©</h3><p>å°†ä¸åŒåŠŸèƒ½åˆ†ç¦»éƒ¨ç½²å¯ä»¥å®ç°ä¸€å®šç¨‹åº¦çš„ä¼¸ç¼©æ€§ï¼Œä½†æ˜¯éšç€è®¿é—®é‡é€æ­¥å¢åŠ ï¼Œå³ä½¿åˆ†ç¦»åˆ°æœ€å°ç²’åº¦çš„ç‹¬ç«‹éƒ¨ç½²ï¼Œå•ä¸€çš„æœåŠ¡å™¨ä¹Ÿä¸èƒ½æ»¡è¶³ä¸šåŠ¡è§„æ¨¡çš„è¦æ±‚ã€‚å› æ­¤å¿…é¡»ä½¿ç”¨æœåŠ¡å™¨é›†ç¾¤ï¼Œå³å°†ç›¸åŒæœåŠ¡éƒ¨ç½²åœ¨å¤šæ€æœåŠ¡å™¨ä¸Šæ„æˆä¸€ä¸ªé›†ç¾¤æ•´ä½“å¯¹å¤–æä¾›æœåŠ¡ã€‚</p>
<h2 id="åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"><a href="#åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡" class="headerlink" title="åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"></a>åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡</h2><p>å¦‚æœ HTTP è¯·æ±‚åˆ†å‘è£…ç½®å¯ä»¥æ„ŸçŸ¥æˆ–è€…å¯ä»¥é…ç½®é›†ç¾¤çš„æœåŠ¡å™¨æ•°é‡ï¼Œå¯ä»¥åŠæ—¶å‘ç°é›†ç¾¤ä¸­æ–°ä¸Šçº¿æˆ–ä¸‹çº¿çš„æœåŠ¡å™¨ï¼Œå¹¶èƒ½å‘æ–°ä¸Šçº¿çš„æœåŠ¡å™¨åˆ†å‘è¯·æ±‚ï¼Œåœæ­¢å‘å·²ä¸‹çº¿çš„æœåŠ¡å™¨åˆ†å‘è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å®ç°äº†åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§ã€‚</p>
<h3 id="HTTP-é‡å®šå‘è´Ÿè½½å‡è¡¡"><a href="#HTTP-é‡å®šå‘è´Ÿè½½å‡è¡¡" class="headerlink" title="HTTP é‡å®šå‘è´Ÿè½½å‡è¡¡"></a>HTTP é‡å®šå‘è´Ÿè½½å‡è¡¡</h3><div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡-HTTPé‡å®šå‘.png" width="500"/>
</div>

<p>åˆ©ç”¨ HTTP é‡å®šå‘åè®®å®ç°è´Ÿè½½å‡è¡¡ã€‚</p>
<p>è¿™ç§è´Ÿè½½å‡è¡¡æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æ¯”è¾ƒç®€å•ã€‚</p>
<p>ç¼ºç‚¹æ˜¯æµè§ˆå™¨éœ€è¦ä¸¤æ¬¡è¯·æ±‚æœåŠ¡å™¨æ‰èƒ½å®Œæˆä¸€æ¬¡è®¿é—®ï¼Œæ€§èƒ½è¾ƒå·®ï¼šé‡å®šå‘æœåŠ¡å™¨è‡ªèº«çš„å¤„ç†èƒ½åŠ›æœ‰å¯èƒ½æˆä¸ºç“¶é¢ˆï¼Œæ•´ä¸ªé›†ç¾¤çš„ä¼¸ç¼©æ€§è§„æ¨¡æœ‰é™ï¼›ä½¿ç”¨ HTTP 302 å“åº”ç é‡å®šå‘ï¼Œå¯èƒ½ä½¿æœç´¢å¼•æ“åˆ¤æ–­ä¸º SEO ä½œå¼Šï¼Œé™ä½æœç´¢æ’åã€‚</p>
<h3 id="DNS-åŸŸåè§£æè´Ÿè½½å‡è¡¡"><a href="#DNS-åŸŸåè§£æè´Ÿè½½å‡è¡¡" class="headerlink" title="DNS åŸŸåè§£æè´Ÿè½½å‡è¡¡"></a>DNS åŸŸåè§£æè´Ÿè½½å‡è¡¡</h3><p>åˆ©ç”¨ DNS å¤„ç†åŸŸåè§£æè¯·æ±‚çš„åŒæ—¶è¿›è¡Œè´Ÿè½½å‡è¡¡å¤„ç†çš„ä¸€ç§æ–¹æ¡ˆã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡-DNSåŸŸåè§£æ.png" width="500"/>
</div>

<p>åœ¨ DNS æœåŠ¡å™¨ä¸­é…ç½®å¤šä¸ª A è®°å½•ï¼Œå¦‚ï¼š</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">114.100.40.1</span> www.mysite.com</span><br><span class="line"><span class="number">114.100.40.2</span> www.mysite.com</span><br><span class="line"><span class="number">114.100.40.3</span> www.mysite.com</span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡åŸŸåè§£æè¯·æ±‚éƒ½ä¼šæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•è®¡ç®—ä¸€ä¸ªä¸åŒçš„ IP åœ°å€è¿”å›ï¼Œè¿™æ · A è®°å½•ä¸­é…ç½®çš„å¤šä¸ªæœåŠ¡å™¨å°±æ„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå¹¶å¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</p>
<p>DNS åŸŸåè§£æè´Ÿè½½å‡è¡¡çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å°†è´Ÿè½½å‡è¡¡çš„å·¥ä½œè½¬äº¤ç»™äº† DNSï¼Œçœæ‰äº†ç½‘ç«™ç®¡ç†ç»´æŠ¤çš„éº»çƒ¦ã€‚</li>
<li>åŒæ—¶ï¼Œè®¸å¤š DNS æœåŠ¡å™¨è¿˜æ”¯æŒåŸºäºåœ°ç†ä½ç½®çš„åŸŸåè§£æï¼Œå³å°†åŸŸåè§£ææˆè·ç¦»ç”¨æˆ·åœ°ç†æœ€è¿‘çš„ä¸€ä¸ªæœåŠ¡å™¨åœ°å€ï¼Œè¿™æ ·å¯ä»¥åŠ å¿«ç”¨æˆ·è®¿é—®é€Ÿåº¦ï¼Œæ”¹å–„æ€§èƒ½ã€‚</li>
</ul>
<p>DNS åŸŸåè§£æè´Ÿè½½å‡è¡¡çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>DNS æ˜¯å¤šçº§è§£æï¼Œæ¯ä¸€çº§ DNS éƒ½å¯èƒ½ç¼“å­˜ A è®°å½•ï¼Œå½“æŸå°æœåŠ¡å™¨ä¸‹çº¿åï¼Œå³ä½¿ä¿®æ”¹äº† DNS çš„ A è®°å½•ï¼Œè¦ä½¿å…¶ç”Ÿæ•ˆä¹Ÿéœ€è¦è¾ƒé•¿æ—¶é—´ã€‚è¿™æ®µæ—¶é—´ï¼Œä¾ç„¶ä¼šåŸŸåè§£æåˆ°å·²ç»ä¸‹çº¿çš„æœåŠ¡å™¨ï¼Œå¯¼è‡´ç”¨æˆ·è®¿é—®å¤±è´¥ã€‚</li>
<li>DNS çš„è´Ÿè½½å‡è¡¡çš„æ§åˆ¶æƒåœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œï¼Œç½‘ç«™æ— æ³•å¯¹å…¶åšæ›´å¤šæ”¹å–„å’Œæ›´å¼ºå¤§çš„ç®¡ç†ã€‚</li>
</ul>
<h3 id="åå‘ä»£ç†è´Ÿè½½å‡è¡¡"><a href="#åå‘ä»£ç†è´Ÿè½½å‡è¡¡" class="headerlink" title="åå‘ä»£ç†è´Ÿè½½å‡è¡¡"></a>åå‘ä»£ç†è´Ÿè½½å‡è¡¡</h3><p>å¤§å¤šæ•°åå‘ä»£ç†æœåŠ¡å™¨åŒæ—¶æä¾›åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡-åå‘ä»£ç†.png" width="500"/>
</div>

<p>åå‘ä»£ç†æœåŠ¡å™¨çš„ä¼˜ç‚¹æ˜¯éƒ¨ç½²ç®€å•ã€‚ç¼ºç‚¹æ˜¯åå‘ä»£ç†æœåŠ¡å™¨æ˜¯æ‰€æœ‰è¯·æ±‚å’Œå“åº”çš„ä¸­è½¬ç«™ï¼Œå…¶æ€§èƒ½å¯èƒ½ä¼šæˆä¸ºç“¶é¢ˆã€‚</p>
<h3 id="IP-è´Ÿè½½å‡è¡¡"><a href="#IP-è´Ÿè½½å‡è¡¡" class="headerlink" title="IP è´Ÿè½½å‡è¡¡"></a>IP è´Ÿè½½å‡è¡¡</h3><p>åœ¨ç½‘ç»œå±‚é€šè¿‡ä¿®æ”¹è¯·æ±‚ç›®æ ‡åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡-IPå±‚.png" width="500"/>
</div>

<p>è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼ˆç½‘å…³æœåŠ¡å™¨ï¼‰åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸è·å–ç½‘ç»œæ•°æ®åŒ…ï¼Œæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•è®¡ç®—å¾—åˆ°ä¸€å°çœŸå® Web æœåŠ¡å™¨ 10.0.0.1ï¼Œç„¶åå°†ç›®çš„ IP åœ°å€ä¿®æ”¹ä¸º 10.0.0.1ï¼Œä¸éœ€è¦é€šè¿‡ç”¨æˆ·è¿›ç¨‹ã€‚çœŸå® Web æœåŠ¡å™¨å¤„ç†å®Œæˆåï¼Œå“åº”æ•°æ®åŒ…å›åˆ°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œè´Ÿè½½å‡è¡¡æœåŠ¡å™¨å†å°†æ•°æ®åŒ…åŸåœ°å€ä¿®æ”¹ä¸ºè‡ªèº«çš„ IP åœ°å€ï¼ˆ114.100.80.10ï¼‰å‘é€ç»™æµè§ˆå™¨ã€‚</p>
<p>IP è´Ÿè½½å‡è¡¡åœ¨å†…æ ¸å®Œæˆæ•°æ®åˆ†å‘ï¼Œæ‰€ä»¥å¤„ç†æ€§èƒ½ä¼˜äºåå‘ä»£ç†è´Ÿè½½å‡è¡¡ã€‚ä½†æ˜¯å› ä¸ºæ‰€æœ‰è¯·æ±‚å“åº”éƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œé›†ç¾¤çš„æœ€å¤§å“åº”æ•°æ®ååé‡å—åˆ¶äºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç½‘å¡å¸¦å®½ã€‚</p>
<h3 id="æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"><a href="#æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡" class="headerlink" title="æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"></a>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡</h3><p>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡æ˜¯æŒ‡åœ¨é€šä¿¡åè®®çš„æ•°æ®é“¾è·¯å±‚ä¿®æ”¹ mac åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/è´Ÿè½½å‡è¡¡-æ•°æ®é“¾è·¯å±‚.png" width="500"/>
</div>

<p>è¿™ç§æ–¹å¼åˆç§°ä½œä¸‰è§’ä¼ è¾“æ–¹å¼ï¼Œè´Ÿè½½å‡è¡¡æ•°æ®åˆ†å‘è¿‡ç¨‹ä¸­ä¸ä¿®æ”¹ IP åœ°å€ï¼Œåªä¿®æ”¹ç›®çš„ mac åœ°å€ï¼Œé€šè¿‡é…ç½®çœŸå®ç‰©ç†æœåŠ¡å™¨é›†ç¾¤æ‰€æœ‰æœºå™¨è™šæ‹Ÿ IP å’Œè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ IP åœ°å€ä¸€è‡´ï¼Œä»è€Œè¾¾åˆ°ä¸ä¿®æ”¹æ•°æ®åŒ…çš„æºåœ°å€å’Œç›®çš„åœ°å€å°±å¯ä»¥è¿›è¡Œæ•°æ®åˆ†å‘çš„ç›®çš„ï¼Œç”±äºå®é™…å¤„ç†è¯·æ±‚çš„çœŸå®ç‰©ç†æœåŠ¡å™¨ IP å’Œæ•°æ®è¯·æ±‚ç›®çš„ IP ä¸€è‡´ï¼Œä¸éœ€è¦é€šè¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨è¿›è¡Œåœ°å€è½¬æ¢ï¼Œå¯å°†å“åº”æ•°æ®åŒ…ç›´æ¥è¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨ï¼Œé¿å…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç½‘å¡å¸¦å®½æˆä¸ºç“¶é¢ˆã€‚è¿™ç§è´Ÿè½½æ–¹å¼åˆç§°ä½œç›´æ¥è·¯ç”±æ–¹å¼ã€‚</p>
<p>åœ¨ Linux å¹³å°ä¸Šæœ€å¥½çš„é“¾è·¯å±‚è´Ÿè½½å‡è¡¡å¼€æºäº§å“æ˜¯ **LVS(Linux Virtual Server)**ã€‚</p>
<h3 id="è´Ÿè½½å‡è¡¡ç®—æ³•"><a href="#è´Ÿè½½å‡è¡¡ç®—æ³•" class="headerlink" title="è´Ÿè½½å‡è¡¡ç®—æ³•"></a>è´Ÿè½½å‡è¡¡ç®—æ³•</h3><p>è´Ÿè½½å‡è¡¡æœåŠ¡å™¨çš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>æ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•å’Œ Web æœåŠ¡å™¨åˆ—è¡¨è®¡ç®—å¾—åˆ°é›†ç¾¤ä¸­ä¸€å° Web æœåŠ¡å™¨çš„åœ°å€ã€‚</li>
<li>å°†è¯·æ±‚æ•°æ®å‘é€åˆ°è¯¥åœ°å€å¯¹åº”çš„ Web æœåŠ¡å™¨ä¸Šã€‚</li>
</ol>
<p>è´Ÿè½½å‡è¡¡ç®—æ³•é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><strong>è½®è¯¢ï¼ˆRound Robinï¼‰</strong> - æ‰€æœ‰è¯·æ±‚è¢«ä¾æ¬¡åˆ†å‘åˆ°æ¯å°åº”ç”¨æœåŠ¡å™¨ä¸Šï¼Œå³æ¯å°æœåŠ¡å™¨éœ€è¦å¤„ç†çš„è¯·æ±‚æ•°æ®éƒ½ç›¸åŒï¼Œé€‚åˆäºæ‰€æœ‰æœåŠ¡å™¨ç¡¬ä»¶éƒ½ç›¸åŒçš„åœºæ™¯ã€‚</li>
<li><strong>åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robinï¼‰</strong> - æ ¹æ®æœåŠ¡å™¨ç¡¬ä»¶æ€§èƒ½æƒ…å†µï¼Œåœ¨è½®è¯¢çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§é…ç½®æƒé‡å°†è¯·æ±‚åˆ†å‘åˆ°æ¯ä¸ªæœåŠ¡å™¨ï¼Œé«˜æ€§èƒ½æœåŠ¡å™¨èƒ½åˆ†é…æ›´å¤šè¯·æ±‚ã€‚</li>
<li><strong>éšæœºï¼ˆRandomï¼‰</strong> - è¯·æ±‚è¢«éšæœºåˆ†é…åˆ°å„ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œåœ¨è®¸å¤šåœºåˆä¸‹ï¼Œè¿™ç§æ–¹æ¡ˆéƒ½å¾ˆç®€å•å®ç”¨ï¼Œå› ä¸ºå¥½çš„éšæœºæ•°æœ¬èº«å°±å¾ˆå¹³å‡ï¼Œå³ä½¿åº”ç”¨æœåŠ¡å™¨ç¡¬ä»¶é…ç½®ä¸åŒï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŠ æƒéšæœºç®—æ³•ã€‚</li>
<li><strong>æœ€å°‘è¿æ¥ï¼ˆLeast Connectionï¼‰</strong> - è®°å½•æ¯ä¸ªåº”ç”¨æœåŠ¡å™¨æ­£åœ¨å¤„ç†çš„è¿æ¥æ•°ï¼Œå°†æ–°åˆ°çš„è¯·æ±‚åˆ†å‘åˆ°æœ€å°‘è¿æ¥çš„æœåŠ¡å™¨ä¸Šï¼Œåº”è¯¥è¯´ï¼Œè¿™æ˜¯æœ€ç¬¦åˆè´Ÿè½½å‡è¡¡å®šä¹‰çš„ç®—æ³•ã€‚</li>
<li><strong>æºåœ°å€ Hashï¼ˆSource Hashï¼‰</strong> - æ ¹æ®è¯·æ±‚æ¥æºçš„ IP åœ°å€è¿›è¡Œ Hash è®¡ç®—ï¼Œå¾—åˆ°åº”ç”¨æœåŠ¡å™¨ï¼Œè¿™æ ·æ¥è‡ªåŒä¸€ä¸ª IP åœ°å€çš„è¯·æ±‚æ€»åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šå¤„ç†ï¼Œè¯¥è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å¯ä»¥å­˜å‚¨åœ¨è¿™å°æœåŠ¡å™¨ä¸Šï¼Œåœ¨ä¸€ä¸ªä¼šè¯å‘¨æœŸå†…é‡å¤ä½¿ç”¨ï¼Œä»è€Œå®ç°ä¼šè¯ç²˜æ»ã€‚</li>
</ul>
<h2 id="åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"><a href="#åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"></a>åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡</h2><p>ç›®å‰æ¯”è¾ƒæµè¡Œçš„åˆ†å¸ƒå¼é›†ç¾¤ä¼¸ç¼©æ€§æ–¹æ¡ˆå°±æ˜¯ï¼šä¸€è‡´æ€§ HASH ç®—æ³•</p>
<h2 id="æ•°æ®å­˜å‚¨æœåŠ¡é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"><a href="#æ•°æ®å­˜å‚¨æœåŠ¡é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡" class="headerlink" title="æ•°æ®å­˜å‚¨æœåŠ¡é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"></a>æ•°æ®å­˜å‚¨æœåŠ¡é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡</h2><h3 id="å…³ç³»å‹æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"><a href="#å…³ç³»å‹æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡" class="headerlink" title="å…³ç³»å‹æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"></a>å…³ç³»å‹æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡</h3><ul>
<li><strong>ä¸»ä»å¤åˆ¶</strong> - ä¸»æµå…³ç³»å‹æ•°æ®åº“ä¸€èˆ¬éƒ½æ”¯æŒä¸»ä»å¤åˆ¶ã€‚</li>
<li><strong>åˆ†åº“</strong> - æ ¹æ®ä¸šåŠ¡å¯¹æ•°æ®åº“è¿›è¡Œåˆ†å‰²ã€‚åˆ¶çº¦æ¡ä»¶æ˜¯è·¨åº“çš„è¡¨ä¸èƒ½è¿›è¡Œ Join æ“ä½œã€‚</li>
<li><strong>åˆ†è¡¨</strong> - ä½¿ç”¨æ•°æ®åº“åˆ†ç‰‡ä¸­é—´ä»¶ï¼Œå¦‚ Cobar ç­‰ã€‚</li>
</ul>
<h3 id="NoSql-æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"><a href="#NoSql-æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡" class="headerlink" title="NoSql æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"></a>NoSql æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡</h3><p>ä¸€èˆ¬è€Œè¨€ï¼ŒNosql ä¸æ”¯æŒ SQL å’Œ ACIDï¼Œä½†æ˜¯å¼ºåŒ–äº†å¯¹äºé«˜å¯ç”¨å’Œä¼¸ç¼©æ€§çš„æ”¯æŒã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/11322972.html">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/943670/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/943670/" class="post-title-link" itemprop="url">ç³»ç»Ÿæ‰©å±•æ€§æ¶æ„</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-07-05 15:11:00" itemprop="dateCreated datePublished" datetime="2018-07-05T15:11:00+08:00">2018-07-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-26 07:52:26" itemprop="dateModified" datetime="2022-12-26T07:52:26+08:00">2022-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">è®¾è®¡</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">æ¶æ„</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>3.4k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>3 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ç³»ç»Ÿæ‰©å±•æ€§æ¶æ„"><a href="#ç³»ç»Ÿæ‰©å±•æ€§æ¶æ„" class="headerlink" title="ç³»ç»Ÿæ‰©å±•æ€§æ¶æ„"></a>ç³»ç»Ÿæ‰©å±•æ€§æ¶æ„</h1><blockquote>
<p>æ‰©å±•æ€§å’Œä¼¸ç¼©æ€§æ˜¯ä¸åŒçš„æ¦‚å¿µï¼š</p>
<ul>
<li><strong>æ‰©å±•æ€§ï¼ˆExtensibilityï¼‰</strong> - æŒ‡å¯¹ç°æœ‰ç³»ç»Ÿå½±å“æœ€å°çš„æƒ…å†µä¸‹ï¼Œç³»ç»ŸåŠŸèƒ½å¯æŒç»­æ‰©å±•æˆ–æå‡çš„èƒ½åŠ›ã€‚è¡¨ç°åœ¨ç³»ç»ŸåŸºç¡€è®¾æ–½ç¨³å®šä¸éœ€è¦ç»å¸¸å˜æ›´ï¼Œåº”ç”¨ä¹‹é—´è¾ƒå°‘ä¾èµ–å’Œè€¦åˆï¼Œå¯¹éœ€æ±‚å˜æ›´å¯ä»¥æ•æ·å“åº”ã€‚å®ƒæ˜¯ç³»ç»Ÿæ¶æ„è®¾è®¡å±‚é¢çš„å¼€é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ã€å¯¹ä¿®æ”¹å…³é—­ï¼‰ï¼Œæ¶æ„è®¾è®¡è€ƒè™‘æœªæ¥åŠŸèƒ½æ‰©å±•ï¼Œå½“ç³»ç»Ÿå¢åŠ æ–°åŠŸèƒ½æ—¶ï¼Œä¸éœ€è¦å¯¹ç°æœ‰ç³»ç»Ÿçš„ç»“æ„å’Œä»£ç è¿›è¡Œä¿®æ”¹ã€‚</li>
<li><strong>ä¼¸ç¼©æ€§ï¼ˆScalabilityï¼‰</strong> - æŒ‡ç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡å¢åŠ å‡å°‘è‡ªèº«èµ„æºè§„æ¨¡çš„æ–¹å¼å¢å‡è‡ªå·±è®¡ç®—å¤„ç†äº‹åŠ¡çš„èƒ½åŠ›ã€‚å¦‚æœè¿™ç§å¢å‡æ˜¯æˆæ¯”ä¾‹çš„ï¼Œå°±è¢«ç§°ä½œçº¿æ€§ä¼¸ç¼©æ€§ã€‚åœ¨ç½‘ç«™æ¶æ„ä¸­ ï¼Œé€šå¸¸æŒ‡åˆ©ç”¨é›†ç¾¤çš„æ–¹å¼å¢åŠ æœåŠ¡å™¨æ•°é‡ã€æé«˜ç³»ç»Ÿçš„æ•´ä½“äº‹åŠ¡ååèƒ½åŠ›ã€‚</li>
</ul>
</blockquote>
<h2 id="å¯æ‰©å±•çš„åŸºæœ¬æ€æƒ³"><a href="#å¯æ‰©å±•çš„åŸºæœ¬æ€æƒ³" class="headerlink" title="å¯æ‰©å±•çš„åŸºæœ¬æ€æƒ³"></a>å¯æ‰©å±•çš„åŸºæœ¬æ€æƒ³</h2><ul>
<li>é¢å‘æµç¨‹æ‹†åˆ†ï¼šå°†æ•´ä¸ªä¸šåŠ¡æµç¨‹æ‹†åˆ†ä¸ºå‡ ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µä½œä¸ºä¸€éƒ¨åˆ†ã€‚</li>
<li>é¢å‘æœåŠ¡æ‹†åˆ†ï¼šå°†ç³»ç»Ÿæä¾›çš„æœåŠ¡æ‹†åˆ†ï¼Œæ¯ä¸ªæœåŠ¡ä½œä¸ºä¸€éƒ¨åˆ†ã€‚</li>
<li>é¢å‘åŠŸèƒ½æ‹†åˆ†ï¼šå°†ç³»ç»Ÿæä¾›çš„åŠŸèƒ½æ‹†åˆ†ï¼Œæ¯ä¸ªåŠŸèƒ½ä½œä¸ºä¸€éƒ¨åˆ†ã€‚</li>
</ul>
<h2 id="å¯æ‰©å±•æ–¹å¼"><a href="#å¯æ‰©å±•æ–¹å¼" class="headerlink" title="å¯æ‰©å±•æ–¹å¼"></a>å¯æ‰©å±•æ–¹å¼</h2><p>å…¸å‹çš„å¯æ‰©å±•ç³»ç»Ÿæ¶æ„æœ‰ï¼š</p>
<ul>
<li>é¢å‘æµç¨‹æ‹†åˆ†ï¼šåˆ†å±‚æ¶æ„ã€‚</li>
<li>é¢å‘æœåŠ¡æ‹†åˆ†ï¼šSOAã€å¾®æœåŠ¡ã€‚</li>
<li>é¢å‘åŠŸèƒ½æ‹†åˆ†ï¼šå¾®å†…æ ¸æ¶æ„ã€‚</li>
</ul>
<h3 id="åˆ†å±‚æ¶æ„"><a href="#åˆ†å±‚æ¶æ„" class="headerlink" title="åˆ†å±‚æ¶æ„"></a>åˆ†å±‚æ¶æ„</h3><p>åˆ†å±‚æ¶æ„çš„æ ¸å¿ƒç‚¹æ—¶ï¼š<strong>éœ€è¦ä¿è¯å„å±‚ä¹‹é—´çš„å·®å¼‚è¶³å¤Ÿæ¸…æ™°ï¼Œè¾¹ç•Œè¶³å¤Ÿæ˜æ˜¾ï¼Œè®©äººçœ‹åˆ°æ¶æ„å›¾åå°±èƒ½çœ‹æ‡‚æ•´ä¸ªæ¶æ„</strong></p>
<p>åˆ†å±‚æ¶æ„æ˜¯å¾ˆå¸¸è§çš„æ¶æ„æ¨¡å¼ï¼Œå®ƒä¹Ÿå« N å±‚æ¶æ„ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼ŒN è‡³å°‘æ˜¯ 2 å±‚ã€‚ä¾‹å¦‚ï¼ŒC&#x2F;S æ¶æ„ã€B&#x2F;S æ¶æ„ã€‚å¸¸è§çš„æ˜¯ 3 å±‚æ¶æ„ï¼ˆä¾‹å¦‚ï¼ŒMVCã€MVP æ¶æ„ï¼‰ã€4 å±‚æ¶æ„ï¼Œ5 å±‚æ¶æ„çš„æ¯”è¾ƒå°‘è§ï¼Œä¸€èˆ¬æ˜¯æ¯”è¾ƒå¤æ‚çš„ç³»ç»Ÿæ‰ä¼šè¾¾åˆ°æˆ–è€…è¶…è¿‡ 5 å±‚ï¼Œæ¯”å¦‚æ“ä½œç³»ç»Ÿå†…æ ¸æ¶æ„ã€‚</p>
<p>å…¸å‹åˆ†å±‚æ¶æ„ï¼š</p>
<ul>
<li>C&#x2F;S æ¶æ„ã€B&#x2F;S æ¶æ„</li>
<li>MVC æ¶æ„ã€MVP æ¶æ„</li>
<li>é€»è¾‘åˆ†å±‚æ¶æ„</li>
</ul>
<h3 id="SOA"><a href="#SOA" class="headerlink" title="SOA"></a>SOA</h3><p>SOA çš„å…¨ç§°æ˜¯ Service Oriented Architectureï¼Œå³â€œé¢å‘æœåŠ¡çš„æ¶æ„â€ã€‚</p>
<p>SOA æå‡ºäº† 3 ä¸ªå…³é”®æ¦‚å¿µã€‚</p>
<ul>
<li><strong>æœåŠ¡</strong> - æ‰€æœ‰ä¸šåŠ¡åŠŸèƒ½éƒ½æ˜¯ä¸€é¡¹æœåŠ¡ï¼ŒæœåŠ¡å°±æ„å‘³ç€è¦å¯¹å¤–æä¾›å¼€æ”¾çš„èƒ½åŠ›ï¼Œå½“å…¶ä»–ç³»ç»Ÿéœ€è¦ä½¿ç”¨è¿™é¡¹åŠŸèƒ½æ—¶ï¼Œæ— é¡»å®šåˆ¶åŒ–å¼€å‘ã€‚</li>
<li><strong>ESB</strong> - ESB çš„å…¨ç§°æ˜¯ Enterprise Service Busï¼Œå³ â€œä¼ä¸šæœåŠ¡æ€»çº¿â€ã€‚ESB å°†ä¼ä¸šä¸­å„ä¸ªä¸åŒçš„æœåŠ¡è¿æ¥åœ¨ä¸€èµ·ã€‚å› ä¸ºå„ä¸ªç‹¬ç«‹çš„æœåŠ¡æ˜¯å¼‚æ„çš„ï¼Œå¦‚æœæ²¡æœ‰ç»Ÿä¸€çš„æ ‡å‡†ï¼Œåˆ™å„ä¸ªå¼‚æ„ç³»ç»Ÿå¯¹å¤–æä¾›çš„æ¥å£æ˜¯å„å¼å„æ ·çš„ã€‚SOA ä½¿ç”¨ ESB æ¥å±è”½å¼‚æ„ç³»ç»Ÿå¯¹å¤–æä¾›å„ç§ä¸åŒçš„æ¥å£æ–¹å¼ï¼Œä»¥æ­¤æ¥è¾¾åˆ°æœåŠ¡é—´é«˜æ•ˆçš„äº’è”äº’é€šã€‚</li>
<li><strong>æ¾è€¦åˆ</strong> - æ¾è€¦åˆçš„ç›®çš„æ˜¯å‡å°‘å„ä¸ªæœåŠ¡é—´çš„ä¾èµ–å’Œäº’ç›¸å½±å“ã€‚å› ä¸ºé‡‡ç”¨ SOA æ¶æ„åï¼Œå„ä¸ªæœåŠ¡æ˜¯ç›¸äº’ç‹¬ç«‹è¿è¡Œçš„ï¼Œç”šè‡³éƒ½ä¸æ¸…æ¥šæŸä¸ªæœåŠ¡åˆ°åº•æœ‰å¤šå°‘å¯¹å…¶ä»–æœåŠ¡çš„ä¾èµ–ã€‚å¦‚æœåšä¸åˆ°æ¾è€¦åˆï¼ŒæŸä¸ªæœåŠ¡ä¸€å‡çº§ï¼Œä¾èµ–å®ƒçš„å…¶ä»–æœåŠ¡å…¨éƒ¨æ•…éšœï¼Œè¿™æ ·è‚¯å®šæ˜¯æ— æ³•æ»¡è¶³ä¸šåŠ¡éœ€æ±‚çš„ã€‚</li>
</ul>
<h3 id="å¾®æœåŠ¡"><a href="#å¾®æœåŠ¡" class="headerlink" title="å¾®æœåŠ¡"></a>å¾®æœåŠ¡</h3><p>å¾®æœåŠ¡æ˜¯å»æ‰ ESB åçš„ SOAã€‚</p>
<p>å¾®æœåŠ¡çš„é—®é¢˜ï¼š</p>
<ul>
<li><strong>æœåŠ¡åˆ’åˆ†è¿‡ç»†ï¼ŒæœåŠ¡é—´å…³ç³»å¤æ‚</strong> - æœåŠ¡åˆ’åˆ†è¿‡ç»†ï¼Œå•ä¸ªæœåŠ¡çš„å¤æ‚åº¦ç¡®å®ä¸‹é™äº†ï¼Œä½†æ•´ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦å´ä¸Šå‡äº†ï¼Œå› ä¸ºå¾®æœåŠ¡å°†ç³»ç»Ÿå†…çš„å¤æ‚åº¦è½¬ç§»ä¸ºç³»ç»Ÿé—´çš„å¤æ‚åº¦äº†ã€‚</li>
<li>æœåŠ¡æ•°é‡å¤ªå¤šï¼Œå›¢é˜Ÿæ•ˆç‡æ€¥å‰§ä¸‹é™</li>
<li>è°ƒç”¨é“¾å¤ªé•¿ï¼Œæ€§èƒ½ä¸‹é™</li>
<li>è°ƒç”¨é“¾å¤ªé•¿ï¼Œé—®é¢˜å®šä½å›°éš¾</li>
<li>æ²¡æœ‰è‡ªåŠ¨åŒ–æ”¯æ’‘ï¼Œæ— æ³•å¿«é€Ÿäº¤ä»˜</li>
<li>æ²¡æœ‰æœåŠ¡æ²»ç†ï¼Œå¾®æœåŠ¡æ•°é‡å¤šäº†åç®¡ç†æ··ä¹±</li>
</ul>
<p>å¾®æœåŠ¡æ‹†åˆ†ï¼š</p>
<ul>
<li><strong>åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†</strong></li>
<li><strong>åŸºäºå¯æ‰©å±•æ‹†åˆ†</strong> - å°†å·²ç»æˆç†Ÿå’Œæ”¹åŠ¨ä¸å¤§çš„æœåŠ¡æ‹†åˆ†ä¸º<strong>ç¨³å®šæœåŠ¡</strong>ï¼Œå°†ç»å¸¸å˜åŒ–å’Œè¿­ä»£çš„æœåŠ¡æ‹†åˆ†ä¸º<strong>å˜åŠ¨æœåŠ¡</strong>ã€‚</li>
<li><strong>åŸºäºå¯é æ€§æ‹†åˆ†</strong> - å°†ç³»ç»Ÿä¸­çš„ä¸šåŠ¡æ¨¡å—æŒ‰ç…§ä¼˜å…ˆçº§æ’åºï¼Œå°†å¯é æ€§è¦æ±‚é«˜çš„æ ¸å¿ƒæœåŠ¡å’Œå¯é æ€§è¦æ±‚ä½çš„éæ ¸å¿ƒæœåŠ¡æ‹†åˆ†å¼€æ¥ï¼Œç„¶åé‡ç‚¹ä¿è¯æ ¸å¿ƒæœåŠ¡çš„é«˜å¯ç”¨ã€‚</li>
</ul>
<p>åŸºç¡€è®¾æ–½ï¼š</p>
<ul>
<li>æœåŠ¡å‘ç°ã€æœåŠ¡è·¯ç”±ã€æœåŠ¡å®¹é”™ï¼šè¿™æ˜¯æœ€åŸºæœ¬çš„å¾®æœåŠ¡åŸºç¡€è®¾æ–½ã€‚</li>
<li>æ¥å£æ¡†æ¶ã€API ç½‘å…³ï¼šä¸»è¦æ˜¯ä¸ºäº†æå‡å¼€å‘æ•ˆç‡ï¼Œæ¥å£æ¡†æ¶æ˜¯æå‡å†…éƒ¨æœåŠ¡çš„å¼€å‘æ•ˆç‡ï¼ŒAPI ç½‘å…³æ˜¯ä¸ºäº†æå‡ä¸å¤–éƒ¨æœåŠ¡å¯¹æ¥çš„æ•ˆç‡ã€‚</li>
<li>è‡ªåŠ¨åŒ–éƒ¨ç½²ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€é…ç½®ä¸­å¿ƒï¼šä¸»è¦æ˜¯ä¸ºäº†æå‡æµ‹è¯•å’Œè¿ç»´æ•ˆç‡ã€‚</li>
<li>æœåŠ¡ç›‘æ§ã€æœåŠ¡è·Ÿè¸ªã€æœåŠ¡å®‰å…¨ï¼šä¸»è¦æ˜¯ä¸ºäº†è¿›ä¸€æ­¥æå‡è¿ç»´æ•ˆç‡ã€‚</li>
</ul>
<h3 id="å¾®å†…æ ¸"><a href="#å¾®å†…æ ¸" class="headerlink" title="å¾®å†…æ ¸"></a>å¾®å†…æ ¸</h3><p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20220429183229.png" alt="img"></p>
<p>å¾®å†…æ ¸çš„æ ¸å¿ƒç³»ç»Ÿè®¾è®¡çš„å…³é”®æŠ€æœ¯æœ‰ï¼šæ’ä»¶ç®¡ç†ã€æ’ä»¶è¿æ¥å’Œæ’ä»¶é€šä¿¡ã€‚</p>
<p>æ’ä»¶ç®¡ç†</p>
<p>æ ¸å¿ƒç³»ç»Ÿéœ€è¦çŸ¥é“å½“å‰æœ‰å“ªäº›æ’ä»¶å¯ç”¨ï¼Œå¦‚ä½•åŠ è½½è¿™äº›æ’ä»¶ï¼Œä»€ä¹ˆæ—¶å€™åŠ è½½æ’ä»¶ã€‚å¸¸è§çš„å®ç°æ–¹æ³•æ˜¯æ’ä»¶æ³¨å†Œè¡¨æœºåˆ¶ã€‚æ ¸å¿ƒç³»ç»Ÿæä¾›æ’ä»¶æ³¨å†Œè¡¨ï¼ˆå¯ä»¥æ˜¯é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»£ç ï¼Œè¿˜å¯ä»¥æ˜¯æ•°æ®åº“ï¼‰ï¼Œæ’ä»¶æ³¨å†Œè¡¨å«æœ‰æ¯ä¸ªæ’ä»¶æ¨¡å—çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®ƒçš„åå­—ã€ä½ç½®ã€åŠ è½½æ—¶æœºï¼ˆå¯åŠ¨å°±åŠ è½½ï¼Œè¿˜æ˜¯æŒ‰éœ€åŠ è½½ï¼‰ç­‰ã€‚</p>
<p>æ’ä»¶è¿æ¥</p>
<p>æ’ä»¶è¿æ¥æŒ‡æ’ä»¶å¦‚ä½•è¿æ¥åˆ°æ ¸å¿ƒç³»ç»Ÿã€‚é€šå¸¸æ¥è¯´ï¼Œæ ¸å¿ƒç³»ç»Ÿå¿…é¡»åˆ¶å®šæ’ä»¶å’Œæ ¸å¿ƒç³»ç»Ÿçš„è¿æ¥è§„èŒƒï¼Œç„¶åæ’ä»¶æŒ‰ç…§è§„èŒƒå®ç°ï¼Œæ ¸å¿ƒç³»ç»ŸæŒ‰ç…§è§„èŒƒåŠ è½½å³å¯ã€‚</p>
<p>å¸¸è§çš„è¿æ¥æœºåˆ¶æœ‰ OSGiï¼ˆEclipse ä½¿ç”¨ï¼‰ã€æ¶ˆæ¯æ¨¡å¼ã€ä¾èµ–æ³¨å…¥ï¼ˆSpring ä½¿ç”¨ï¼‰ï¼Œç”šè‡³ä½¿ç”¨åˆ†å¸ƒå¼çš„åè®®éƒ½æ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚ RPC æˆ–è€… HTTP Web çš„æ–¹å¼ã€‚</p>
<p>æ’ä»¶é€šä¿¡</p>
<p>æ’ä»¶é€šä¿¡æŒ‡æ’ä»¶é—´çš„é€šä¿¡ã€‚è™½ç„¶è®¾è®¡çš„æ—¶å€™æ’ä»¶é—´æ˜¯å®Œå…¨è§£è€¦çš„ï¼Œä½†å®é™…ä¸šåŠ¡è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¿…ç„¶ä¼šå‡ºç°æŸä¸ªä¸šåŠ¡æµç¨‹éœ€è¦å¤šä¸ªæ’ä»¶åä½œï¼Œè¿™å°±è¦æ±‚ä¸¤ä¸ªæ’ä»¶é—´è¿›è¡Œé€šä¿¡ã€‚ç”±äºæ’ä»¶ä¹‹é—´æ²¡æœ‰ç›´æ¥è”ç³»ï¼Œé€šä¿¡å¿…é¡»é€šè¿‡æ ¸å¿ƒç³»ç»Ÿï¼Œå› æ­¤æ ¸å¿ƒç³»ç»Ÿéœ€è¦æä¾›æ’ä»¶é€šä¿¡æœºåˆ¶ã€‚è¿™ç§æƒ…å†µå’Œè®¡ç®—æœºç±»ä¼¼ï¼Œè®¡ç®—æœºçš„ CPUã€ç¡¬ç›˜ã€å†…å­˜ã€ç½‘å¡æ˜¯ç‹¬ç«‹è®¾è®¡çš„é…ä»¶ï¼Œä½†è®¡ç®—æœºè¿è¡Œè¿‡ç¨‹ä¸­ï¼ŒCPU å’Œå†…å­˜ã€å†…å­˜å’Œç¡¬ç›˜è‚¯å®šæ˜¯æœ‰é€šä¿¡çš„ï¼Œè®¡ç®—æœºé€šè¿‡ä¸»æ¿ä¸Šçš„æ€»çº¿æä¾›äº†è¿™äº›ç»„ä»¶ä¹‹é—´çš„é€šä¿¡åŠŸèƒ½ã€‚å¾®å†…æ ¸çš„æ ¸å¿ƒç³»ç»Ÿä¹Ÿå¿…é¡»æä¾›ç±»ä¼¼çš„é€šä¿¡æœºåˆ¶ï¼Œå„ä¸ªæ’ä»¶ä¹‹é—´æ‰èƒ½è¿›è¡Œæ­£å¸¸çš„é€šä¿¡ã€‚</p>
<h2 id="æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„"><a href="#æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„" class="headerlink" title="æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„"></a>æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„</h2><blockquote>
<p><strong>ä½è€¦åˆçš„ç³»ç»Ÿæ›´å®¹æ˜“æ‰©å±•ã€å¤ç”¨</strong>ã€‚</p>
</blockquote>
<p><strong>å¯æ‰©å±•æ¶æ„çš„æ ¸å¿ƒæ€æƒ³æ˜¯æ¨¡å—åŒ–ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆæ€§ï¼Œæé«˜æ¨¡å—çš„å¤ç”¨æ€§</strong>ã€‚</p>
<p>åˆ†å±‚å’Œåˆ†å‰²ä¸ä»…å¯ä»¥è¿›è¡Œæ¶æ„ä¼¸ç¼©ï¼Œä¹Ÿæ˜¯æ¨¡å—åŒ–è®¾è®¡çš„é‡è¦æ‰‹æ®µï¼Œåˆ©ç”¨åˆ†å±‚å’Œåˆ†å‰²çš„æ–¹å¼å°†è½¯ä»¶åˆ†å‰²ä¸ºè‹¥å¹²ä¸ªä½è€¦åˆçš„ç‹¬ç«‹çš„ç»„ä»¶æ¨¡å—ï¼Œè¿™äº›ç»„ä»¶æ¨¡å—ä»¥æ¶ˆæ¯ä¼ é€’åŠä¾èµ–è°ƒç”¨çš„æ–¹å¼èšåˆæˆä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿã€‚</p>
<p>åœ¨å¤§å‹ç½‘ç«™ä¸­ï¼Œè¿™äº›æ¨¡å—é€šè¿‡åˆ†å¸ƒå¼éƒ¨ç½²çš„æ–¹å¼ï¼Œç‹¬ç«‹çš„æ¨¡å—éƒ¨ç½²åœ¨ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šï¼Œä»ç‰©ç†ä¸Šåˆ†ç¦»æ¨¡å—é—´çš„è€¦åˆå…³ç³»ï¼Œè¿›ä¸€æ­¥é™ä½è€¦åˆæ€§æé«˜å¤ç”¨æ€§ã€‚</p>
<h2 id="åˆ©ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é™ä½ç³»ç»Ÿè€¦åˆæ€§"><a href="#åˆ©ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é™ä½ç³»ç»Ÿè€¦åˆæ€§" class="headerlink" title="åˆ©ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é™ä½ç³»ç»Ÿè€¦åˆæ€§"></a>åˆ©ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é™ä½ç³»ç»Ÿè€¦åˆæ€§</h2><h3 id="äº‹ä»¶é©±åŠ¨æ¶æ„"><a href="#äº‹ä»¶é©±åŠ¨æ¶æ„" class="headerlink" title="äº‹ä»¶é©±åŠ¨æ¶æ„"></a>äº‹ä»¶é©±åŠ¨æ¶æ„</h3><p><strong>äº‹ä»¶é©±åŠ¨æ¶æ„é€šè¿‡åœ¨ä½è€¦åˆçš„æ¨¡å—é—´ä¼ è¾“äº‹ä»¶æ¶ˆæ¯ï¼Œä»¥ä¿æŒæ¨¡å—çš„æ¾æ•£è€¦åˆï¼Œå¹¶å€ŸåŠ©äº‹ä»¶æ¶ˆæ¯çš„é€šä¿¡å®Œæˆæ¨¡å—é—´åˆä½œ</strong>ã€‚å…¸å‹çš„äº‹ä»¶é©±åŠ¨æ¶æ„å°±æ˜¯æ“ä½œç³»ç»Ÿä¸­å¸¸è§çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ã€‚åœ¨å¤§å‹ç½‘ç«™ä¸­ï¼Œæœ€å¸¸è§çš„å®ç°æ‰‹æ®µå°±æ˜¯åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>
<h3 id="åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—"><a href="#åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—"></a>åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—</h3><p>æ¶ˆæ¯ç”Ÿäº§è€…åº”ç”¨ç¨‹åºé€šè¿‡è¿œç¨‹è®¿é—®æ¥å£å°†æ¶ˆæ¯æ¨é€ç»™æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ï¼Œæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å°†æ¶ˆæ¯å†™å…¥æœ¬åœ°å†…å­˜é˜Ÿåˆ—åç«‹å³è¿”å›æˆåŠŸå“åº”ç»™æ¶ˆæ¯ç”Ÿäº§è€…ã€‚æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨æ ¹æ®æ¶ˆæ¯è®¢é˜…åˆ—è¡¨æŸ¥æ‰¾è®¢é˜…è¯¥æ¶ˆæ¯çš„æ¶ˆæ¯æ¶ˆè´¹è€…åº”ç”¨ç¨‹åºï¼Œå°†æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æŒ‰ç…§å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŸåˆ™å°†æ¶ˆæ¯é€šè¿‡è¿œç¨‹é€šä¿¡æ¥å£å‘é€ç»™æ¶ˆæ¯æ¶ˆè´¹è€…ç¨‹åºã€‚</p>
<div align="center">
<img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„åŸç†.png" />
</div>

<p>åœ¨ä¼¸ç¼©æ€§æ–¹é¢ï¼Œç”±äºæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ä¸Šçš„æ•°æ®å¯ä»¥çœ‹ä½œæ˜¯å³æ—¶å¤„ç†çš„ï¼Œå› æ­¤ç±»ä¼¼äºæ— çŠ¶æ€çš„æœåŠ¡å™¨ï¼Œä¼¸ç¼©æ€§è®¾è®¡æ¯”è¾ƒç®€å•ã€‚å°†æ–°æœåŠ¡å™¨åŠ å…¥åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é›†ç¾¤ä¸­ï¼Œé€šçŸ¥ç”Ÿäº§è€…æœåŠ¡å™¨æ›´æ”¹æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨åˆ—è¡¨å³å¯ã€‚</p>
<p>åœ¨å¯ç”¨æ€§æ–¹é¢ï¼Œä¸ºäº†é¿å…æ¶ˆè´¹è€…è¿›ç¨‹å¤„ç†ç¼“æ…¢ï¼Œåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å†…å­˜ç©ºé—´ä¸è¶³é€ æˆçš„é—®é¢˜ï¼Œå¦‚æœå†…å­˜é˜Ÿåˆ—å·²æ»¡ï¼Œä¼šå°†æ¶ˆæ¯å†™å…¥ç£ç›˜ï¼Œæ¶ˆæ¯æ¨é€æ¨¡å—åœ¨å°†å†…å­˜é˜Ÿåˆ—æ¶ˆæ¯å¤„ç†å®Œæˆä»¥åï¼Œå°†ç£ç›˜å†…å®¹åŠ è½½åˆ°å†…å­˜é˜Ÿåˆ—ç»§ç»­å¤„ç†ã€‚</p>
<h2 id="åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡æ‰“é€ å¯å¤ç”¨çš„ä¸šåŠ¡å¹³å°"><a href="#åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡æ‰“é€ å¯å¤ç”¨çš„ä¸šåŠ¡å¹³å°" class="headerlink" title="åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡æ‰“é€ å¯å¤ç”¨çš„ä¸šåŠ¡å¹³å°"></a>åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡æ‰“é€ å¯å¤ç”¨çš„ä¸šåŠ¡å¹³å°</h2><p>å·¨æ— éœ¸ç³»ç»Ÿçš„é—®é¢˜ï¼š</p>
<ul>
<li>æ„å»ºã€éƒ¨ç½²å›°éš¾</li>
<li>ä»£ç åˆ†æ”¯ç®¡ç†å›°éš¾</li>
<li>æ•°æ®åº“è¿æ¥è€—å°½</li>
<li>æ‰©å±•ä¸šåŠ¡å›°éš¾</li>
</ul>
<p>è€Œè§£å†³å·¨æ— éœ¸ç³»ç»Ÿé—®é¢˜çš„æ–¹æ¡ˆå°±æ˜¯æ‹†åˆ†ï¼š</p>
<ul>
<li>é€šè¿‡çºµå‘æ‹†åˆ†å°†ä¸šåŠ¡æ‹†åˆ†å¤šä¸ªåº”ç”¨æˆ–æ¨¡å—ï¼›</li>
<li>é€šè¿‡æ¨ªå‘æ‹†åˆ†å°†å¯å¤ç”¨ä¸šåŠ¡ä½œä¸ºç‹¬ç«‹åº”ç”¨ã€‚</li>
</ul>
<p>ç„¶åï¼Œéœ€è¦é€šè¿‡ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡ç®¡ç†æ¡†æ¶å°†è¿™äº›åº”ç”¨æˆ–æœåŠ¡ç»„ç»‡ç®¡ç†èµ·æ¥ï¼šé€šè¿‡æ¥å£åˆ†è§£ç³»ç»Ÿè€¦åˆæ€§ï¼Œä¸åŒå­ç³»ç»Ÿé€šè¿‡ç›¸åŒçš„æ¥å£æè¿°è¿›è¡ŒæœåŠ¡è°ƒç”¨ã€‚å¸¸è§çš„åˆ†å¸ƒå¼æœåŠ¡ç®¡ç†æ¡†æ¶å¦‚ï¼šSpring Cloudã€Dubbo ç­‰ã€‚</p>
<p>å¤§å‹ç½‘ç«™åˆ†å¸ƒå¼æœåŠ¡çš„éœ€æ±‚ä¸ç‰¹ç‚¹ï¼š</p>
<ul>
<li>è´Ÿè½½å‡è¡¡</li>
<li>å¤±æ•ˆè½¬ç§»</li>
<li>é«˜æ•ˆçš„è¿œç¨‹é€šä¿¡</li>
<li>æ•´åˆå¼‚æ„ç³»ç»Ÿ</li>
<li>å¯¹åº”ç”¨æœ€å°‘ä¾µå…¥</li>
<li>ç‰ˆæœ¬ç®¡ç†</li>
<li>å®æ—¶ç›‘æ§</li>
</ul>
<h2 id="å¯æ‰©å±•çš„æ•°æ®ç»“æ„"><a href="#å¯æ‰©å±•çš„æ•°æ®ç»“æ„" class="headerlink" title="å¯æ‰©å±•çš„æ•°æ®ç»“æ„"></a>å¯æ‰©å±•çš„æ•°æ®ç»“æ„</h2><p>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä¸ºäº†ä¿è¯å…³ç³»è¿ç®—çš„æ­£ç¡®æ€§ï¼Œåœ¨è®¾è®¡æ•°æ®åº“è¡¨ç»“æ„çš„æ—¶å€™ï¼Œå°±éœ€è¦æŒ‡å®šè¡¨çš„ schema â€”â€”å­—æ®µåç§°ï¼Œæ•°æ®ç±»å‹ç­‰ï¼Œå¹¶è¦éµå¾ªç‰¹å®šçš„è®¾è®¡èŒƒå¼ã€‚è¿™äº›è§„èŒƒå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šéš¾ä»¥é¢å¯¹éœ€æ±‚å˜æ›´å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œæ‰€ä»¥æœ‰äººé€šè¿‡é¢„å…ˆè®¾è®¡ä¸€äº›å†—ä½™å­—æ®µæ¥åº”å¯¹ã€‚</p>
<p>è®¸å¤š NoSql æ•°æ®åº“ä½¿ç”¨ ColumnFamily è®¾è®¡æ¥è®¾è®¡å¯æ‰©å±•çš„æ•°æ®ç»“æ„ã€‚</p>
<h2 id="å¼€æ”¾å¹³å°"><a href="#å¼€æ”¾å¹³å°" class="headerlink" title="å¼€æ”¾å¹³å°"></a>å¼€æ”¾å¹³å°</h2><p>å¾ˆå¤šå¤§å…¬å¸ä¼šåˆ©ç”¨å¼€æ”¾å¹³å°æä¾›å¤§é‡å¼€æ”¾æ€§ API ä½¿å¾—ä¼ä¸šå’Œä¸ªäººå¯ä»¥æ–¹ä¾¿çš„æ¥å…¥ä¸šåŠ¡ã€‚é€šè¿‡å¼€æ”¾å¹³å°ï¼Œå¯ä»¥æ„å»ºç”Ÿæ€åœˆï¼Œæå‡å“ç‰Œä»·å€¼ä»¥åŠç«äº‰åŠ›ã€‚</p>
<p>å¼€æ”¾å¹³å°ä¸æ˜¯ä¸€æœä¸€å¤•å®Œæˆçš„ï¼Œè¿™éœ€è¦å¤§é‡ OPEN API çš„æ²‰æ·€ã€‚ç³»ç»Ÿæ¶æ„åœ¨è®¾è®¡ä¹‹åˆï¼Œåº”è¯¥æœ‰æ„è¯†çš„å°†æœªæ¥å¯èƒ½è¢«å¤ç”¨çš„æ¥å£å¥½å¥½è®¾è®¡ï¼Œä»¥ä¾¿äºéœ€è¦å¼€æ”¾ OPEN API æ—¶ï¼Œå¯ä»¥ä¾¿æ·çš„æš´éœ²æœåŠ¡æ¥å£ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://item.jd.com/11322972.html">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/page/32/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/32/">32</a><span class="page-number current">33</span><a class="page-number" href="/blog/page/34/">34</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/39/">39</a><a class="extend next" rel="next" href="/blog/page/34/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2015 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é’æ‚Ÿ â—¾ Dunwu</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">3.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">46:19</span>
  </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/blog/js/third-party/search/local-search.js"></script>




  <script src="/blog/js/third-party/pace.js"></script>

  




<script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"dunwu","repo":"blog","client_id":"c45bc13ca1d3d3aa4836","client_secret":"1907a9f0c22087badad3938e1d7dcba9078f88ac","admin_user":"dunwu","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"f0e6ba1eaf9ad58cc7d1dd36428ea52b"}</script>
<script src="/blog/js/third-party/comments/gitalk.js"></script>

</body>
</html>
